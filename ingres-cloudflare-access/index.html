<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.5"/><style data-href="/styles.f7b0302c8427f1a04772.css" data-identity="gatsby-global-css">@media (prefers-color-scheme:light){code[class*=language-],pre[class*=language-]{background:#fafafa;color:#383a42;direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#e5e5e6;color:inherit}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#e5e5e6;color:inherit}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}.token.cdata,.token.comment,.token.prolog{color:#a0a1a7}.token.doctype,.token.entity,.token.punctuation{color:#383a42}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#b76b01}.token.keyword{color:#a626a4}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e45649}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#50a14f}.token.function,.token.operator,.token.variable{color:#4078f2}.token.url{color:#0184bc}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#383a42}.language-css .token.selector{color:#e45649}.language-css .token.property{color:#383a42}.language-css .token.function,.language-css .token.url>.token.function{color:#0184bc}.language-css .token.url>.token.string.url{color:#50a14f}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#a626a4}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#ca1243}.language-json .token.operator{color:#383a42}.language-json .token.null.keyword{color:#b76b01}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#383a42}.language-markdown .token.url>.token.content{color:#4078f2}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#0184bc}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#a0a1a7;font-style:italic}.language-markdown .token.code-snippet{color:#50a14f}.language-markdown .token.bold .token.content{color:#b76b01}.language-markdown .token.italic .token.content{color:#a626a4}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e45649}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(56,58,66,.2)}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#e5e5e6;border-radius:.3em;color:#696c77;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#c6c7c7;color:#383a42}.line-highlight.line-highlight{background:rgba(56,58,66,.05)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#e5e5e6;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#383a42;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(56,58,66,.05)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(56,58,66,.2)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#9d9d9f}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e45649}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#50a14f}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#4078f2}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#a626a4}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection{background-color:rgba(56,224,98,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:hsl(0,0,95%)}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:hsl(0,0,95%)}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:hsl(0,0,95%)}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#fff}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#383a42;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#383a42}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}}@media (prefers-color-scheme:dark){code[class*=language-],pre[class*=language-]{background:#282c34;color:#abb2bf;direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#3e4451;color:inherit;text-shadow:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#3e4451;color:inherit;text-shadow:none}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.cdata,.token.comment,.token.prolog{color:#5c6370}.token.doctype,.token.entity,.token.punctuation{color:#abb2bf}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#d19a66}.token.keyword{color:#c678dd}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e06c75}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#98c379}.token.function,.token.operator,.token.variable{color:#61afef}.token.url{color:#56b6c2}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#abb2bf}.language-css .token.selector{color:#e06c75}.language-css .token.property{color:#abb2bf}.language-css .token.function,.language-css .token.url>.token.function{color:#56b6c2}.language-css .token.url>.token.string.url{color:#98c379}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#c678dd}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#be5046}.language-json .token.operator{color:#abb2bf}.language-json .token.null.keyword{color:#d19a66}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#abb2bf}.language-markdown .token.url>.token.content{color:#61afef}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#56b6c2}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#5c6370;font-style:italic}.language-markdown .token.code-snippet{color:#98c379}.language-markdown .token.bold .token.content{color:#d19a66}.language-markdown .token.italic .token.content{color:#c678dd}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e06c75}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(171,178,191,.15);text-shadow:none}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#3a3f4b;border-radius:.3em;color:#828997;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#3e4451;color:#abb2bf}.line-highlight.line-highlight{background:rgba(153,187,255,.04)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#3a3f4b;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#abb2bf;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(153,187,255,.04)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(171,178,191,.15)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#636d83}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e06c75}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#98c379}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#61afef}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#c678dd}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection{background-color:rgba(56,224,98,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:#262931}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:#262931}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:#262931}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#31363f}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#abb2bf;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#abb2bf}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}}:root{--foreground:#24292f;--background:#fff}a{color:#0969da}a.visited,a:visited{color:#57606a}.green{color:#1a7f37}.red{color:#cf222e}@media (prefers-color-scheme:dark){:root{--foreground:#adbac7;--background:#22272e}a{color:#539bf5}a.visited,a:visited{color:#768390}.green{color:#57ab5a}.red{color:#e5534b}}a{text-decoration:none}a:hover{text-decoration:underline}html{font-family:Ubuntu,sans-serif}body{background-color:var(--background);color:var(--foreground);margin:0;padding:0}#top{box-sizing:border-box;display:grid;grid-template-rows:1fr 2em;margin:0;min-height:100vh;padding:1em 2em}.graph polygon{fill:transparent}.graph g ellipse[stroke="#000"],.graph g ellipse[stroke="#000000"],.graph g ellipse[stroke=black],.graph g path[stroke="#000"],.graph g path[stroke="#000000"],.graph g path[stroke=black],.graph g polygon[stroke="#000"],.graph g polygon[stroke="#000000"],.graph g polygon[stroke=black]{stroke:var(--foreground)}.graph g text[fill="#000"],.graph g text[fill="#000000"],.graph g text[fill=black]{fill:var(--foreground)}code,pre{font-family:JetBrains Mono,monospace}pre[class*=language-]{word-wrap:break-word;border-radius:0;box-sizing:border-box;margin:1em -2em;max-width:100vw;padding:1em 2em}footer a{line-height:2em;margin-right:.5em}.delta{line-height:1;margin-left:1em;white-space:nowrap}.columns{display:grid;grid-template-columns:repeat(2,1fr)}@media only screen and (max-width:1024px){.columns{grid-template-columns:repeat(1,1fr)}}.pie{text-align:center}.pie figure{display:inline-block}.pie figcaption{font-size:80%;margin-top:.25em}</style><title data-gatsby-head="true">Kubernetes Ingress behind Cloudflare Access</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=6389d5f13c96000946d60b6bb0a8b5a8" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=6389d5f13c96000946d60b6bb0a8b5a8"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="top"><main><div><h1>Kubernetes Ingress behind Cloudflare Access</h1>
<p>Suppose we want to cover important services (like Kubernetes dashboard) behind authentication, authorization and make everything encrypted</p>
<p>The easiest way will be to cover it with Cloudflare which will give us everything out of the box</p>
<p>In short here is how it will work:</p>
<svg width="244pt" height="482pt" viewBox="0.00 0.00 244.05 482.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="max-width: 100%; height: auto;">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 478.4)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-478.4 240.0526,-478.4 240.0526,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="none" stroke="#000000" points="71.0526,-8 71.0526,-306.8 228.0526,-306.8 228.0526,-8 71.0526,-8"></polygon>
<text text-anchor="middle" x="149.5526" y="-290.2" font-family="Times,serif" font-size="14.00" fill="#000000">Kubernetes</text>
</g>
<!-- user -->
<g id="node1" class="node">
<title>user</title>
<polygon fill="none" stroke="#000000" points="101.0526,-474.4 47.0526,-474.4 47.0526,-438.4 101.0526,-438.4 101.0526,-474.4"></polygon>
<text text-anchor="middle" x="74.0526" y="-452.2" font-family="Times,serif" font-size="14.00" fill="#000000">user</text>
</g>
<!-- cloudflare -->
<g id="node2" class="node">
<title>cloudflare</title>
<polygon fill="none" stroke="#000000" points="110.2992,-385.6 37.806,-385.6 37.806,-349.6 110.2992,-349.6 110.2992,-385.6"></polygon>
<text text-anchor="middle" x="74.0526" y="-363.4" font-family="Times,serif" font-size="14.00" fill="#000000">cloudflare</text>
</g>
<!-- user&#45;&gt;cloudflare -->
<g id="edge4" class="edge">
<title>user-&gt;cloudflare</title>
<path fill="none" stroke="#000000" d="M74.0526,-438.0006C74.0526,-425.8949 74.0526,-409.8076 74.0526,-396.0674"></path>
<polygon fill="#000000" stroke="#000000" points="77.5527,-395.672 74.0526,-385.672 70.5527,-395.6721 77.5527,-395.672"></polygon>
<text text-anchor="middle" x="91.1655" y="-407.8" font-family="Times,serif" font-size="14.00" fill="#000000"> &nbsp;https</text>
</g>
<!-- google -->
<g id="node3" class="node">
<title>google</title>
<polygon fill="none" stroke="#000000" points="54.1579,-274 -.0527,-274 -.0527,-238 54.1579,-238 54.1579,-274"></polygon>
<text text-anchor="middle" x="27.0526" y="-251.8" font-family="Times,serif" font-size="14.00" fill="#000000">google</text>
</g>
<!-- cloudflare&#45;&gt;google -->
<g id="edge6" class="edge">
<title>cloudflare-&gt;google</title>
<path fill="none" stroke="#ff0000" d="M43.2126,-349.4124C37.3053,-344.4229 31.9076,-338.4622 28.5028,-331.6 21.3193,-317.122 20.7099,-299.0842 22.0127,-284.2592"></path>
<polygon fill="#ff0000" stroke="#ff0000" points="25.5118,-284.4757 23.2326,-274.1289 18.562,-283.6387 25.5118,-284.4757"></polygon>
<text text-anchor="middle" x="64.8275" y="-319" font-family="Times,serif" font-size="14.00" fill="#000000"> &nbsp;anonymous</text>
</g>
<!-- ingress -->
<g id="node4" class="node">
<title>ingress</title>
<polygon fill="none" stroke="#000000" points="149.7087,-274 94.3965,-274 94.3965,-238 149.7087,-238 149.7087,-274"></polygon>
<text text-anchor="middle" x="122.0526" y="-251.8" font-family="Times,serif" font-size="14.00" fill="#000000">ingress</text>
</g>
<!-- cloudflare&#45;&gt;ingress -->
<g id="edge5" class="edge">
<title>cloudflare-&gt;ingress</title>
<path fill="none" stroke="#00ff00" d="M89.1011,-349.3134C93.0724,-343.8551 97.0752,-337.6962 100.0526,-331.6 107.3902,-316.5767 112.7383,-298.6514 116.323,-284.0267"></path>
<polygon fill="#00ff00" stroke="#00ff00" points="119.7871,-284.5805 118.6248,-274.0496 112.9663,-283.0068 119.7871,-284.5805"></polygon>
<text text-anchor="middle" x="156.2083" y="-319" font-family="Times,serif" font-size="14.00" fill="#000000"> &nbsp;authorized, https</text>
</g>
<!-- secret -->
<g id="node5" class="node">
<title>secret</title>
<ellipse fill="none" stroke="#000000" cx="113.0526" cy="-145" rx="33.6015" ry="18"></ellipse>
<text text-anchor="middle" x="113.0526" y="-140.8" font-family="Times,serif" font-size="14.00" fill="#000000">secret</text>
</g>
<!-- ingress&#45;&gt;secret -->
<g id="edge3" class="edge">
<title>ingress-&gt;secret</title>
<path fill="none" stroke="#000000" d="M120.5664,-237.6706C119.1445,-220.1329 116.9794,-193.4306 115.338,-173.1867"></path>
<polygon fill="#000000" stroke="#000000" points="118.8079,-172.6727 114.5111,-162.9883 111.8308,-173.2385 118.8079,-172.6727"></polygon>
</g>
<!-- service -->
<g id="node6" class="node">
<title>service</title>
<polygon fill="none" stroke="#000000" points="219.6934,-163 164.4118,-163 164.4118,-127 219.6934,-127 219.6934,-163"></polygon>
<text text-anchor="middle" x="192.0526" y="-140.8" font-family="Times,serif" font-size="14.00" fill="#000000">service</text>
</g>
<!-- ingress&#45;&gt;service -->
<g id="edge1" class="edge">
<title>ingress-&gt;service</title>
<path fill="none" stroke="#000000" d="M133.6117,-237.6706C144.9097,-219.7552 162.2386,-192.2764 175.0961,-171.8881"></path>
<polygon fill="#000000" stroke="#000000" points="178.1026,-173.6821 180.4764,-163.3566 172.1816,-169.9482 178.1026,-173.6821"></polygon>
</g>
<!-- pod -->
<g id="node7" class="node">
<title>pod</title>
<polygon fill="none" stroke="#000000" points="219.0526,-52 165.0526,-52 165.0526,-16 219.0526,-16 219.0526,-52"></polygon>
<text text-anchor="middle" x="192.0526" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">pod</text>
</g>
<!-- service&#45;&gt;pod -->
<g id="edge2" class="edge">
<title>service-&gt;pod</title>
<path fill="none" stroke="#000000" d="M192.0526,-126.6706C192.0526,-109.2373 192.0526,-82.7482 192.0526,-62.5489"></path>
<polygon fill="#000000" stroke="#000000" points="195.5527,-62.3566 192.0526,-52.3566 188.5527,-62.3567 195.5527,-62.3566"></polygon>
</g>
</g>
</svg>
<p>Things to accomplish:</p>
<ol>
<li>Communication between user and Cloudflare is encrypted by its certificates.</li>
<li>Communication between Cloudflare and Ingress is always encrypted by Origin Certificate signed and trusted by Cloudflare.</li>
<li>Ingress allows requests only from Cloudflare.</li>
<li>Access to application is possible only after authentication and authorization via configured identity provider.</li>
</ol>
<h2>User to Cloudflare encryption</h2>
<p>That is an easy one, all we need to do is to turn on "proxy" checkbox for desired (sub)domain.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3b2d8f8138bfbdd1208767bbfba14f9d/21cdd/proxied.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20.3125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA30lEQVQY0zWQy07DMBBF86Vs+CIWLPgUdqxYI5CQUNqoaUKKazuJH4ndJO1BcWCkI83cubrSTPb0fOLu4Yv7x5yPg8NahxsnLjMbC8TptjHf0jyt2l9vfWS/L8jzHKUU2ftO8vLW8PqpKCpBbxzWDTg/onSHVC1+CLghJF2pFiE1nXFJU7pNQSvWGjKjBfr8DddI09QoKQlhJMbIWQiqqqLrWpxzxBCoT4KyPKZdCCEFrf4xXFD9QGZNz6E8Mi9XpJQYY/iv9XwhRMJ7n7TxXKDlD12/+fresMxTekmtIr+auS5nSkq7zwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="proxied"
        title="proxied"
        src="/static/3b2d8f8138bfbdd1208767bbfba14f9d/2bef9/proxied.png"
        srcset="/static/3b2d8f8138bfbdd1208767bbfba14f9d/6f3f2/proxied.png 256w,
/static/3b2d8f8138bfbdd1208767bbfba14f9d/01e7c/proxied.png 512w,
/static/3b2d8f8138bfbdd1208767bbfba14f9d/2bef9/proxied.png 1024w,
/static/3b2d8f8138bfbdd1208767bbfba14f9d/71c1d/proxied.png 1536w,
/static/3b2d8f8138bfbdd1208767bbfba14f9d/21cdd/proxied.png 1680w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h2>Allow requests only from Cloudflare</h2>
<p>Thats also easy one, Cloudflare has <a href="https://www.cloudflare.com/ips/">range of its IP addresses</a> which might be added to a ingress annotation <a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#whitelist-source-range">whitelist-source-range</a></p>
<blockquote>
<p>TODO: create simple admission mutation webhook which will listen to ingress creation or updation events and inject list of addresses from config map, also it should watch for config map and if it changes - update all ingresses</p>
</blockquote>
<h2>Cloudflare to Ingress encryption</h2>
<p>Here we have four options under SSL/TLS configurations:</p>
<ul>
<li>Off - even not disqused</li>
<li>Flexible - its when requests will be <code class="language-text">user -(https:443)-> cloudflare -(http:80)-> origin</code> - technically, technically, if we are allowing requests only from a Cloudflare it might be ok, but we want encryption everywhere</li>
<li>Full - now requests from cloudflare to origin will also be made over https, but Cloudflare will trust any self signed certificate</li>
<li>Strict - the most interesting for us, it will be encrypted and Cloudflare will validate certificates</li>
</ul>
<p>If we are talking about certificates for our origin there are two options:</p>
<ul>
<li>Create certificates with LetsEncrypt (requires cert-manager so 90 days certificates will be updated automaticaly)</li>
<li>Create origin certificate from Cloudflare (will give us certificate for years, trusted by Cloudflare)</li>
</ul>
<p>We are going to try all options here but at the end stick with Cloudflare certificate</p>
<h3>Flexible</h3>
<p>Our starting poing, it wont have encryption between Cloudflare and origin but will be used for all further deployments</p>
<p><strong>flexible.yml</strong></p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> flexible
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> flexible
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> flexible
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
          <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
              <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> flexible
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token comment"># ADDED</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/whitelist-source-range</span><span class="token punctuation">:</span> 173.245.48.0/20<span class="token punctuation">,</span> 103.21.244.0/22<span class="token punctuation">,</span> 103.22.200.0/22<span class="token punctuation">,</span> 103.31.4.0/22<span class="token punctuation">,</span> 141.101.64.0/18<span class="token punctuation">,</span> 108.162.192.0/18<span class="token punctuation">,</span> 190.93.240.0/20<span class="token punctuation">,</span> 188.114.96.0/20<span class="token punctuation">,</span> 197.234.240.0/22<span class="token punctuation">,</span> 198.41.128.0/17<span class="token punctuation">,</span> 162.158.0.0/15<span class="token punctuation">,</span> 104.16.0.0/13<span class="token punctuation">,</span> 104.24.0.0/14<span class="token punctuation">,</span> 172.64.0.0/13<span class="token punctuation">,</span> 131.0.72.0/22<span class="token punctuation">,</span> 2400<span class="token punctuation">:</span>cb00<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2606<span class="token punctuation">:</span>4700<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2803<span class="token punctuation">:</span>f800<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>b500<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>8100<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2a06<span class="token punctuation">:</span>98c0<span class="token punctuation">:</span><span class="token punctuation">:</span>/29<span class="token punctuation">,</span> 2c0f<span class="token punctuation">:</span>f248<span class="token punctuation">:</span><span class="token punctuation">:</span>/32

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> flexible.marchenko.net.ua
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> ImplementationSpecific
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> flexible
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span></code></pre></div></p>
<h3>Full</h3>
<p>For full we are ok to use self signed certificates, so need to create one:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">openssl genrsa <span class="token parameter variable">-out</span> selfsigned.key <span class="token number">2048</span>
openssl req <span class="token parameter variable">-x509</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-new</span> <span class="token parameter variable">-nodes</span>  <span class="token punctuation">\</span>
  <span class="token parameter variable">-days</span> <span class="token number">10</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-key</span> selfsigned.key <span class="token punctuation">\</span>
  <span class="token parameter variable">-out</span> selfsigned.crt <span class="token punctuation">\</span>
  <span class="token parameter variable">-subj</span> <span class="token string">"/CN=selfsigned.marchenko.net.ua"</span></code></pre></div>
<p>Then with help of commands copy and paste certificate and key to secret</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">cat</span> selfsigned.crt <span class="token operator">|</span> base64 <span class="token operator">|</span> pbcopy
<span class="token function">cat</span> selfsigned.key <span class="token operator">|</span> base64 <span class="token operator">|</span> pbcopy</code></pre></div>
<p>And apply following:</p>
<p><strong>selfsigned.yml</strong></p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Secret
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned<span class="token punctuation">-</span>tls
<span class="token key atrule">type</span><span class="token punctuation">:</span> kubernetes.io/tls
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token comment"># cat selfsigned.crt | base64</span>
  <span class="token key atrule">tls.crt</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJBQ0NRQ3RMUzZwaEVLQ1pqQU5CZ2txaGtpRzl3MEJBUXNGQURBbU1TUXdJZ1lEVlFRRERCdHoKWld4bWMybG5ibVZrTG0xaGNtTm9aVzVyYnk1dVpYUXVkV0V3SGhjTk1qRXhNVEl6TVRnd056QTNXaGNOTWpFeApNakF6TVRnd056QTNXakFtTVNRd0lnWURWUVFEREJ0elpXeG1jMmxuYm1Wa0xtMWhjbU5vWlc1cmJ5NXVaWFF1CmRXRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEbDA2RXlXK2FRZmxWZWF6R2IKU0JaR09DeThqaC9RS2k4Uy84alhHZ3dUVXVpSlprd080MzdtTGxUVzdVRmkwS2ZxR2YrS21Cak5McE83RzQwTQpZR3FIakhiNERwZjlGSHNDWExsTDVKOUNhbGJheG1ZOUYwQ3pwbjRkNXNVbFhqVDZDY0dmYm92NUJxWDBEWXFiCjlFOWdGZGI2NXJ5eHhSSndKK25XeW14YWI4c2tWTytWbGVsNUdOREx3cGdXRUJDUnRNOFNZY1ZicDYrNXZDQi8KQjRiL1dBalQ3bjYwMHhmdWNHMkc0QTd0RkFTSkpzeVdFdzBoT0tvQVp5WmNDTUxmdWRVb1BYVndpdTVJV1Q3LwpzRG5tUUI0OSt0Yy9sNjFlYjdhZlJSaElIZ0lBZUIrU3ZqQTZIazhNV1R1b28wZ29hVWhwNVpRVnZ0UTlNN21ZCng2RzlBZ01CQUFFd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFKcEVkQTlEUE5Nd3BSRUtBSFZKTCtLL0crTDkKbS9CYS9CcDlQUmNNa011M2VXRkhWTUR6dWQrblNLOWRoY0luV056MjZEZHh6RE5VeDgzVkhCQWNiZnRCTHFVSgpDVEZ5bk9WQzF1cVNoZ3FsVzFCMVdVL1ZiTmZBOWZRS09Kd29CTmtrOWRMdXlYOU55aHJ0TmUrNWpGL3FqM1BxCm1ON2ZORUdlZkViZGVFbVgvY3ZFR1JZL1JWRXpOcVgyQUNoTEdldmg2SnZqTG5FRmVSaElxWmxyT0VZVTV5Q0wKQWRkT0VWYTJhQmxXK015c1hDNnR4bUlzVk5UY3pFUW95em1qdnFrQjl6YnZaeWxKaGhuUDNFc1l2MmRqbnpZSQo3cXhWdURHbDVCOStNcmI1WVlXUXhqYTl4NmlkVzB4Z2pYUloxcUdDT2xDS0FobHhzenBrdEFFbWJTcz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  <span class="token comment"># cat selfsigned.key | base64</span>
  <span class="token key atrule">tls.key</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBNWRPaE1sdm1rSDVWWG1zeG0wZ1dSamdzdkk0ZjBDb3ZFdi9JMXhvTUUxTG9pV1pNCkR1Tis1aTVVMXUxQll0Q242aG4vaXBnWXpTNlR1eHVOREdCcWg0eDIrQTZYL1JSN0FseTVTK1NmUW1wVzJzWm0KUFJkQXM2WitIZWJGSlY0MCtnbkJuMjZMK1FhbDlBMkttL1JQWUJYVyt1YThzY1VTY0NmcDFzcHNXbS9MSkZUdgpsWlhwZVJqUXk4S1lGaEFRa2JUUEVtSEZXNmV2dWJ3Z2Z3ZUcvMWdJMCs1K3ROTVg3bkJ0aHVBTzdSUUVpU2JNCmxoTU5JVGlxQUdjbVhBakMzN25WS0QxMWNJcnVTRmsrLzdBNTVrQWVQZnJYUDVldFhtKzJuMFVZU0I0Q0FIZ2YKa3I0d09oNVBERms3cUtOSUtHbElhZVdVRmI3VVBUTzVtTWVodlFJREFRQUJBb0lCQVFEYUF4N3VmbThBc2xhWQo4bVprUHNXaVpyZEpSaWkzZHN5ZzRUTExtVkhMSXVLak0vOENRSnVvRGxzOFptT1lNUWFYODRHTkh5cW51SDg3CkJxK09CZ2dIL1I3OXdCbzlZS2d2WFhZSW9CN1RDYnpLVzFtd3FkWWVsTmtkMUVNL1oxWXB1Z2VLRFh1S0J0eDEKM2tLV0hmTU4ycW5MNkFVblBTSjRjZVJJZEV6RW0ydGY4NzJWNUtQNVU3dWtLQ3ZKQjdOOGxUaGFVb09lcmhtRAo5YXVsbzV0a3NNOWJWOVZsMk5JaVZVQkk1OWJnQ25EanBTT295c1VraDloWHJNZTU4R0ZvOUVMcUJPYVg4V1FkCllDSWQvN3hqbkxXYnVXTHVLR3FUNXNrYlZpZHlKd3drWlI4TktSejhiSnM2UWNxMmd5SlIzeUp0USszNzNpV3QKdVVBUWg5c0JBb0dCQVBtUWxrbDVPQmdrbXl5U0JNZWt6bjU2TXZtQ2VtblpmS2VKdnpBaEpzTS9CWUtkSjVxUwpuUTNGb1d0emE1US9LSDhPbFdLMVk0UlZDL1VaUkRoRUswYWtVeE5Yc2E2Wm1GV1JmSEhTcndWRERwQVJiZytLCjJsZE1EdzlmVjdSU044ejlCMnVKa3Ixb29td29SMXdoUTF3bDVJRW9INFY4OVFUblRJKzVWSHlwQW9HQkFPdkEKdjUxR2Zjd3pCWndXem1LQnRwazVDa3YyREZQMXFMM2NEWHBaN1lyVEZTS0M2Vml5REN0UjdJd1U3OW9FVXZWawozZUNML3VjTTR4ZUpRc0ZsRlVia1Qwa215cUVpQmxoN0JVSHU5eVh1WFc0dlFXRU91ZC9KNWJqdWJld3R0ZnhOCjYwMktiL1lLVmtSTzJhOVUreFI1NWVqWE5iaHJOZzNnM0daN0NqVDFBb0dBSFliMzRSV1FoM3E5U1ZhMWJoR1gKeE9zY1lOMEpNc0RpdU1mWmNRNWJFYnJCSWlVSjdJWHdReExnK0YrZG1OcW9KZkJKeUhZQm9rU1Z0NWdYdERpTQpqajBlL3lqZkF2TjFUSnA4Q05PT2xhYkxjRXcvbzJNZ1ZqZlBpRmdWZm1aRDUrTUFINzhWTjRmTHY5UThMVEJhClVlckIwRzQ0M0loZVRRZzR6TUIydUpFQ2dZRUEyZmZXOGFISUUzRWxBYUR3WnBGSmN6Y1N0eEtoYVVzYkhaY0QKK3hpRUVMT0N1ZXJSdGtqQUNabHdIRUFMVnNaaXNUSDJGbk01VlFSTVBtbVJCOS9lb1RIYndHV1dPUTZOVVdkRQpnQ1poNlhjT2VSNUYwMmZiSVBhNVo1ZENtSGZXNTVSZk5zMEZJVFdEZHhwMEY3QjVpQUFBT3B3bnRmK2g5WWp1CkhlNHFqTFVDZ1lCMmtFM3lFQlo4N3BjRTA0a0lGSW5UV0JqbnpHbDl5bitIdThoNlZIRFo1Yld4NnBHSDh2emIKeGJaZzBZcTlDTHRKOFdudUo5OU5iK1RGZGIwQWRaeG5QUlZvQlo5TStvM00xeVJVMTdKckozaFBFeVpoMDJZeApLQmMzelJYcUQ5WXhzN0VuRE9TTndJQ0tmdGNoZW5YTVZnSGJHanVIdENkejNUelFwSUcvUXc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> selfsigned
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> selfsigned
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> selfsigned
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
          <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
              <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> selfsigned
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token comment"># ADDED</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/whitelist-source-range</span><span class="token punctuation">:</span> 173.245.48.0/20<span class="token punctuation">,</span> 103.21.244.0/22<span class="token punctuation">,</span> 103.22.200.0/22<span class="token punctuation">,</span> 103.31.4.0/22<span class="token punctuation">,</span> 141.101.64.0/18<span class="token punctuation">,</span> 108.162.192.0/18<span class="token punctuation">,</span> 190.93.240.0/20<span class="token punctuation">,</span> 188.114.96.0/20<span class="token punctuation">,</span> 197.234.240.0/22<span class="token punctuation">,</span> 198.41.128.0/17<span class="token punctuation">,</span> 162.158.0.0/15<span class="token punctuation">,</span> 104.16.0.0/13<span class="token punctuation">,</span> 104.24.0.0/14<span class="token punctuation">,</span> 172.64.0.0/13<span class="token punctuation">,</span> 131.0.72.0/22<span class="token punctuation">,</span> 2400<span class="token punctuation">:</span>cb00<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2606<span class="token punctuation">:</span>4700<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2803<span class="token punctuation">:</span>f800<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>b500<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>8100<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2a06<span class="token punctuation">:</span>98c0<span class="token punctuation">:</span><span class="token punctuation">:</span>/29<span class="token punctuation">,</span> 2c0f<span class="token punctuation">:</span>f248<span class="token punctuation">:</span><span class="token punctuation">:</span>/32

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token comment"># ADDED</span>
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> selfsigned.marchenko.net.ua
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> selfsigned<span class="token punctuation">-</span>tls

  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> selfsigned.marchenko.net.ua
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> ImplementationSpecific
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> selfsigned
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span></code></pre></div></p>
<p>If for some reason something does not work check ingress logs with something like:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl <span class="token parameter variable">-n</span> ingress logs <span class="token parameter variable">-l</span> <span class="token assign-left variable">name</span><span class="token operator">=</span>nginx-ingress-microk8s</code></pre></div>
<p>Also check what cetificate is for:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">openssl x509 <span class="token parameter variable">-in</span> cloudflare.crt <span class="token parameter variable">-text</span> <span class="token parameter variable">-noout</span></code></pre></div>
<p>In my case I got bunch of errors complaining <code class="language-text">local SSL certificate cf/selfsigned-key was not found. Using default certificate</code> because I did removed comments and make certificates in a single line, then because of a wrong secret type.</p>
<p>Now if you will try to connect everything should be ok:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-vv</span> https://selfsigned.marchenko.net.ua</code></pre></div>
<p>Buf if you will try to bypass cloudflare with help of:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-k</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">--resolve</span> selfsigned.marchenko.net.ua:443:178.20.154.97 https://selfsigned.marchenko.net.ua/</code></pre></div>
<p>You will receive 403 forbidden</p>
<p>So we already have encryption everywhere plus connections are allowed only from Cloudflare</p>
<h3>Strict - Letsencrypt</h3>
<p>For strict to work we gonna need real certificates, so here is a demo just in case it will be needed in future</p>
<p><strong>letsencrypt.yml</strong></p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Secret
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>tls
  <span class="token comment"># placeholder, will be filled in with certificates by cert-manager</span>
<span class="token key atrule">type</span><span class="token punctuation">:</span> Opaque
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> letsencrypt
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> letsencrypt
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> letsencrypt
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
          <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
              <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> letsencrypt
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token comment"># ADDED</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/whitelist-source-range</span><span class="token punctuation">:</span> 173.245.48.0/20<span class="token punctuation">,</span> 103.21.244.0/22<span class="token punctuation">,</span> 103.22.200.0/22<span class="token punctuation">,</span> 103.31.4.0/22<span class="token punctuation">,</span> 141.101.64.0/18<span class="token punctuation">,</span> 108.162.192.0/18<span class="token punctuation">,</span> 190.93.240.0/20<span class="token punctuation">,</span> 188.114.96.0/20<span class="token punctuation">,</span> 197.234.240.0/22<span class="token punctuation">,</span> 198.41.128.0/17<span class="token punctuation">,</span> 162.158.0.0/15<span class="token punctuation">,</span> 104.16.0.0/13<span class="token punctuation">,</span> 104.24.0.0/14<span class="token punctuation">,</span> 172.64.0.0/13<span class="token punctuation">,</span> 131.0.72.0/22<span class="token punctuation">,</span> 2400<span class="token punctuation">:</span>cb00<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2606<span class="token punctuation">:</span>4700<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2803<span class="token punctuation">:</span>f800<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>b500<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2405<span class="token punctuation">:</span>8100<span class="token punctuation">:</span><span class="token punctuation">:</span>/32<span class="token punctuation">,</span> 2a06<span class="token punctuation">:</span>98c0<span class="token punctuation">:</span><span class="token punctuation">:</span>/29<span class="token punctuation">,</span> 2c0f<span class="token punctuation">:</span>f248<span class="token punctuation">:</span><span class="token punctuation">:</span>/32
    <span class="token comment"># ask cert-manager to create certificates for us</span>
    <span class="token key atrule">cert-manager.io/cluster-issuer</span><span class="token punctuation">:</span> <span class="token string">'letsencrypt'</span>

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token comment"># ADDED</span>
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> letsencrypt.marchenko.net.ua
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>tls

  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> letsencrypt.marchenko.net.ua
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> ImplementationSpecific
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span></code></pre></div></p>
<p>The check will be the same as in previous example</p>
<h3>Strick - Cloudflare</h3>
<p>And now is a cool part, in Cloudflare under SSL/TLS there is an option to create certificates for your origin server which will be trusted by Cloudflare and will be signed for years</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/bf4b5b72e06e66e6d3d0cb4be85990bb/77085/origin.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.953125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABLklEQVQoz5WSB2oEMQxF5/6HyhVCLhBYdtru9OYyTeEpKEsKJDF8NB6sX2QnPqwyz7PEGOU4DlnXVfI8lyzLtKZpKnVdS9/3MgyDOOfEe68VLMuilf7zPCVxPuhhNqxt26TrOkXbttI0zSdAPo6jkkL2jXDfNmm7Trx3+gMgABmHaETkL0sJaSiKQqZp0risEIIq2/4/Kwlx1WZcoEDFHdHKstSY5phvGwXzJDpGqIBEyTh7Cd5/WIaQywDX61Uul4vc73fdk4RGyCDiMg3s6U1mFyWEd8J937VyADdUmklggrwEq1+hhDh07tHA3Kqq0ri3G7ipMwQsHtVg7hDmPpJFHQYlNHVmVje1HmAuKJv7Xy+Fhx3jg9DeIrAo9px+irnvhyzTIE8vlTy/TvIGw9wIy9UFu5QAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="origin"
        title="origin"
        src="/static/bf4b5b72e06e66e6d3d0cb4be85990bb/2bef9/origin.png"
        srcset="/static/bf4b5b72e06e66e6d3d0cb4be85990bb/6f3f2/origin.png 256w,
/static/bf4b5b72e06e66e6d3d0cb4be85990bb/01e7c/origin.png 512w,
/static/bf4b5b72e06e66e6d3d0cb4be85990bb/2bef9/origin.png 1024w,
/static/bf4b5b72e06e66e6d3d0cb4be85990bb/71c1d/origin.png 1536w,
/static/bf4b5b72e06e66e6d3d0cb4be85990bb/a878e/origin.png 2048w,
/static/bf4b5b72e06e66e6d3d0cb4be85990bb/77085/origin.png 2764w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>After creating certificate Cloudflare will create certificate and key for you, so you can follow exactly same approach as in flexible/selfsigned example</p>
<p>Deployment and checks are the same</p>
<h2>Authenticate</h2>
<p>Navigate to <a href="https://dash.teams.cloudflare.com/">teams</a> dashboard to add application and its authentication providers</p>
<p>There is no hidden knowledge and everything is done in just few clicks including identity providers</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/41b33464b9064f94bdfea96056fed063/84a78/applications.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABeUlEQVQoz4VSy07DMBDMj3LiyL9w4YLEj/AJvVTqBVSJQ+kzpXHjx9pJ7CQdtFvMo0IQabTxejOZGbvY7/fYbrc4Ho9QSsEYA+ccrLVS/wLP/IBzKBaLBSaTCWazGabTqZB77/8ltNbBk0MTHIJ3aPy5X+Q/EZEQZbKMSzWf6q1FWRksS43NXmNVamhjUbBFrbUQdl2Htm3lI14zLu0beScMscHD4xJXt0+4uZ/j+u4Zr7saRQhBVDEpkzMp9/I6xohxHBG8R+xa4HSSvbIsEWNCFxPa7lzFctM0ciAMHuz7HtyrqkrWTJ5SgiMPpQltHORH6/UKKfXo+0EqQwhZ0eFwkCG2xmpYVT5tJnXWQFPEfOOxO3ZIMUo0w3gCNUnguWbCSiloYyQzflhRzpXz8kSwIeFlF/BmElKKovwEoI3jBwYQORScX7bMyJnWdS0qM7T12FYeyvA+iZuGD5ACLAWpYpk3hFQp8CVn+7/eQZ4j7n9dqRzTd7wDlMT5q6kytl0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="applications"
        title="applications"
        src="/static/41b33464b9064f94bdfea96056fed063/2bef9/applications.png"
        srcset="/static/41b33464b9064f94bdfea96056fed063/6f3f2/applications.png 256w,
/static/41b33464b9064f94bdfea96056fed063/01e7c/applications.png 512w,
/static/41b33464b9064f94bdfea96056fed063/2bef9/applications.png 1024w,
/static/41b33464b9064f94bdfea96056fed063/71c1d/applications.png 1536w,
/static/41b33464b9064f94bdfea96056fed063/84a78/applications.png 1832w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5ed658587c3b97cc96aea11a169fa781/2acc9/applauncher.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.171875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA50lEQVQoz31Si66DIAz1/z9UvWouQnmjnqXdWJYNaXJSaMvpiyGkAiILay0MEbz3uK4LPan+T22tQwgBQ+9BzhnTNGFdV/wtC8ZxREqpSVplYEMLLGQtxmnCPM/Ytk2IuZNK9Ela0SWMKcE5J2PgakspolvV3RJ+Z78byRP4edsl5IoY53nivC4cx4EYo8SwrZWouxRul2dWE/AW/5USX0pZ2mfNi4rxiSHn0nSU4wARyVfiGK6UEyil5Ox9aGK4czBCiILe/YfQqg3Lsgqc8++gb73vGrs20JqgRRtoQy+bwb4bGEN4APVOEM2V3UASAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="applauncher"
        title="applauncher"
        src="/static/5ed658587c3b97cc96aea11a169fa781/2bef9/applauncher.png"
        srcset="/static/5ed658587c3b97cc96aea11a169fa781/6f3f2/applauncher.png 256w,
/static/5ed658587c3b97cc96aea11a169fa781/01e7c/applauncher.png 512w,
/static/5ed658587c3b97cc96aea11a169fa781/2bef9/applauncher.png 1024w,
/static/5ed658587c3b97cc96aea11a169fa781/71c1d/applauncher.png 1536w,
/static/5ed658587c3b97cc96aea11a169fa781/a878e/applauncher.png 2048w,
/static/5ed658587c3b97cc96aea11a169fa781/2acc9/applauncher.png 2378w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>What is cool you can configure different rules per application/group/region/whatever</p>
<p>Whenever you will try open any of your apps, you will be redirected to choosen identity provider for authentication and only after redirected back to an app, and because we are not allowing bypassing Cloudflare its the same as disalowing anonymous access at all.</p>
<p>Also there few other cool features in Cloudflare Acess like Gateways and Tunnels which may make even crazier things</p></div></main><footer><a href="#top">top</a><a href="/">home</a><a href="/search">search</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ingres-cloudflare-access";window.___webpackCompilationHash="d66156d9f10a2e2c3817";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b4bb882d10635d85fa25.js"],"app":["/app-98475b819971087d4b7e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2652c435d8decd31b8ef.js"],"component---src-pages-index-js":["/component---src-pages-index-js-05a3598fd09bcacab11e.js"],"component---src-pages-search-js":["/component---src-pages-search-js-078619e3aef857102623.js"],"component---src-templates-note-js":["/component---src-templates-note-js-b005c02681f20ea28edd.js"]};/*]]>*/</script><script src="/polyfill-b4bb882d10635d85fa25.js" nomodule=""></script><script src="/app-98475b819971087d4b7e.js" async=""></script><script src="/framework-2ce620c91826a79f925c.js" async=""></script><script src="/webpack-runtime-b5d9ed3760a9b31eebd6.js" async=""></script></body></html>