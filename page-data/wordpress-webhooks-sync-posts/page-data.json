{"componentChunkName":"component---src-templates-note-js","path":"/wordpress-webhooks-sync-posts/","result":{"data":{"remark":{"fields":{"path":"wordpress-webhooks-sync-posts"},"meta":{"title":""},"headings":[{"value":"Wordpress Webhooks to Sync Posts"}],"html":"<h1>Wordpress Webhooks to Sync Posts</h1>\n<p>Suppose you decided to sync Wordpress with externaly system</p>\n<p>Here is a quick and easy way to do so without touchind Wordpress internals</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># docker network rm my</span>\n\n<span class=\"token comment\"># all containers will be in same network for connectivity</span>\n<span class=\"token function\">docker</span> network create my\n\n<span class=\"token comment\"># sample echo server</span>\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>hook <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>my <span class=\"token parameter variable\">-p</span> <span class=\"token number\">8000</span>:80 mendhak/http-https-echo\n\n<span class=\"token comment\"># because of Wordpress plugin does not want to work with ports and non https</span>\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>ngrok <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>my wernight/ngrok ngrok http hook:80\n\n<span class=\"token comment\"># database</span>\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>db <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>my <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_DATABASE</span><span class=\"token operator\">=</span>demo <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_USER</span><span class=\"token operator\">=</span>demo <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_PASSWORD</span><span class=\"token operator\">=</span>demo <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_RANDOM_ROOT_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> mysql:5.7\n\n<span class=\"token comment\"># wordpress</span>\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>wp <span class=\"token parameter variable\">-p</span> <span class=\"token number\">8080</span>:80 <span class=\"token parameter variable\">--network</span><span class=\"token operator\">=</span>my <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">WORDPRESS_DB_HOST</span><span class=\"token operator\">=</span>db <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">WORDPRESS_DB_USER</span><span class=\"token operator\">=</span>demo <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">WORDPRESS_DB_PASSWORD</span><span class=\"token operator\">=</span>demo <span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">WORDPRESS_DB_NAME</span><span class=\"token operator\">=</span>demo wordpress</code></pre></div>\n<p>Navigate to <a href=\"http://localhost:8080\">localhost:8080</a>, setup wordpress by pressing next, next, finish. Then go to its plugin wind and install wp webhooks, activate it and put ngrock link into it</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 848px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0956893ef78003f039b2359440a7a2ca/d52e5/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADVElEQVR42o2U229UVRSHzx+gqFyUNkBJClRKmd6YyohCDDFKQrw8aPRdfSAphUKhLbVpFKiRGkzkSeOLNOqD8QHCg401oiYm1mCosdJUndY5c+t0zm3vc59zPjNnfDDRqCv5svde2Vlr7fXL2kp33wG60hlad+/l6LPP8calt5h8c4qJ1y8yNnGecxPnGX/tQnL+Pygd3X2kevtYv3kLA6eG8H2ftcoamqZjOiEVESD9iL9ZDPE/oKR6H2JXRxfrNjXRf/J0ErBYLKHrBsIS2LaNZQmElA2flJiWheM4+H6Q3P8rSubgYTp60knA44NDycWcqlLVqggpsCwroR7cMExM08I0zUYS0UBKiRANlM59+0n1pNnYtIX+E4OEfo3VgpGgr1kYwkY3JYYlcRwX163jJft6ciltTEtiCRthmih70o/Q9fBjbGppY3B0lMXvVpl6ZYZLL81w/d15LM+nYjhowiUIQ6JajTAMqdVqSSttL2ClpLPmRITqEkr62BUOvDxF29FhRj/4jDvfqHx65RazH/3MzNWf0AydUrmCVtWoVqvYdqOqeqVxHBNFEbbr40TgLy+gPPrkMxx64mla96R5dXKSxbkKl499yTsDN7nx3jxBVEM6AVFdwv8wP7eEcvjIUxx6/AjbdrZz9tw4gWtTyv5KaUVF12TyzCAI8BJFA/wgSHz1VfwphrRtpO1gC4GSSmfY3dnLxuYWTpwewXcNqoXbGGu/USoV0LUqnmvjOhIhbSqahpovUiiWUdU8uVyefF5ldbWMJROVM7R39nD3hgc4fvIUjh+TzUuWC4JyVVI2XPKaR0HzCAMPai5x4EDoEvhegilcNMvFtiyUfZmDdKb3c9/mrQyPnOHzeZue0Syp0RxjHxb4+DZMfgGXv4a5HPxYhB/ycCsPltfo3fRcjWt3gEIWpW1vNzvaU6xv2sbIyBlufG+xbiDHvWd1+t/Pc2EWnr8a88J0zIvTMRMzMZOzMW9/FWM4MX4Y8202YlEHb/kXlObtO2jZ+SB3bWhieHiImwse6bEV+sZzXPykxLUFuL4AOaPBv5nz+zLK1tY2tu9q5577m5PR8z2borpEqaiimQ6WE+B4PkQ+1BrzWlfcdtzkAzFME8MUmELiuS5/ABxz1HBH+d+9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"\"\n        src=\"/static/0956893ef78003f039b2359440a7a2ca/d52e5/image1.png\"\n        srcset=\"/static/0956893ef78003f039b2359440a7a2ca/6f3f2/image1.png 256w,\n/static/0956893ef78003f039b2359440a7a2ca/01e7c/image1.png 512w,\n/static/0956893ef78003f039b2359440a7a2ca/d52e5/image1.png 848w\"\n        sizes=\"(max-width: 848px) 100vw, 848px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c4f609e254430db7c0792ef4b378c40d/236d7/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.79687500000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVR42m2Q0WoTQRSG90m8kF4UGxKCbbBUvdE78cpH8MonEsGnKBKSbJI2NZqKBhFfQLDWNprdmdnZ3Zmd2f0kE/Sm/vDNORc/Z875o27viL3uPi9fvWZ6csowHjOKJ8STKePJlMFozHF/wPGbPv3BiHg8ZTSehBpPTojP3jGczYmnpwwGQ6JW94BbO7ssl5/ZKDUWQxP67buV857/Sl7D+gKcxfmGqL1/yM5eh9nZnNIYVklKqjIKaymtReU5siiQZUFmTehTrcmsJdOK9Mt7kuWM5OIb61QStTtdWrt3mL2d451HqQytc2i2+9mqIs1zfgmJKsvA1TphrRRrlSE95IA2FiEkUevhU24fPGZ+/glXVeg8xzlH0zSBqqqw1mJtRVPX4aOmbqh9jfeeeuO1Bq01RWmI7j17QevJc86XX6nCGToY/2ozMAvmcptr09yI0eea7z8u+bn6TdQ7vE+ne5fF4pyqcshMY53D13XAWBu23py+GVbX9Q18mZMkCVfXK6Leg0e0e0csPnykMJbLJCEpcqQpEcaQZhlSyJBPmgqEEKH+QwiEVEipQoZ/ADx4ORyQAzcQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"\"\n        src=\"/static/c4f609e254430db7c0792ef4b378c40d/2bef9/image2.png\"\n        srcset=\"/static/c4f609e254430db7c0792ef4b378c40d/6f3f2/image2.png 256w,\n/static/c4f609e254430db7c0792ef4b378c40d/01e7c/image2.png 512w,\n/static/c4f609e254430db7c0792ef4b378c40d/2bef9/image2.png 1024w,\n/static/c4f609e254430db7c0792ef4b378c40d/236d7/image2.png 1486w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1601ffb646ca3a7ae40471328803b4f/663b1/image3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.53125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVR42pWTyZKDMAxEfSVAii2k2CEQEv7/A5V6mhHDMEuFQ2NZS9stC3e5XKRtW6mqSsqylCRJJMuyFWmaCjnAYnmeq9/i7LGJu9vtJvf7XWydpkmBPY6j+lnneVZf3/fyeDzWXGKsxIk5bkdwGD4KgSVTaAdQYHH8wzDI8/nUGLb5HDLZUICjrmttATdjNXnIAUg3ecAkY8dxLA7DipumkaIoNEAhq+/7cjqd3gK5LooiuV6vegoIguBbEvsjcHGSaF94ZQjP5/OPJE5+m5Ab0jfkWh8gMJIjZCuhSca2BzhK9CU5jvVBeAx7OYi3hIckh2G4Sobc8zzF9uX+I9jHHR9ImXJIbc4gB1b0F/akLghDdYzjJMuy6Ewy4Pbb0dvtMNt/TVt+lQwhRtd1SkIvKQg//YBRsj32drT2kl9kOVYMKYkeNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"\"\n        src=\"/static/b1601ffb646ca3a7ae40471328803b4f/2bef9/image3.png\"\n        srcset=\"/static/b1601ffb646ca3a7ae40471328803b4f/6f3f2/image3.png 256w,\n/static/b1601ffb646ca3a7ae40471328803b4f/01e7c/image3.png 512w,\n/static/b1601ffb646ca3a7ae40471328803b4f/2bef9/image3.png 1024w,\n/static/b1601ffb646ca3a7ae40471328803b4f/663b1/image3.png 1313w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>The main lack of this plugin is that it sends raw content without processing it, so were forced to figure out how to write my own and it was pretty easy</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">/*\nPlugin Name: machook\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">machook</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post_ID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_post</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post_ID</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token function\">apply_filters</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'the_content'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token property\">post_content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token function\">stream_context_create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        <span class=\"token string single-quoted-string\">'http'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'method'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'POST'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'content'</span> <span class=\"token operator\">=></span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n                <span class=\"token string single-quoted-string\">'post'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'html'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$html</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'header'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'Content-Type: application/json'</span>\n        <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://ee1e-178-150-44-191.ngrok.io/'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$context</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// $response = json_decode($result); // who cares 🤷‍♂️</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'post_updated'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'machook'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>"}},"pageContext":{"id":"f2c9bb6c-1ce3-5001-ae17-63eecbccb43f"}},"staticQueryHashes":[],"slicesMap":{}}