{"componentChunkName":"component---src-templates-note-js","path":"/sonar-cloud-api-register-project/","result":{"data":{"remark":{"fields":{"path":"sonar-cloud-api-register-project"},"meta":{"title":""},"headings":[{"value":"SonarCloud register GitHub repository via API"}],"html":"<h1>SonarCloud register GitHub repository via API</h1>\n<p>Going to fully automate SonarCloud in GitHub Actions</p>\n<p>Ideally for any new project all we need to do is something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/sonar\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">dotnet</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'6.0'</span>\n    <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SONAR_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>And everything else will be handled automatically</p>\n<p>And if with github action itself everything is convinient then the only missing part is addition of sonar cloud project</p>\n<p>Set of API call to register new repository in sonarcloud</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">SONAR_URL</span><span class=\"token operator\">=</span><span class=\"token string\">\"https://sonarcloud.io\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">SONAR_TOKEN</span><span class=\"token operator\">=</span><span class=\"token string\">\"************\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">SONAR_ORG</span><span class=\"token operator\">=</span><span class=\"token string\">\"acme\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">GITHUB_ORG</span><span class=\"token operator\">=</span><span class=\"token string\">\"contoso\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">REPO</span><span class=\"token operator\">=</span><span class=\"token string\">\"demo\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">KEY</span><span class=\"token operator\">=</span><span class=\"token string\">\"contoso_demo\"</span></code></pre></div>\n<h2>Projects</h2>\n<h3>Search</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_TOKEN</span>:\"</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_URL</span>/api/projects/search?organization=<span class=\"token variable\">$SONAR_ORG</span>&amp;q=<span class=\"token variable\">$REPO</span>\"</span></code></pre></div>\n<p><strong>200 found</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"paging\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"pageIndex\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"pageSize\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"components\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"organization\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"acme\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"contoso_demo\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"demo\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"qualifier\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"TRK\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"visibility\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"private\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"lastAnalysisDate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2021-11-17T22:18:11+0100\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"revision\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"27ea89546a654e4cf09b63719ee5b6daf72979c0\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>200 not found</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"paging\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"pageIndex\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"pageSize\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"components\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>400</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"msg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"The 'organization' parameter is missing\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Create</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_TOKEN</span>:\"</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_URL</span>/api/projects/create\"</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"name=<span class=\"token variable\">$REPO</span>&amp;project=<span class=\"token variable\">${GITHUB_ORG}</span>_<span class=\"token variable\">$REPO</span>&amp;organization=<span class=\"token variable\">$SONAR_ORG</span>&amp;visibility=private\"</span></code></pre></div>\n<p><strong>200 found</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"project\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"contoso_demo\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"demo\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"qualifier\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"TRK\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"visibility\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"private\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>400</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"msg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Could not create Project, key already exists: contoso_demo\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Branches</h2>\n<h3>List</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_TOKEN</span>:\"</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_URL</span>/api/project_branches/list\"</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"project=<span class=\"token variable\">${GITHUB_ORG}</span>_<span class=\"token variable\">$REPO</span>\"</span></code></pre></div>\n<p><strong>200 found</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"branches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"main\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"isMain\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"SHORT\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"mergeBranch\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"master\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"qualityGateStatus\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"OK\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"bugs\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"vulnerabilities\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"codeSmells\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"analysisDate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2021-11-18T08:57:05+0100\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"commit\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"sha\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"27ea89546a654e4cf09b63719ee5b6daf72979c0\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"master\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"isMain\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"LONG\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>404</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"msg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Component key 'contoso_demo' not found\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Delete</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_TOKEN</span>:\"</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_URL</span>/api/project_branches/delete\"</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"project=<span class=\"token variable\">${GITHUB_ORG}</span>_<span class=\"token variable\">$REPO</span>&amp;branch=main\"</span></code></pre></div>\n<p><strong>200 found</strong></p>\n<p>empty response</p>\n<p><strong>404</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"msg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Branch 'main' not found for project 'contoso_demo'\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Rename</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_TOKEN</span>:\"</span> <span class=\"token string\">\"<span class=\"token variable\">$SONAR_URL</span>/api/project_branches/rename\"</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"project=<span class=\"token variable\">${GITHUB_ORG}</span>_<span class=\"token variable\">$REPO</span>&amp;name=main\"</span></code></pre></div>\n<p><strong>200</strong></p>\n<p>empty response</p>\n<p><strong>404</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"msg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Project key 'contoso_demo' not found\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In my case I had repo with <code class=\"language-text\">main</code> bracnh and sonar expects <code class=\"language-text\">master</code> so need to delete main branch and rename master to main</p>\n<p>Note: seems like api does not care about method and everywhere post can be used</p>\n<p>Short note, how to get main branch name from git:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> symbolic-ref refs/remotes/origin/HEAD <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'s@^refs/remotes/origin/@@'</span></code></pre></div>\n<p>So the action can be something like:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'dotnet sonar'</span>\n<span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'GitHub Action DotNet SonarCloud'</span>\n<span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">dotnet_version</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'dotnet version of your project'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'6.0'</span>\n\n  <span class=\"token key atrule\">dotnet_test</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'determines whether \"dotnet test\" or \"dotnet build\" will be run'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'github token for sonar, usually secrets.GITHUB_TOKEN'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token key atrule\">sonar_enabled</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'switch to turn on/off sonar scanner, usefull for debugging'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token comment\"># Removed in favor to actions-sonar-register</span>\n  <span class=\"token comment\"># sonar_key:</span>\n  <span class=\"token comment\">#   description: 'sonar project key, it will be given to you after adding project to sonarcloud.io'</span>\n  <span class=\"token comment\">#   required: false</span>\n\n  <span class=\"token key atrule\">sonar_org</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'sonar project org'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n  <span class=\"token key atrule\">sonar_url</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'sonar url, to where data will be sent'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'https://sonarcloud.io'</span>\n\n  <span class=\"token key atrule\">sonar_token</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'sonar token, usually it will be secrets.SONAR_TOKEN'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n\n  <span class=\"token key atrule\">sonar_coverage_report</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'path to sonar reports'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'**/TestResults/**/coverage.opencover.xml'</span>\n\n  <span class=\"token key atrule\">sonar_tests_report</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'tests report'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'**/TestResults/*.trx'</span>\n\n  <span class=\"token key atrule\">sonar_coverage_exclusions</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'optional, comma separated list of paths to exclude from coverage'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'**Test*.cs'</span>\n\n  <span class=\"token key atrule\">checkout</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'checkout sources'</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n<span class=\"token key atrule\">runs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">using</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'composite'</span>\n  <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.checkout\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">fetch-depth</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./github/actions/actions<span class=\"token punctuation\">-</span>sonar<span class=\"token punctuation\">-</span>register@main\n      <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> register\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>dotnet@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">dotnet-version</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.dotnet_version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>java@v1\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">java-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1.11</span>\n\n    <span class=\"token comment\"># required by sonar scanner dotnet tool</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>dotnet@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">dotnet-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'5.0'</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/cache@v1\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> ~\\sonar\\cache\n        <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> runner.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>sonar\n        <span class=\"token key atrule\">restore-keys</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> runner.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>sonar\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/cache@v1\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> cache<span class=\"token punctuation\">-</span>sonar<span class=\"token punctuation\">-</span>scanner\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> .\\.sonar\\scanner\n        <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> runner.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>sonar<span class=\"token punctuation\">-</span>scanner\n        <span class=\"token key atrule\">restore-keys</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> runner.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>sonar<span class=\"token punctuation\">-</span>scanner\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sonar install\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled <span class=\"token important\">&amp;&amp;</span> steps.cache<span class=\"token punctuation\">-</span>sonar<span class=\"token punctuation\">-</span>scanner.outputs.cache<span class=\"token punctuation\">-</span>hit <span class=\"token tag\">!=</span> 'true'\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> mkdir <span class=\"token punctuation\">-</span>p ./.sonar/scanner <span class=\"token important\">&amp;&amp;</span> dotnet tool update dotnet<span class=\"token punctuation\">-</span>sonarscanner <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>tool<span class=\"token punctuation\">-</span>path ./.sonar/scanner\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sonar begin\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> ./.sonar/scanner/dotnet<span class=\"token punctuation\">-</span>sonarscanner begin /k<span class=\"token punctuation\">:</span>\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.register.outputs.key <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" /o<span class=\"token punctuation\">:</span>\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_org <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" /d<span class=\"token punctuation\">:</span>sonar.login=\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" /d<span class=\"token punctuation\">:</span>\"sonar.host.url=$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_url <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" /d<span class=\"token punctuation\">:</span>sonar.cs.opencover.reportsPaths=\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_coverage_report <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" <span class=\"token punctuation\">-</span>d<span class=\"token punctuation\">:</span>sonar.cs.vstest.reportsPaths=\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_tests_report <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\" /d<span class=\"token punctuation\">:</span>sonar.coverage.exclusions=\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.sonar_coverage_exclusions <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\"\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.github_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> dotnet build\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> dotnet build\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> dotnet test\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled <span class=\"token important\">&amp;&amp;</span> inputs.dotnet_test\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> dotnet test <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>logger=trx <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>collect<span class=\"token punctuation\">:</span>\"XPlat Code Coverage\" <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span> DataCollectionRunSettings.DataCollectors.DataCollector.Configuration.Format=opencover\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sonar end\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> inputs.sonar_enabled\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> ./.sonar/scanner/dotnet<span class=\"token punctuation\">-</span>sonarscanner end /d<span class=\"token punctuation\">:</span>sonar.login=\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>inputs.sonar_token<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\"\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.github_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div></p>\n<p>Which allow use it as simple as:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> main\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>main<span class=\"token punctuation\">]</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">main</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./github/actions/actions<span class=\"token punctuation\">-</span>dotnet<span class=\"token punctuation\">-</span>sonar\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">sonar_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SONAR_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">dotnet_version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'6.0'</span>\n          <span class=\"token key atrule\">sonar_org</span><span class=\"token punctuation\">:</span> demo\n          <span class=\"token comment\"># sonar_key: demo # automated with dedicated sonar registration action</span></code></pre></div>\n<p>And here is starting point for sonar registration action:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> axios<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> AxiosInstance<span class=\"token punctuation\">,</span> AxiosError <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">SONAR_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'https://sonarcloud.io'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SonarCloudClient</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> axios<span class=\"token operator\">:</span> AxiosInstance\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> org<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">private</span> token<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios <span class=\"token operator\">=</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      baseURL<span class=\"token operator\">:</span> <span class=\"token constant\">SONAR_URL</span><span class=\"token punctuation\">,</span>\n      timeout<span class=\"token operator\">:</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">,</span>\n      auth<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> username<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">,</span> password<span class=\"token operator\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/x-www-form-urlencoded'</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span>githubOrganization<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> repositoryName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> mainBranchName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>githubOrganization<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">_</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>repositoryName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> components <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">searchProjects</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>org<span class=\"token punctuation\">,</span> repositoryName<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> found <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">,</span> name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> key <span class=\"token operator\">===</span> project <span class=\"token operator\">&amp;&amp;</span> name <span class=\"token operator\">===</span> repositoryName<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>found<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">createProject</span><span class=\"token punctuation\">(</span>repositoryName<span class=\"token punctuation\">,</span> project<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>org<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> branches <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBranches</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>branches<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> isMain <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> name <span class=\"token operator\">===</span> mainBranchName <span class=\"token operator\">&amp;&amp;</span> isMain <span class=\"token operator\">===</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">deleteBranch</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">,</span> mainBranchName<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renameBranch</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">,</span> mainBranchName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> Error <span class=\"token operator\">|</span> AxiosError <span class=\"token operator\">|</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      SonarCloudClient<span class=\"token punctuation\">.</span><span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">searchProjects</span><span class=\"token punctuation\">(</span>organization<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> q<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>SonarSearchResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">get</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SonarSearchResponse<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/projects/search'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> params<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> organization<span class=\"token punctuation\">,</span> q <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> data\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">createProject</span><span class=\"token punctuation\">(</span>name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> project<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> organization<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n    params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'project'</span><span class=\"token punctuation\">,</span> project<span class=\"token punctuation\">)</span>\n    params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'organization'</span><span class=\"token punctuation\">,</span> organization<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/projects/create'</span><span class=\"token punctuation\">,</span> params<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getBranches</span><span class=\"token punctuation\">(</span>project<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>SonarBranchesListResponse<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">get</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SonarBranchesListResponse<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/project_branches/list'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> params<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> project <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> data\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">deleteBranch</span><span class=\"token punctuation\">(</span>project<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> branch<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'project'</span><span class=\"token punctuation\">,</span> project<span class=\"token punctuation\">)</span>\n    params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'branch'</span><span class=\"token punctuation\">,</span> branch<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/project_branches/delete'</span><span class=\"token punctuation\">,</span> params<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">renameBranch</span><span class=\"token punctuation\">(</span>project<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/project_branches/rename'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> params<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> project<span class=\"token punctuation\">,</span> name <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> Error <span class=\"token operator\">|</span> AxiosError <span class=\"token operator\">|</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>axios<span class=\"token punctuation\">.</span><span class=\"token function\">isAxiosError</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> message <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>response<span class=\"token operator\">?.</span>data <span class=\"token keyword\">as</span> SonarErrorResponse<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span>errors<span class=\"token operator\">?.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> error<span class=\"token operator\">?.</span>msg<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">||</span> error<span class=\"token operator\">?.</span>message<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> error\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SonarSearchResponse</span> <span class=\"token punctuation\">{</span>\n  components<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SonarBranchesListResponse</span> <span class=\"token punctuation\">{</span>\n  branches<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    isMain<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SonarErrorResponse</span> <span class=\"token punctuation\">{</span>\n  errors<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> msg<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div></p>\n<h2>Links</h2>\n<ul>\n<li><a href=\"https://sonarcloud.io/web_api\">SonarCloud Web API</a></li>\n</ul>"}},"pageContext":{"id":"3e149a8e-7c15-567c-8cb3-e26e8ec39ad0"}},"staticQueryHashes":[],"slicesMap":{}}