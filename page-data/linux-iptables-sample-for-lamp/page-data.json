{"componentChunkName":"component---src-templates-note-js","path":"/linux-iptables-sample-for-lamp/","result":{"data":{"remark":{"fields":{"path":"linux-iptables-sample-for-lamp"},"meta":{"title":""},"headings":[{"value":"Linux iptables sample for lamp"}],"html":"<h1>Linux iptables sample for lamp</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\n<span class=\"token comment\">#save this to firewall.sh, and make chmod +x firewall.sh</span>\n<span class=\"token comment\">#available ports: icmp, tcp, udp</span>\n<span class=\"token comment\">#to see what is running on what port: netstat -tulpn</span>\n\n<span class=\"token comment\">#flush all rules</span>\n/sbin/iptables <span class=\"token parameter variable\">-F</span>\n\n<span class=\"token comment\">#allow all trafic on localhost interface</span>\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-i</span> lo <span class=\"token parameter variable\">-j</span> ACCEPT\n\n<span class=\"token comment\">#allow icmp (ping) packets</span>\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> icmp <span class=\"token parameter variable\">-j</span> ACCEPT\n\n<span class=\"token comment\">#allow input trafic that was initiated from us</span>\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-m</span> state <span class=\"token parameter variable\">--state</span> ESTABLISHED,RELATED <span class=\"token parameter variable\">-j</span> ACCEPT\n\n<span class=\"token comment\">#allow input trafic for specific portsz</span>\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">20</span> <span class=\"token parameter variable\">-j</span> ACCEPT\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">21</span> <span class=\"token parameter variable\">-j</span> ACCEPT\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">22</span> <span class=\"token parameter variable\">-j</span> ACCEPT\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">80</span> <span class=\"token parameter variable\">-j</span> ACCEPT\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">3306</span> <span class=\"token parameter variable\">-j</span> ACCEPT\n/sbin/iptables <span class=\"token parameter variable\">-A</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token number\">1024</span>:65535 <span class=\"token parameter variable\">-j</span> ACCEPT\n\n<span class=\"token comment\">#default action for other packets</span>\n/sbin/iptables <span class=\"token parameter variable\">-P</span> INPUT DROP\n/sbin/iptables <span class=\"token parameter variable\">-P</span> FORWARD DROP\n/sbin/iptables <span class=\"token parameter variable\">-P</span> OUTPUT ACCEPT\n\n<span class=\"token comment\">#save rules</span>\n/sbin/service iptables save\n\n<span class=\"token comment\">#list rules</span>\n/sbin/iptables <span class=\"token parameter variable\">-L</span> <span class=\"token parameter variable\">-v</span></code></pre></div>\n<p>Another variant is to:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> iptables-persistent</code></pre></div>\n<p>Now run all commands above to add firewall rules, and run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">iptables-save <span class=\"token operator\">></span> /etc/iptables/rules</code></pre></div>\n<p>If you will add new rule laterm do not forget to add them using command above</p>"}},"pageContext":{"id":"23a9b4ef-4638-5b8c-b9f4-9571160f44bc"}},"staticQueryHashes":[],"slicesMap":{}}