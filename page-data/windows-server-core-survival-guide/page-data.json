{"componentChunkName":"component---src-templates-note-js","path":"/windows-server-core-survival-guide/","result":{"data":{"remark":{"fields":{"path":"windows-server-core-survival-guide"},"meta":{"title":""},"headings":[{"value":"windows server core - survival guide"}],"html":"<h1>windows server core - survival guide</h1>\n<p><a href=\"https://www.mssqltips.com/sqlservertip/2642/installing-sql-server-2012-on-windows-server-core-part-1/\">https://www.mssqltips.com/sqlservertip/2642/installing-sql-server-2012-on-windows-server-core-part-1/</a></p>\n<h2>Basic server configuration</h2>\n<p><code class=\"language-text\">sconfig</code> - perform basic server configuration like changin computer name, deal with network ip addresses, setup updates etc.</p>\n<h2>Languages</h2>\n<p>List installed languages</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Get-WinUserLanguageList</code></pre></div>\n<p>Set languages to english only</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Set-WinUserLanguageList -LanguageList en-US -Force</code></pre></div>\n<blockquote>\n<p>Notice: before removing unwanted keyboard languages make sure that your password is not in that langugage</p>\n</blockquote>\n<h2>Region and Date Time</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">c:\\windows\\system32\\intl.cpl</code></pre></div>\n<h2>Set new password</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">net user administrator P@ssword</code></pre></div>\n<p>optionally you may need to activate user if running container:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">net user administrator /active:yes</code></pre></div>\n<p>Adding new admin account</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">net user /add mac P@ssword\nnet localgroup administrators mac /add</code></pre></div>\n<h2>Rename network adapters</h2>\n<p>List available network adapters</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Get-NetAdapter</code></pre></div>\n<p>Determine required interface index</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Get-NetIPAddress -AddressFamily IPv4 | Select-Object InterfaceIndex, IPAddress, PrefixOrigin</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Rename-NetAdapter -Name &#39;Ethernet&#39; -NewName &#39;LAN&#39;\nRename-NetAdapter -Name &#39;Ethernet 2&#39; -NewName &#39;WAN&#39;</code></pre></div>\n<h2>Add domain user to local administrators group</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">net localgroup Administrators /add RABOTA<span class=\"token punctuation\">\\</span>AlexandrM</code></pre></div>\n<h2>Disable IPv6</h2>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Disable-NetAdapterBinding -InterfaceAlias Ethernet -ComponentID ms_tcpip6</code></pre></div>\n<h2>Set PATH</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">SETX /M <span class=\"token environment constant\">PATH</span> <span class=\"token string\">\"%PATH%;C:\\your path with spaces\"</span></code></pre></div>\n<blockquote>\n<p><code class=\"language-text\">/M</code> - adds path to machine, without it user path will be modified</p>\n</blockquote>\n<h2>Cleanup and analyze disk</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Dism.exe /online /Cleanup-Image /AnalyzeComponentStore\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase</code></pre></div>\n<h2>Get disk space</h2>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">$c = get-wmiobject Win32_LogicalDisk |? DeviceID -EQ &#39;C:&#39;\n($c.Size - $c.FreeSpace) / 1Gb</code></pre></div>\n<h2>Measure disk speed</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">winsat disk <span class=\"token parameter variable\">-drive</span> c</code></pre></div>\n<h2>Optimize VHD (reduce vhdx file size)</h2>\n<p>Turn off VM</p>\n<p>Attach VHD to your host machine</p>\n<p>run sdelete (<a href=\"https://technet.microsoft.com/en-us/sysinternals/sdelete.aspx\">https://technet.microsoft.com/en-us/sysinternals/sdelete.aspx</a>)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">sdelete <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-z</span> e:</code></pre></div>\n<p>Defragment drive</p>\n<p>In drive management shrink disk as much as possible</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Get-VM | Get-VMHardDiskDrive | Optimize-VHD -Mode Full</code></pre></div>\n<h2>Firewall</h2>\n<h3>Allow certain port</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">New-NetFirewallRule -DisplayName &quot;Postgres&quot; -Direction Inbound -Protocol TCP -LocalPort 5432 -Action Allow</code></pre></div>\n<h3>Allow RDP</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Enable-NetFirewallRule -DisplayGroup “Remote Desktop”</code></pre></div>\n<h3>Allow ICMP</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">netsh firewall <span class=\"token builtin class-name\">set</span> icmpsetting <span class=\"token number\">8</span></code></pre></div>\n<h3>Turnoff Firewall</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">Get-NetFirewallProfile | Set-NetFirewallProfile -enabled false</code></pre></div>\n<h2>Environment Variables</h2>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">[Environment]::SetEnvironmentVariable(&#39;JAVA_HOME&#39;, &#39;C:\\jre&#39;, &#39;MACHINE&#39;)\n\n$old_path = [Environment]::GetEnvironmentVariable(&#39;PATH&#39;, &#39;MACHINE&#39;)\n\n[Environment]::SetEnvironmentVariable(&#39;PATH&#39;, &quot;$old_path;C:\\jre\\bin&quot;, &#39;MACHINE&#39;)</code></pre></div>\n<h2>Software</h2>\n<h3>JRE</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\"># Command line installation options: http://docs.oracle.com/javase/8/docs/technotes/guides/install/config.html\n\n# Download link can be found here (look for Windows Offline 64-bit): http://www.java.com/en/download/manual.jsp\n\ncd ~/Downloads\n\nInvoke-WebRequest &#39;http://javadl.oracle.com/webapps/download/AutoDL?BundleId=207231&#39; -OutFile jre-8u77-windows-x64.exe\n\n.\\jre-8u77-windows-x64.exe INSTALL_SILENT=Enable STATIC=Enable AUTO_UPDATE=Disable NOSTARTMENU=Enable\n\n$jre = Get-ChildItem &#39;C:\\Program Files\\Java&#39; | Sort-Object Name | Select-Object -ExpandProperty Name -First 1\n\n$java_home = &quot;C:\\Program Files\\Java\\$jre&quot;\n\n$java_bin = &quot;$java_home\\bin&quot;\n\n$old_path = [Environment]::GetEnvironmentVariable(&#39;PATH&#39;, &#39;MACHINE&#39;)\n\n[Environment]::SetEnvironmentVariable(&#39;JAVA_HOME&#39;, $java_home, &#39;MACHINE&#39;)\n\n[Environment]::SetEnvironmentVariable(&#39;PATH&#39;, &quot;$old_path;$java_bin&quot;, &#39;MACHINE&#39;)\n\nRestart-Computer -Force\n\njava -version</code></pre></div>"}},"pageContext":{"id":"9ff1705e-eaab-50bf-836b-8f977c17157c"}},"staticQueryHashes":[],"slicesMap":{}}