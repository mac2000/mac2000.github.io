{"componentChunkName":"component---src-templates-note-js","path":"/php-domdocument-print-tree/","result":{"data":{"remark":{"fields":{"path":"php-domdocument-print-tree"},"meta":{"title":""},"headings":[{"value":"php DOMDocument print tree"}],"html":"<h1>php DOMDocument print tree</h1>\n<p>Небольшой скрипт для вывода дерева элементов документа:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://google.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$doc</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n@<span class=\"token variable\">$doc</span><span class=\"token operator\">-></span><span class=\"token function\">loadHTML</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$html</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$body</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$doc</span><span class=\"token operator\">-></span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">item</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">printnodes</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$body</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">printnodes</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">DOMNode</span> <span class=\"token variable\">$node</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">childNodes</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">method_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$child</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'getAttribute'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'class'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'#'</span><span class=\"token operator\">.</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'.'</span><span class=\"token operator\">.</span><span class=\"token variable\">$class</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$attr</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$attr</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' ['</span><span class=\"token operator\">.</span><span class=\"token variable\">$id</span><span class=\"token operator\">.</span><span class=\"token variable\">$class</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">']'</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$level</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&amp;nbsp;'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$child</span><span class=\"token operator\">-></span><span class=\"token property\">nodeName</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$attr</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;br />'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$child</span><span class=\"token operator\">-></span><span class=\"token function\">hasChildNodes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token function\">printnodes</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$child</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$level</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>на выходе получится что то вроде такого:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">textarea\ndiv\n    div [#ghead]\n        div [#gog]\n            nobr [#gbar]\n                b\n                    #text\n                #text\n                a\n                    #text\n                #text\n                a\n                    #text\n                #text\n                a\n                ...</code></pre></div>"}},"pageContext":{"id":"99de547b-841e-5a8a-9f8e-40646aab5bfd"}},"staticQueryHashes":[],"slicesMap":{}}