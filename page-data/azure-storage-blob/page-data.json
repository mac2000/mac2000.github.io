{"componentChunkName":"component---src-templates-note-js","path":"/azure-storage-blob/","result":{"data":{"remark":{"fields":{"path":"azure-storage-blob"},"meta":{"title":""},"headings":[{"value":"Azure Blob Storage"}],"html":"<h1>Azure Blob Storage</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Install-Package WindowsAzure.Storage</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>add</span> <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>StorageConnectionString<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>DefaultEndpointsProtocol=https;AccountName=contoso;AccountKey=xxxxx<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> storageAccount <span class=\"token operator\">=</span> CloudStorageAccount<span class=\"token punctuation\">.</span><span class=\"token function\">Parse</span><span class=\"token punctuation\">(</span>ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"StorageConnectionString\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> blobClient <span class=\"token operator\">=</span> storageAccount<span class=\"token punctuation\">.</span><span class=\"token function\">CreateCloudBlobClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> container <span class=\"token operator\">=</span> blobClient<span class=\"token punctuation\">.</span><span class=\"token function\">GetContainerReference</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cvphotos\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> fileName <span class=\"token operator\">=</span> <span class=\"token interpolation-string\"><span class=\"token string\">$\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">Guid<span class=\"token punctuation\">.</span><span class=\"token function\">NewGuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"N\"</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">Path<span class=\"token punctuation\">.</span><span class=\"token function\">GetExtension</span><span class=\"token punctuation\">(</span>FileUpload<span class=\"token punctuation\">.</span>PostedFile<span class=\"token punctuation\">.</span>FileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">?.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> output <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MemoryStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\n  ImageBuilder<span class=\"token punctuation\">.</span>Current<span class=\"token punctuation\">.</span><span class=\"token function\">Build</span><span class=\"token punctuation\">(</span>FileUpload<span class=\"token punctuation\">.</span>PostedFile<span class=\"token punctuation\">.</span>InputStream<span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ResizeSettings</span>\n  <span class=\"token punctuation\">{</span>\n    MaxWidth <span class=\"token operator\">=</span> <span class=\"token number\">112</span><span class=\"token punctuation\">,</span>\n    MaxHeight <span class=\"token operator\">=</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\n    Mode <span class=\"token operator\">=</span> FitMode<span class=\"token punctuation\">.</span>Crop<span class=\"token punctuation\">,</span>\n    Scale <span class=\"token operator\">=</span> ScaleMode<span class=\"token punctuation\">.</span>Both<span class=\"token punctuation\">,</span>\n    Anchor <span class=\"token operator\">=</span> ContentAlignment<span class=\"token punctuation\">.</span>MiddleCenter<span class=\"token punctuation\">,</span>\n    Format <span class=\"token operator\">=</span> <span class=\"token string\">\"jpg\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> blockBlob <span class=\"token operator\">=</span> container<span class=\"token punctuation\">.</span><span class=\"token function\">GetBlockBlobReference</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  blockBlob<span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">.</span>ContentType <span class=\"token operator\">=</span> FileUpload<span class=\"token punctuation\">.</span>PostedFile<span class=\"token punctuation\">.</span>ContentType<span class=\"token punctuation\">;</span>\n  output<span class=\"token punctuation\">.</span><span class=\"token function\">Seek</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> SeekOrigin<span class=\"token punctuation\">.</span>Begin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  blockBlob<span class=\"token punctuation\">.</span><span class=\"token function\">UploadFromStream</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Image<span class=\"token punctuation\">.</span>ImageUrl <span class=\"token operator\">=</span> blockBlob<span class=\"token punctuation\">.</span>Uri<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Image<span class=\"token punctuation\">.</span>Visible <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>"}},"pageContext":{"id":"7a24b8e1-fd96-5c86-b6dc-e643dc9f7775"}},"staticQueryHashes":[],"slicesMap":{}}