{"componentChunkName":"component---src-templates-note-js","path":"/redis-replication-pubsub/","result":{"data":{"remark":{"fields":{"path":"redis-replication-pubsub"},"meta":{"title":""},"headings":[{"value":"Redis Replication PubSub"}],"html":"<h1>Redis Replication PubSub</h1>\n<p>PubSub works the same way as key value storage - e.g. writes should go to master node, reads might be done from any node</p>\n<p>Start 2 redis instances</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>r1 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6381</span>:6379 redis:alpine\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>r2 <span class=\"token parameter variable\">--link</span><span class=\"token operator\">=</span>r1 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6382</span>:6379 redis:alpine</code></pre></div>\n<p>Tell second instance to be slave of first one</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> r2 redis-cli slaveof r1 <span class=\"token number\">6379</span></code></pre></div>\n<p>Subscribe to PubSub on both instances</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> r1 redis-cli SUBSCRIBE mypubsub\n<span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> r2 redis-cli SUBSCRIBE mypubsub</code></pre></div>\n<p>Publish message to master (will be received by both master and slave)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> r1 redis-cli PUBLISH mypubsub HelloFromMaster</code></pre></div>\n<p>Publish message to slave (will be received only by slave)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> r2 redis-cli PUBLISH mypubsub HelloFromSlave</code></pre></div>"}},"pageContext":{"id":"e0c656d8-0967-5fa0-b2bc-7a6b27ec5f65"}},"staticQueryHashes":[],"slicesMap":{}}