{"componentChunkName":"component---src-templates-note-js","path":"/powershell-smtp-list-queue-mail-subjects/","result":{"data":{"remark":{"fields":{"path":"powershell-smtp-list-queue-mail-subjects"},"meta":{"title":""},"headings":[{"value":"Powershell SMT list queue mail subjects"}],"html":"<h1>Powershell SMT list queue mail subjects</h1>\n<p>Скрпит пробежиться по очередям всех smtp, и повыдерает из всех писем их subject и затем выдаст общую статистику</p>\n<p>Может быть молезным в случае если необходимо ответить на вопрос: какими письмами прямо сейчас забит SMTP</p>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\">$reader = New-Object -ComObject ADODB.Stream\n$mail = New-Object -ComObject CDO.Message\n$reader.Open()\n\n$emls = Get-ChildItem -Path C:\\inetpub\\*\\Queue\\*.EML\n\n# $emls = $emls | Select-Object -First 10000\n\n$emls.Count\n\n$items = @()\nforeach($eml in $emls) {\n    try {\n    if (-not (Test-Path $eml.FullName)) {\n        continue\n    }\n    $reader.LoadFromFile($eml.FullName)\n    $mail.DataSource.OpenObject($reader,&quot;_Stream&quot;)\n    $subject = $mail.Subject.Trim()\n    if ($subject -like &quot;Ваше резюме «*» получило просмотры в базе резюме&quot;) {\n        $subject = &quot;Ваше резюме «*» получило просмотры в базе резюме&quot;\n    }\n    elseif ($subject -like &quot;Ваше резюме успішно доставлено в компанію «*»&quot;) {\n        $subject = &quot;Ваше резюме успішно доставлено в компанію «*»&quot;\n    }\n    elseif ($subject -like &quot;Найдены подходящие кандидаты на вакансию *&quot;) {\n        $subject = &quot;Найдены подходящие кандидаты на вакансию *&quot;\n    }\n    elseif ($subject -like &quot;Компанія * переглянула ваш відгук на вакансію&quot;) {\n        $subject = &quot;Компанія * переглянула ваш відгук на вакансію&quot;\n    }\n    elseif ($subject -like &quot;Ваше резюме успешно доставлено в компанию «*»&quot;) {\n        $subject = &quot;Ваше резюме успешно доставлено в компанию «*»&quot;\n    }\n    elseif ($subject -like &quot;Ваше резюме успешно доставлено в компанию «*»&quot;) {\n        $subject = &quot;Ваше резюме успешно доставлено в компанию «*»&quot;\n    }\n    elseif ($subject -like &quot;Новые резюме в базе rabota.ua *&quot;) {\n        $subject = &quot;Новые резюме в базе rabota.ua *&quot;\n    }\n    elseif ($subject -like &quot;Компанія * запросила вас на співбесіду на вакансію *&quot;) {\n        $subject = &quot;Компанія * запросила вас на співбесіду на вакансію *&quot;\n    }\n    elseif ($subject -like &quot;Ваше резюме успешно доставлено в компанию *&quot;) {\n        $subject = &quot;Ваше резюме успешно доставлено в компанию * на вакансию *&quot;\n    }\n    elseif ($subject -like &quot;Ваше резюме успішно доставлено в компанію *&quot;) {\n        $subject = &quot;Ваше резюме успішно доставлено в компанію *&quot;\n    }\n    elseif ($subject -like &quot;У вас есть новые сообщения в чате от *&quot;) {\n        $subject = &quot;У вас есть новые сообщения в чате от *&quot;\n    }\n    elseif ($subject -like &quot;* просмотрела ваш отклик на вакансию&quot;) {\n        $subject = &quot;* просмотрела ваш отклик на вакансию&quot;\n    }\n    elseif ($subject -like &quot;Завершена вакансія *, на яку ви відправляли резюме.&quot;) {\n        $subject = &quot;Завершена вакансія *, на яку ви відправляли резюме.&quot;\n    }\n    elseif ($subject -like &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние 7 дней&quot;) {\n        $subject = &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние 7 дней&quot;\n    }\n    elseif ($subject -like &quot;* переглянула ваш відгук на вакансію&quot;) {\n        $subject = &quot;* переглянула ваш відгук на вакансію&quot;\n    }\n    elseif ($subject -like &quot;* отримало перегляди в базі резюме&quot;) {\n        $subject = &quot;* отримало перегляди в базі резюме&quot;\n    }\n    elseif ($subject -like &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние месяц&quot;) {\n        $subject = &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние месяц&quot;\n    }\n    elseif ($subject -like &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние 14 дней&quot;) {\n        $subject = &quot;*, посмотрите новые вакансии которые могут быть вам интересны за последние 14 дней&quot;\n    }\n    elseif ($subject -like &quot;* пригласила вас на собеседование на вакансию *&quot;) {\n        $subject = &quot;Компания * пригласила вас на собеседование на вакансию *&quot;\n    }\n    elseif ($subject -like &quot;* відмовила вам у співбесіді на вакансію *&quot;) {\n        $subject = &quot;Компанія * відмовила вам у співбесіді на вакансію *&quot;\n    }\n    elseif ($subject -like &quot;Дополнительные вакансии *&quot;) {\n        $subject = &quot;Дополнительные вакансии *&quot;\n    }\n    elseif ($subject -like &quot;У вас є нові повідомлення в чаті від *&quot;) {\n        $subject = &quot;У вас є нові повідомлення в чаті від *&quot;\n    }\n    elseif ($subject -like &quot;Новий вiдгук на вашу вакансию *&quot;) {\n        $subject = &quot;Новий вiдгук на вашу вакансию *&quot;\n    }\n    elseif ($subject -like &quot;Новый отклик на вашу вакансию *&quot;) {\n        $subject = &quot;Новый отклик на вашу вакансию *&quot;\n    }\n    elseif ($subject -like &quot;* предлагает Вам ознакомиться со своей вакансией&quot;) {\n        $subject = &quot;* предлагает Вам ознакомиться со своей вакансией&quot;\n    }\n    elseif ($subject -like &quot;* просмотрела ваш отклик на вакансию *&quot;) {\n        $subject = &quot;Компания * просмотрела ваш отклик на вакансию *&quot;\n    }\n    elseif ($subject -like &quot;* отказала вам в собеседовании на вакансию *&quot;) {\n        $subject = &quot;Компания * отказала вам в собеседовании на вакансию *&quot;\n    }\n    elseif ($subject -like &quot;* переглянула ваш відгук на вакансію *&quot;) {\n        $subject = &quot;Компанія * переглянула ваш відгук на вакансію *&quot;\n    }\n\n\n\n    #Write-Host &quot;$($eml.Directory.Parent.Name): $($mail.Subject)&quot;\n    $items += New-Object PSObject -Property @{\n        smtp = $eml.Directory.Parent.Name\n        subject = $subject\n    }\n    } catch {}\n\n    Write-Progress -Activity &#39;Title&#39; -Status $eml.FullName -PercentComplete ( [Array]::IndexOf($emls, $eml) / $emls.Count * 100 )\n}\n\n$items | Group-Object subject | Sort-Object Count -Descending | Select-Object Count, Name | Format-Table -AutoSize\n$emls.Count</code></pre></div>"}},"pageContext":{"id":"7de05c52-537b-519e-a6ae-6487c59f0d1d"}},"staticQueryHashes":[],"slicesMap":{}}