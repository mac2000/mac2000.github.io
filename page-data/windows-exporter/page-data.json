{"componentChunkName":"component---src-templates-note-js","path":"/windows-exporter","result":{"data":{"remark":{"fields":{"path":"windows-exporter"},"meta":{"title":""},"headings":[{"value":"Kubernetes Windows node exporter"}],"html":"<h1>Kubernetes Windows node exporter</h1>\n<p>here is an example of working node exporter for windows server in kubernetes</p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> DaemonSet\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n  <span class=\"token comment\"># namespace: dev</span>\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">kubernetes.io/os</span><span class=\"token punctuation\">:</span> windows\n      <span class=\"token key atrule\">securityContext</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">windowsOptions</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">hostProcess</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n          <span class=\"token key atrule\">runAsUserName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NT AUTHORITY\\\\system\"</span>\n      <span class=\"token key atrule\">hostNetwork</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> ghcr.io/prometheus<span class=\"token punctuation\">-</span>community/windows<span class=\"token punctuation\">-</span>exporter<span class=\"token punctuation\">:</span>latest\n        <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> Always\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>config.file=%CONTAINER_SANDBOX_MOUNT_POINT%/config.yml\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">9182</span>\n        <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span>  windows<span class=\"token punctuation\">-</span>exporter\n          <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /config.yml\n          <span class=\"token key atrule\">subPath</span><span class=\"token punctuation\">:</span> config.yml\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n        <span class=\"token key atrule\">configMap</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ConfigMap\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> windows<span class=\"token punctuation\">-</span>exporter\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">config.yml</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    collectors:\n      enabled: 'cpu,cs,container,logical_disk,net,os,service,system'\n    collector:\n      service:\n        services-where: \"Name='containerd' or Name='kubelet'\"</span></code></pre></div></p>\n<p>note that metrics will have only containerd identifier, you can join them with container info metric</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">kube_pod_container_info{container=\"my-app\", container_id=~\"containerd://.+\"}</code></pre></div>\n<h2>Links</h2>\n<ul>\n<li><a href=\"https://github.com/prometheus-community/windows_exporter\">https://github.com/prometheus-community/windows_exporter</a></li>\n<li><a href=\"https://github.com/prometheus-community/windows_exporter/blob/master/kubernetes/kubernetes.md\">https://github.com/prometheus-community/windows_exporter/blob/master/kubernetes/kubernetes.md</a></li>\n<li><a href=\"https://github.com/prometheus-community/windows_exporter/blob/master/README.md#using-a-configuration-file\">https://github.com/prometheus-community/windows_exporter/blob/master/README.md#using-a-configuration-file</a></li>\n<li><a href=\"https://github.com/prometheus-community/windows_exporter/blob/master/kubernetes/windows-exporter-daemonset.yaml\">https://github.com/prometheus-community/windows_exporter/blob/master/kubernetes/windows-exporter-daemonset.yaml</a></li>\n</ul>"}},"pageContext":{"id":"72b5397e-b69f-5de1-a70d-e7935b89dc5f"}},"staticQueryHashes":[]}