{"componentChunkName":"component---src-templates-note-js","path":"/google-app-engine-and-yahoo-pipes-fetch-page-web-service/","result":{"data":{"remark":{"fields":{"path":"google-app-engine-and-yahoo-pipes-fetch-page-web-service"},"meta":{"title":""},"headings":[{"value":"Google app engine and Yahoo Pipes — fetch page web service"}],"html":"<h1>Google app engine and Yahoo Pipes — fetch page web service</h1>\n<p>Yahoo Pipes build in <a href=\"http://pipes.yahoo.com/pipes/docs?doc=sources#FetchPage\">fetch page</a> module have restriction - it can fetch pages only under 200 kb.</p>\n<p>Pipe looks like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 471px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.09375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACrklEQVR42mWST2/TQBDF86E5QKUKCRUJ2oKAA1dOCL4AB4QQbakACQlK27QpaZs4qR3bsePaju34z+6PWaelVGz0MrPjmfdmd7aT14pMUCuFNdc83LFZ2xqz8c3jeU/x/ETzrKfF17w40W3M7F/vu7z/tM/Yn1NBy2G4OvmVs2gUl6Wmezag97uPE8b48VyQEc0LgjTDk32Q5lwWFUWjSSupWSxrr3k6xT+EsUj5tkXY/8m55WCNLhiNxnQHNqeWzXhkS8xmdpkg6UIKSbmsLWpNcd2habdoljaVD6moZ1IwlwJpml+R4jzTVOKnEjM5iXRncF2bS03emA4boyAEkp0blUa3anml2n0lBd1EY4lCbUSv865yjd8et6rFNnSSry8J392B3VXYWUFv3UNv31h2VxhvrRNtr8n3u2jJafNMTuvfpfr8AHv7FfHWGzpT+4y9/QOOjg44G/SZhn6LcDYlCD1OT/scH/zg6HAPL3CJ4lDuMFgiWtrwckYYxWRS1/luJ9z76LD6Ycj9HZfHXdg4grW9ivWuYqOreXSoWmwew5PeDZ6eiD3WbPbh7Zch+4cDOnEaczHxcF2X4WAoHSRo+VmOR5oXmFWUJUrrW2jk3eaLUjL5izTP5A7TBMeeYFsWY2uEazuUiwWqqVF1TV2VWBc2nggq1aAF6IZK4o7rS0y1okvCnE4Ux5yPXSzB8MLh99kIx5+RlQ1JXoqtCZKc4SRoX8PfCQtKpSVGGzdvMs6EME8jArnQIIxwp4GoyvH9gHlWtKqmAanD9NHopS+v5H9IvCqFcCaTtB0X15lgDcf0eifYcsSpkEYzmV4YEoUBtRzfLCO+KCtuL93+q0oIi2RKGk1JZh6xjN2fjGTvLffyTJJAhCY+yTxFLxJiya0KGVydCcENtJA1RcwfsM4YYDb7ZF8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png\"\n        srcset=\"/static/227bf69ec11cab06a93a8f4e8ef62558/6f3f2/113.png 256w,\n/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>But there is <a href=\"http://pipes.yahoo.com/pipes/docs?doc=operators#WebService\">web service</a> module that allow bypass this restriction.</p>\n<p>All we need is to write web service that will fetch pages and attache them to feed.</p>\n<p>Here is sample:</p>\n<p><strong>app.yaml</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span> yahoo<span class=\"token punctuation\">-</span>pipes<span class=\"token punctuation\">-</span>fetch<span class=\"token punctuation\">-</span>page\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n<span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> python\n<span class=\"token key atrule\">api_version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\n<span class=\"token key atrule\">handlers</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> /\n    <span class=\"token key atrule\">static_files</span><span class=\"token punctuation\">:</span> index.html\n    <span class=\"token key atrule\">upload</span><span class=\"token punctuation\">:</span> index.html\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> .*\n    <span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> main.py</code></pre></div>\n<p><strong>main.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token comment\">#!/usr/bin/env python</span>\n\n<span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>appengine<span class=\"token punctuation\">.</span>ext <span class=\"token keyword\">import</span> webapp\n<span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>appengine<span class=\"token punctuation\">.</span>ext<span class=\"token punctuation\">.</span>webapp <span class=\"token keyword\">import</span> util\n\n<span class=\"token keyword\">import</span> urllib2\n<span class=\"token keyword\">import</span> re\n<span class=\"token keyword\">import</span> simplejson\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MainHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">'get: Hello world!'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AppendHtmlHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span>\n        obj <span class=\"token operator\">=</span> simplejson<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n        items <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">[</span><span class=\"token string\">\"items\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">:</span>\n            req <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            html <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            item<span class=\"token punctuation\">[</span><span class=\"token string\">'html'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> html<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>content_type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/json\"</span>\n        simplejson<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AppendBodyHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span>\n        obj <span class=\"token operator\">=</span> simplejson<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n        items <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">[</span><span class=\"token string\">\"items\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">:</span>\n            req <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            html <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;body[^>]*>(.*?)&lt;/body>'</span><span class=\"token punctuation\">,</span> html<span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;script.*?&lt;/script>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;noscript.*?&lt;/noscript>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;style.*?&lt;/style>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            item<span class=\"token punctuation\">[</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> body\n\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>content_type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/json\"</span>\n        simplejson<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    application <span class=\"token operator\">=</span> webapp<span class=\"token punctuation\">.</span>WSGIApplication<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> MainHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                            <span class=\"token punctuation\">(</span><span class=\"token string\">'/appendhtml'</span><span class=\"token punctuation\">,</span> AppendHtmlHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                            <span class=\"token punctuation\">(</span><span class=\"token string\">'/appendbody'</span><span class=\"token punctuation\">,</span> AppendBodyHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                            debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    util<span class=\"token punctuation\">.</span>run_wsgi_app<span class=\"token punctuation\">(</span>application<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now you can make pipes like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 501px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABoElEQVR42k2RS2/TUBCF86NZ8IpgwQaJLQtascgvgBWIRFAEuyoIqTzEoy1Jr5/XsWNfO37bH2NblFr6NNdnZo6uj2dF0zFQNi1ZA4uziMcfFE/XmqPfLccXcHTejxxf9DyT9+e/Gl6vzzn9dEnVQy67o0/bMbtpmIrhT1vz5fs3Lt0QFSZsgwQnMlih4SqIsaKUXdFgmh6d92I27V8bDsIkTobhPib+c4Zle7iej+d6/FABV16A73noYEdelMjFyOrJ8NpjMCz7nlKapUwUQiok3f869NYGVCWfJudE9Fj0qAXTTTsD5UjP7GACzG5LslPke4sqUROxopCK8NXT+JFLZ4aezBiL2tjUw1nIE4dkLzc3MbP4dIF6cYvNy/vs38yp3j8gfzsnfzcnk9qc3MNaPUIvH5Kv7pCu7k4sJw7L26Qfn+CcLMjWr8QwcLHHvPSY22arULaLr0McNyDwHA6bz6JNM47rj9jOv+pJppKHPG2ZMcsiH+0oAtci9B20tSWO9NClbwqaMuVQtTSt/LFOEm1lubtJTS+z1DltkfAXOXBTaZL+hGMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png\"\n        srcset=\"/static/33e641ff1be7187ea5633a435dc0b312/6f3f2/25.png 256w,\n/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png 501w\"\n        sizes=\"(max-width: 501px) 100vw, 501px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>BUT. Here is epic fail:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Web service failure:\nAn Error Occurred\n408 User-agent timeout (select)</code></pre></div>\n<p>So ...</p>"}},"pageContext":{"id":"20a1d5eb-cd1d-520d-a3fc-b5935c937209"}},"staticQueryHashes":[],"slicesMap":{}}