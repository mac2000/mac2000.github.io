{"componentChunkName":"component---src-templates-note-js","path":"/google-app-engine-and-yahoo-pipes-fetch-page-web-service","result":{"data":{"remark":{"fields":{"path":"google-app-engine-and-yahoo-pipes-fetch-page-web-service"},"meta":{"title":""},"headings":[{"value":"Google app engine and Yahoo Pipes — fetch page web service"}],"html":"<h1>Google app engine and Yahoo Pipes — fetch page web service</h1>\n<p>Yahoo Pipes build in <a href=\"http://pipes.yahoo.com/pipes/docs?doc=sources#FetchPage\">fetch page</a> module have restriction - it can fetch pages only under 200 kb.</p>\n<p>Pipe looks like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 471px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.09375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACnUlEQVQ4y22TS4/cRBRG/aPZgMhEGgUlAZEFq+xYsGDBD4gQAqU7k0QhRIwGdaa7Z/pht+12t99uP+vhg8pOYIIo6eirunXvZ1XdslVLTSU1UmvWheZ84vNg4vLw9ZFv3+uR2ciTO/Mf/vR59usVXlwj+n7wMF7WR8NWaeJW82a+5t18xToscPJ2wDsJdkWHnbeDepUiaSRR0ZI0aqit7xoaGqXIBRydG6L5W9YbF8d2cDZblpsdG3uHs7Vxtg55nmNGqyHvTO0nhpJKSBopKYUk7xSFQegh2SS9jSTrk6KRmqxTQ07eSrJ2rDEetVQDVg00QNlD1YNZf6QCOmBWgStA8P85JtaYeA9W/vop8bMv6F+eo6b3kZOzAfH8HmJyBhdn3E6+I54+hukYk3dQky+pXjzC+e178ulPWPHmkpvLC3azlxxXf1Af5jQDC5rgmmDxO+7Vc3Z/TYc9Ed3ShTd00YiIlrTRmiI+0B62WK/cis9+8fn8Z5t7L2IevodHM3hwNepXV3B+2Q88voav5//yjVETW8KPF1tm8x1WnGWsdnts12dxuyZIC0qpuLZ9olM93M1JKFpzx1JTfnhmpTCNEVSmw6qnNQ0rCqzilBP4e3zHwbVtwiBASzHQK4HqWpydRxIeQckRrRBti78PoNdAPzyjsq6wkixnZftsHZ/NzmN5uyUIU2qhKOqOupMc0hMb70iremqhaQzmZ5D9EDM0CvKywipPGWFSEMUZQZjgH8JBy6bDfFv2I0KPKEbtVP8pGtqmxIrjI54fsPcDtluHxWKJ63pEUUyeFaRpRpGlaKWHYyVZgfgw/+/QosYq0wN5fCALfdKDz95ZUcQB6dEnCVySwMHxfKqyoG8LknCPqHMQFX1X/oNZqzrlb55nFX0oJ/zEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"screenshot\"\n        src=\"/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png\"\n        srcset=\"/static/227bf69ec11cab06a93a8f4e8ef62558/6f3f2/113.png 256w,\n/static/227bf69ec11cab06a93a8f4e8ef62558/1f09d/113.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>But there is <a href=\"http://pipes.yahoo.com/pipes/docs?doc=operators#WebService\">web service</a> module that allow bypass this restriction.</p>\n<p>All we need is to write web service that will fetch pages and attache them to feed.</p>\n<p>Here is sample:</p>\n<p><strong>app.yaml</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span> yahoo<span class=\"token punctuation\">-</span>pipes<span class=\"token punctuation\">-</span>fetch<span class=\"token punctuation\">-</span>page\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n<span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> python\n<span class=\"token key atrule\">api_version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\n<span class=\"token key atrule\">handlers</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> /\n    <span class=\"token key atrule\">static_files</span><span class=\"token punctuation\">:</span> index.html\n    <span class=\"token key atrule\">upload</span><span class=\"token punctuation\">:</span> index.html\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> .*\n    <span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> main.py</code></pre></div>\n<p><strong>main.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token comment\">#!/usr/bin/env python</span>\n\n<span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>appengine<span class=\"token punctuation\">.</span>ext <span class=\"token keyword\">import</span> webapp\n<span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>appengine<span class=\"token punctuation\">.</span>ext<span class=\"token punctuation\">.</span>webapp <span class=\"token keyword\">import</span> util\n\n<span class=\"token keyword\">import</span> urllib2\n<span class=\"token keyword\">import</span> re\n<span class=\"token keyword\">import</span> simplejson\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MainHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">'get: Hello world!'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AppendHtmlHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span>\n        obj <span class=\"token operator\">=</span> simplejson<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n        items <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">[</span><span class=\"token string\">\"items\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">:</span>\n            req <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            html <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            item<span class=\"token punctuation\">[</span><span class=\"token string\">'html'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> html<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>content_type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/json\"</span>\n        simplejson<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AppendBodyHandler</span><span class=\"token punctuation\">(</span>webapp<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span>\n        obj <span class=\"token operator\">=</span> simplejson<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n        items <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">[</span><span class=\"token string\">\"items\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">:</span>\n            req <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            html <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;body[^>]*>(.*?)&lt;/body>'</span><span class=\"token punctuation\">,</span> html<span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> body<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;script.*?&lt;/script>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;noscript.*?&lt;/noscript>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            body <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;style.*?&lt;/style>'</span><span class=\"token punctuation\">,</span> re<span class=\"token punctuation\">.</span>DOTALL<span class=\"token operator\">|</span>re<span class=\"token punctuation\">.</span>MULTILINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span>\n            item<span class=\"token punctuation\">[</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> body\n\n        self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>content_type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/json\"</span>\n        simplejson<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    application <span class=\"token operator\">=</span> webapp<span class=\"token punctuation\">.</span>WSGIApplication<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> MainHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                            <span class=\"token punctuation\">(</span><span class=\"token string\">'/appendhtml'</span><span class=\"token punctuation\">,</span> AppendHtmlHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                            <span class=\"token punctuation\">(</span><span class=\"token string\">'/appendbody'</span><span class=\"token punctuation\">,</span> AppendBodyHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                            debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    util<span class=\"token punctuation\">.</span>run_wsgi_app<span class=\"token punctuation\">(</span>application<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now you can make pipes like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 501px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABlElEQVQoz3WQTW/TQBCG/fO5tQWJaw9IHJDggkTdpu0BoUbKR1ulpkggEogTO05ir+vYu/bu2g9yXCgSYqRH2nln9M7MOtLUtJTWkmp460Uc96e8/5biBjWnYcNZ2HAaNPvcDeE8MAy+R3jTLWXd8NtD2RrnT2IsmYFkHZJ+uSLyfeLAZ7OYE68C4tWS7WLOw3oFWtGGbKAw9snQ7A0thTZIbci1JZEVIsvY5CXrnSLJFR+XklmqiHPVacogSotQBmlaLMXjUo5qoKSjnbgHaPWiAQt4BWws6Fb/u6/tqUHVUDVdzUlu3rA4e8a8d0DeP6IePccMO/ToBYyOuO+/QgxeUg8P0cOneks9PCAbHzP/9I788xWOmA5ZTi5YTC4J7y6JvHPCSY/V3QWL2x7Cc0kHr5mNXJY3Lv71I+MT/OsT/PEHcv+WavWVaj3DSeIYP0wIIkGwTvnhR2xSiW6/ogapDKUq9yfp/9DQhbUVjipS1G6L2sV7ZNa9qyKhzBOMTPgpSrI8wyqBluk/VIWgymNKteMXE5RVk14CSVQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"screenshot\"\n        src=\"/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png\"\n        srcset=\"/static/33e641ff1be7187ea5633a435dc0b312/6f3f2/25.png 256w,\n/static/33e641ff1be7187ea5633a435dc0b312/55811/25.png 501w\"\n        sizes=\"(max-width: 501px) 100vw, 501px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>BUT. Here is epic fail:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Web service failure:\nAn Error Occurred\n408 User-agent timeout (select)</code></pre></div>\n<p>So ...</p>"}},"pageContext":{"id":"20a1d5eb-cd1d-520d-a3fc-b5935c937209"}},"staticQueryHashes":[]}