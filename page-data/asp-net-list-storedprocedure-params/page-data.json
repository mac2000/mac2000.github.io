{"componentChunkName":"component---src-templates-note-js","path":"/asp-net-list-storedprocedure-params/","result":{"data":{"remark":{"fields":{"path":"asp-net-list-storedprocedure-params"},"meta":{"title":""},"headings":[{"value":"Asp.Net list storedprocedure params"}],"html":"<h1>Asp.Net list storedprocedure params</h1>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span>\n<span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlConnection</span><span class=\"token punctuation\">(</span>Common<span class=\"token punctuation\">.</span>ConnectionString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"spResumeBaseUse_GetList\"</span><span class=\"token punctuation\">,</span>con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncmd<span class=\"token punctuation\">.</span>CommandType <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>CommandType<span class=\"token punctuation\">.</span>StoredProcedure<span class=\"token punctuation\">;</span>\n\ncon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nSystem<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlCommandBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">DeriveParameters</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nResponse<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;table border=\\\"1\\\">\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">.</span>SqlParameter</span> param <span class=\"token keyword\">in</span> cmd<span class=\"token punctuation\">.</span>Parameters<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> name <span class=\"token operator\">=</span> param<span class=\"token punctuation\">.</span>ParameterName<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">==</span> <span class=\"token string\">\"RETURN_VALUE\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n    Response<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;tr>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Response<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;td>{0}&lt;/td>\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Response<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;td>{0}&lt;/td>\"</span><span class=\"token punctuation\">,</span> param<span class=\"token punctuation\">.</span>SqlDbType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Response<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;/tr>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nResponse<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;/table>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>"}},"pageContext":{"id":"93ec78b0-ec72-5a1f-b443-db8a654382fc"}},"staticQueryHashes":[],"slicesMap":{}}