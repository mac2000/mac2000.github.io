{"componentChunkName":"component---src-templates-note-js","path":"/rollback-windows-updates","result":{"data":{"remark":{"fields":{"path":"rollback-windows-updates"},"meta":{"title":""},"headings":[{"value":"Rollback Windows Updates"}],"html":"<h1>Rollback Windows Updates</h1>\n<p>List installed updates:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">wmic qfe list brief /format:htable <span class=\"token operator\">></span> <span class=\"token string\">\"%USERPROFILE%\\Desktop\\hotfix.html\"</span>\nwmic qfe list brief /format:texttablewsys <span class=\"token operator\">></span> <span class=\"token string\">\"%USERPROFILE%\\Desktop\\hotfix.txt\"</span></code></pre></div>\n<p>List installed updates (powershell):</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-HotFix</span></code></pre></div>\n<p>Uninstall update:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">wusa.exe /uninstall /KB:2785220\nwusa.exe /uninstall /KB:2785220 /quiet /norestart</code></pre></div>\n<p>Bach mode uninstall:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">wusa.exe /uninstall /KB:2773072 /quiet /norestart <span class=\"token operator\">&amp;</span> <span class=\"token function\">ping</span> <span class=\"token number\">1.1</span>.1.1 <span class=\"token parameter variable\">-n</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-w</span> <span class=\"token number\">5000</span> <span class=\"token operator\">></span> nul\nwusa.exe /uninstall /KB:2778344 /quiet /norestart <span class=\"token operator\">&amp;</span> <span class=\"token function\">ping</span> <span class=\"token number\">1.1</span>.1.1 <span class=\"token parameter variable\">-n</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-w</span> <span class=\"token number\">5000</span> <span class=\"token operator\">></span> nul\nwusa.exe /uninstall /KB:2785220 /quiet /norestart <span class=\"token operator\">&amp;</span> <span class=\"token function\">ping</span> <span class=\"token number\">1.1</span>.1.1 <span class=\"token parameter variable\">-n</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-w</span> <span class=\"token number\">5000</span> <span class=\"token operator\">></span> nul\nwusa.exe /uninstall /KB:2786081 /quiet /norestart <span class=\"token operator\">&amp;</span> <span class=\"token function\">ping</span> <span class=\"token number\">1.1</span>.1.1 <span class=\"token parameter variable\">-n</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-w</span> <span class=\"token number\">5000</span> <span class=\"token operator\">></span> nul</code></pre></div>\n<p>Bach mode uninstall (powershell):</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$Updates</span> = <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">New-Object</span> <span class=\"token operator\">-</span>ComObject Microsoft<span class=\"token punctuation\">.</span>Update<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>CreateUpdateSearcher<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Search<span class=\"token punctuation\">(</span><span class=\"token string\">\"IsInstalled = 1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Updates <span class=\"token comment\"># Retrieve installed updates</span>\n<span class=\"token function\">Write-Host</span> <span class=\"token variable\">$Updates</span><span class=\"token punctuation\">.</span>Count <span class=\"token string\">\"updates total\"</span> <span class=\"token operator\">-</span>ForegroundColor Yellow\n\n<span class=\"token variable\">$Updates</span> = <span class=\"token variable\">$Updates</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Where-Object</span> <span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>LastDeploymentChangeTime <span class=\"token operator\">-gt</span> <span class=\"token punctuation\">(</span><span class=\"token function\">Get-Date</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"01/01/\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">Get-Date</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># Get updates installed in this year</span>\n<span class=\"token comment\">#$Updates = $Updates | Where-Object {$_.LastDeploymentChangeTime -gt ((Get-Date).AddMonths(-1))} # Get updates installed in month</span>\n<span class=\"token variable\">$Updates</span> = <span class=\"token variable\">$Updates</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Sort-Object</span> LastDeploymentChangeTime <span class=\"token operator\">-</span>Descending <span class=\"token comment\"># Sort updates</span>\n\n<span class=\"token function\">Write-Host</span> <span class=\"token variable\">$Updates</span><span class=\"token punctuation\">.</span>Count <span class=\"token string\">\"updates installed in selected time period\"</span> <span class=\"token operator\">-</span>ForegroundColor Yellow\n<span class=\"token function\">Write-Host</span>\n\n<span class=\"token comment\">#$Updates = $Updates | Select -First 2</span>\n\n<span class=\"token keyword\">Foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$Update</span> in <span class=\"token variable\">$Updates</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$ID</span> = <span class=\"token variable\">$Update</span><span class=\"token punctuation\">.</span>KBArticleIDs\n\n\t<span class=\"token function\">Write-Host</span> <span class=\"token string\">\"Removing KB:<span class=\"token variable\">$ID</span>\"</span> <span class=\"token operator\">-</span>ForegroundColor Red\n\t<span class=\"token function\">Write-Host</span> <span class=\"token variable\">$Update</span><span class=\"token punctuation\">.</span>Title\n\t<span class=\"token function\">Write-Host</span>\n\t<span class=\"token function\">Invoke-Expression</span> <span class=\"token string\">\"wusa.exe /uninstall /kb:<span class=\"token variable\">$ID</span> /quiet /log /norestart\"</span>\n\n\t<span class=\"token comment\"># Wait wusa to complete uninstall</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">(</span><span class=\"token function\">Get-Process</span> wusa <span class=\"token operator\">-</span>ErrorAction SilentlyContinue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Count <span class=\"token operator\">-ne</span> 0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">Start-Sleep</span> 1 <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>"}},"pageContext":{"id":"880cce9d-ed56-5983-9264-0ef8710a31aa"}},"staticQueryHashes":[]}