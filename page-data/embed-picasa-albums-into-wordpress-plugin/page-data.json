{"componentChunkName":"component---src-templates-note-js","path":"/embed-picasa-albums-into-wordpress-plugin/","result":{"data":{"remark":{"fields":{"path":"embed-picasa-albums-into-wordpress-plugin"},"meta":{"title":""},"headings":[{"value":"Embed picasa albums into wordpress plugin"}],"html":"<h1>Embed picasa albums into wordpress plugin</h1>\n<p>Plugin allows insert picasa albums into posts and pages via new tinymce button in few clicks.</p>\n<p>Used build in jquery ui and zend gdata library.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 530px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/685436e69462be305842d4a619bae8dd/b6a9b/screenshot-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.015625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACHUlEQVR42oVU25KaQBT0//8gVZvNpVKV/9hbZZ91S9FSVEBgQIY7eEun+qywqHF9OBwdZto+3T321us1Bv0+PM+F7ThQKkAYBrBtB6vVCmVZYr/fY7vdYrfbndRms0Fd19Kb6kVRhNFwCM/zYJpzzOdzLBcL6WNjjCAIoLVGHMfgXh1p6fxeHcG6oD2+cBxHAF3Xhef57we1lgrDEL7vt10pJT0IQlRVdQnIw9PpFJZlYTKZwDTNk7E47n6/uxj36shZlgk7x1nBdT1hyyJb6kjG3QPnRW0bYFaPjzRNkedFu3heNCZLM+R5jqIopJMIO4t7GmABpMNpmslid4RmY5Ik8FxXWJO9bdlinLW04dgOirJsJejxwehQbLI8HA4nI/AzJ6ARZENNG227erYMuYl5Y5EBY8K1Lts0TUTnZorPNJXYzGYzLJdLLBYLGIYhbLssCdKE+5rOrSnisut+ZMzzhK1l2R+6nrn5KUNuoOhax4jjRMbtxoFVlgUircXtW6ACyFvAvClfyS2p61NTiiKHZdsX2l4FpBHqODKZnrtMWd7f6RMd/wvI+xgyNkEIXykkWY6yqlFWVXuIo/JHGZ+bgIftBrs8RpVq5FEA4ADgr/TtcVNxjBZvyU0NTaXx5XGIH38MfH0xcP88wt3TEL9ex0jyUkDp8rU/gwvAudK4e+jj5/Mb7h8G+P70hm+PA/x+HSEtjoCdnN1i+A+pLmKup++bowAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/685436e69462be305842d4a619bae8dd/b6a9b/screenshot-1.png\"\n        srcset=\"/static/685436e69462be305842d4a619bae8dd/6f3f2/screenshot-1.png 256w,\n/static/685436e69462be305842d4a619bae8dd/01e7c/screenshot-1.png 512w,\n/static/685436e69462be305842d4a619bae8dd/b6a9b/screenshot-1.png 530w\"\n        sizes=\"(max-width: 530px) 100vw, 530px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span> <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 771px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d46c58a1851fb86b987dba82dbb43508/5d030/screenshot-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.0625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABf0lEQVR42q2TPY7CMBCFc0rybyfh9wxcAFpEAR1ISNyCAgoqCkraDQVCCAUokJBAb/UGzJJoWVGspS/2TOzn8XhsBUEAz/PgeT58P0AYhvB9H0opxHGCKIqgtYbWEZTWUGEgPkFrOI4D27ZFg2stDlzXFQcFXdeD49golUoygWJhqBAYPFd8PxvlsRLupBTYJ8k9ojiOBU4w42dUL2POr9VqOSx+6vV6zkm7Uqmg2Wyi0+mg2+2i3++j1+s9od1qtWSeWVetVmHxU4SCzCEXpWmKdL3GbrfDdrvFZrMR9vs9ptNpLsqnoDHkx0OQ+RsOhzgej0i/UhyyA87nM9hut5v0y+VS0vG34OPIFBwMBrhcLsiyDKfTSaBNrtcrFovFZ4KNRkMER6MRfmsUI6vV6vMIeYvtdhvz+VxyZZjNZphMJsJ4PEa5XH4v+Ap9TDgLvwij56WxrF6DEcFiHRXLh8d/R7HcRJA5YNisp//Aur9jT45intQ7zDs3FFPBNHwDlnVzcZsVclkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/d46c58a1851fb86b987dba82dbb43508/5d030/screenshot-2.png\"\n        srcset=\"/static/d46c58a1851fb86b987dba82dbb43508/6f3f2/screenshot-2.png 256w,\n/static/d46c58a1851fb86b987dba82dbb43508/01e7c/screenshot-2.png 512w,\n/static/d46c58a1851fb86b987dba82dbb43508/5d030/screenshot-2.png 771w\"\n        sizes=\"(max-width: 771px) 100vw, 771px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span> <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/490ef0dddc15c510ad5a64714046b3bf/a805e/screenshot-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.515625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADOElEQVR42oWU60+bVRjA34RPRBLDR/xGyUxYCMVEM5cC7gImM8ZFssU/QLP4QScJQR3urxDMGCb6YQaCyIK0YQhMkzHbQulNu5V1FGzXvnTt2rdvL7Rvbz/zHiz0g2RPcnKec3l+57mccyRZlrFarTgcDjY3N7HZbLhcLgqFArpUq1VKpZLo9Var1cS83pfLZeqir+kipRQFt8fNI5+P7W0/gUCA3d1disXikXEdUKlUyOVyJJNJFEUhnU4LXe/re6VFswWDwcDbZ96k33SWPtMZLl9+X2zSjXw+n/A4Ho8Lg7GxMSRJoqWlhebmZpqamjCZTEeHSotmM11dnQye7+fiO71cGrzA1atDZDIZ4e3k5CQTExNYLBZhNDIyIoCtra20t7cLvbu7uxG4yKlTHZzr7+XSwHl6z77FR1c+REmlUFWV2dlZxsfHsdvtwmh0dFRA2traBEjXjUbjMXDulzk6OgwMDgzwRvdpOl83cOFcr4Dp+VlYWGB+fp5gMCiMhoeHBaSx9fX1HQP1ql6//jnf3PiKr78cYfiLz7h584bIoS566BlVPaqinlOz2czKygqrq6ssLS1h39igWq0dAjlB6tfkoFAklz8QFa40XJOTRNLvkqaVKJXKqGoWOZbgn7BMUdMoFDUc7se4/npCOBKjXK6QSCTZcPqxOR4TfhYlFotj2/Kz5QmwH4sfAnO5A7K5vDB+aPf+51GZ/ecvuGv5g0RSwby8TnDvGU93wgSCMuY1L3OL6+zshtjekZm/58KyYkfSQ0kpKko6w58bXtZtHgGCmgjX6d3myU4Ih9sv5pPJhABMzTzk51/XyWcV3I/C3PrpAcu/Ow6BSlolk82xF4ri+TvAi1Ra5EwPcS8k88DqZmnNSiabJxKJcGf6Lt9+9yM22yahUIjvf5jm1tQd3G7v/xel/szqhUmrWZweP/l8QbzffC5LLpsR713TtKOxViwiRaMRflu+x/37a1gsZpzOreMqVw4/g8YP4aVVnpmZpqfnNB8MvYexp5Nr1z4WC+VKmRo1tFJJeFX/aV7WpKnbt3n1lSY+/eRdjF2vcWVoiCpV0pk0kWgEeV8WujigwdOTgP8ClxIuSgH0qlQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/490ef0dddc15c510ad5a64714046b3bf/a805e/screenshot-3.png\"\n        srcset=\"/static/490ef0dddc15c510ad5a64714046b3bf/6f3f2/screenshot-3.png 256w,\n/static/490ef0dddc15c510ad5a64714046b3bf/01e7c/screenshot-3.png 512w,\n/static/490ef0dddc15c510ad5a64714046b3bf/a805e/screenshot-3.png 572w\"\n        sizes=\"(max-width: 572px) 100vw, 572px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>plugin code:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">/*\nPlugin Name: Embed picasa album\nPlugin URI: http://wordpress.org/\nDescription: Embed picasa album into post or page.\nAuthor: Marchenko Alexandr\nVersion: 1.1\nAuthor URI: http://mac-blog.org.ua/\n*/</span>\n\n<span class=\"token comment\">//http://www.presscoders.com/wordpress-settings-api-explained/</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n<span class=\"token comment\">//add plugin options page</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'admin_menu'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_admin_menu'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_admin_menu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">add_options_page</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Picasa settings'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Picasa'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'manage_options'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_settings_page'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_settings_page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token delimiter important\">?></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon32<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon-options-general<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span>Picasa settings<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n        Enter auth params and select preferred image dimensions\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>options.php<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">settings_fields</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n        <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">do_settings_sections</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-primary<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">esc_attr_e</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Save Changes'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n<span class=\"token comment\">//register plugin options</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'admin_init'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_admin_init'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_admin_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">register_setting</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_validate'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// group, name in db, validation func</span>\n\n    <span class=\"token function\">add_settings_section</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'auth_section'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Auth Settings'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_section_auth'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">add_settings_field</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Login'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_login_field_renderer'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'auth_section'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">add_settings_field</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Password'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_password_field_renderer'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'auth_section'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">add_settings_section</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'img_section'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Image Settings'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_section_img'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">add_settings_field</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Thumbnail size'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size_field_renderer'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'img_section'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">add_settings_field</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Full image size'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_full_size_field_renderer'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'img_section'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">add_settings_field</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options_crop'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Crop images'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_crop_field_renderer'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'img_section'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_section_auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;p>Your login and password in picasa&lt;/p>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_section_img</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;p>Preferred image dimensions&lt;/p>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_login_field_renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;input id='embpicasa_options_login' name='embpicasa_options[embpicasa_options_login]' size='40' type='text' value='<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>' />\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_password_field_renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;input id='embpicasa_options_password' name='embpicasa_options[embpicasa_options_password]' size='40' type='password' value='<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>' />\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_thumb_size_field_renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'32'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'48'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'64'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'72'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'104'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'144'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'150'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'160'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;select id='embpicasa_options_thumb_size' name='embpicasa_options[embpicasa_options_thumb_size]'>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$items</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$selected</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string single-quoted-string\">'selected=\"selected\"'</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;option value='<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>' <span class=\"token interpolation\"><span class=\"token variable\">$selected</span></span>><span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>&lt;/option>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/select>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_full_size_field_renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'94'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'110'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'128'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'200'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'220'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'288'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'320'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'400'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'512'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'576'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'640'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'720'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'800'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'912'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'1024'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'1152'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'1280'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'1440'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'1600'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;select id='embpicasa_options_full_size' name='embpicasa_options[embpicasa_options_full_size]'>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$items</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$selected</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string single-quoted-string\">'selected=\"selected\"'</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;option value='<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>' <span class=\"token interpolation\"><span class=\"token variable\">$selected</span></span>><span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>&lt;/option>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/select>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_crop_field_renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'no'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'yes'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;select id='embpicasa_options_crop' name='embpicasa_options[embpicasa_options_crop]'>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$items</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$selected</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_crop'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string single-quoted-string\">'selected=\"selected\"'</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;option value='<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>' <span class=\"token interpolation\"><span class=\"token variable\">$selected</span></span>><span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>&lt;/option>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/select>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_validate</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// strip all fields</span>\n    <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span>      <span class=\"token operator\">=</span>  <span class=\"token function\">wp_filter_nohtml_kses</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span>   <span class=\"token operator\">=</span>  <span class=\"token function\">wp_filter_nohtml_kses</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>  <span class=\"token function\">wp_filter_nohtml_kses</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">=</span>  <span class=\"token function\">wp_filter_nohtml_kses</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// check image dimensions</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'32'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'48'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'64'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'72'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'104'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'144'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'150'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'160'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$items</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'150'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'32'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'48'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'64'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'72'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'104'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'144'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'150'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'160'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$items</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$input</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'640'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$input</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Define default option settings</span>\n<span class=\"token function\">register_activation_hook</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_options_add_defaults'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_options_add_defaults</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">update_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string single-quoted-string\">'embpicasa_options_login'</span>      <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'LOGIN@gmail.com'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string single-quoted-string\">'embpicasa_options_password'</span>   <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'150'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span>  <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'640'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string single-quoted-string\">'embpicasa_options_crop'</span>       <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'no'</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n<span class=\"token comment\">// add the shortcode handler for picasa galleries</span>\n<span class=\"token comment\">// http://brettterpstra.com/adding-a-tinymce-button/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">add_embpicasa_shortcode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$atts</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token function\">shortcode_atts</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token string double-quoted-string\">\"id\"</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">set_include_path</span><span class=\"token punctuation\">(</span><span class=\"token function\">implode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PATH_SEPARATOR</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                    <span class=\"token function\">realpath</span><span class=\"token punctuation\">(</span><span class=\"token function\">dirname</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/library'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token function\">get_include_path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">require_once</span> <span class=\"token string single-quoted-string\">'Zend/Loader.php'</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Query'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_ClientLogin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_UserQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_AlbumQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_PhotoQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Zend_Gdata_ClientLogin</span><span class=\"token operator\">::</span><span class=\"token function\">getHttpClient</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token class-name static-context\">Zend_Gdata_Photos</span><span class=\"token operator\">::</span><span class=\"token constant\">AUTH_SERVICE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$service</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Zend_Gdata_Photos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$client</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token variable\">$photos</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Zend_Gdata_Photos_AlbumQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$query</span><span class=\"token operator\">-></span><span class=\"token function\">setAlbumId</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">// http://code.google.com/intl/ru/apis/picasaweb/docs/1.0/reference.html</span>\n                <span class=\"token variable\">$suffix</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_crop'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'no'</span> <span class=\"token operator\">?</span> <span class=\"token string single-quoted-string\">'u'</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$query</span><span class=\"token operator\">-></span><span class=\"token function\">setThumbsize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_thumb_size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$suffix</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$query</span><span class=\"token operator\">-></span><span class=\"token function\">setImgMax</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_full_size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$suffix</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$service</span><span class=\"token operator\">-></span><span class=\"token function\">getAlbumFeed</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$entry</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$photo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token variable\">$photos</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                                <span class=\"token string single-quoted-string\">'thumbnail'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$photo</span><span class=\"token operator\">-></span><span class=\"token property\">mediaGroup</span><span class=\"token operator\">-></span><span class=\"token property\">thumbnail</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span><span class=\"token property\">url</span><span class=\"token punctuation\">,</span>\n                                <span class=\"token string single-quoted-string\">'fullsize'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$photo</span><span class=\"token operator\">-></span><span class=\"token property\">mediaGroup</span><span class=\"token operator\">-></span><span class=\"token property\">content</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span><span class=\"token property\">url</span>\n                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$results</span><span class=\"token operator\">-></span><span class=\"token function\">getNextFeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n\n                <span class=\"token comment\">//TODO: here is theming, change it as u need</span>\n\n                <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;ul class=\"embpicasa\">'</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$photos</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$photo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;li>'</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;a rel=\"lightbox['</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">']\" target=\"_blank\" href=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$photo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'fullsize'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;img src=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$photo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'thumbnail'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\" />'</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/a>'</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/li>'</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$opts</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$opts</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;option value=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/option>'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token variable\">$html</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$html</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/ul>'</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token comment\">//$html = $html . '&lt;style type=\"text/css\">';</span>\n                <span class=\"token comment\">//$html = $html . '.embpicasa li {width:' . $options['embpicasa_options_thumb_size'] . 'px;height:' . $options['embpicasa_options_thumb_size'] . 'px;}';</span>\n                <span class=\"token comment\">//$html = $html . '&lt;/style>';</span>\n\n                <span class=\"token keyword\">return</span> <span class=\"token variable\">$html</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> <span class=\"token variable\">$ex</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'&lt;p style=\"color:red\">'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$ex</span><span class=\"token operator\">-></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/p>'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//empty login or password</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">//TODO: here will be all zend gdata stufs to retrive album photos</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'&lt;p style=\"text-align:center\">'</span><span class=\"token operator\">.</span><span class=\"token variable\">$id</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/p>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'add_embpicasa_shortcode'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n<span class=\"token comment\">// embed some javascript for tinymce plugin</span>\n\n<span class=\"token comment\">// add jquery ui styles</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_admin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">current_user_can</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'edit_posts'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">current_user_can</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'edit_pages'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">get_user_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'rich_editing'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'true'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">wp_register_style</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'jquery-style'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/smoothness/jquery-ui.css'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">wp_enqueue_style</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'jquery-style'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_admin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">wp_register_style</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'embpicasa-style'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">plugins_url</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa.css'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">wp_enqueue_style</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'embpicasa-style'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'init'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_init'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'edit_form_advanced'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_embed_js'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'edit_page_form'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_embed_js'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_embed_js</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword\">function</span> <span class=\"token function\">embpicasa_dlg_open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">embpicasa_dlg_close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">jQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#embpicasa_dlg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">dialog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">modal</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">draggable</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">resizable</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">buttons</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string-property property\">'Insert'</span><span class=\"token operator\">:</span> embpicasa_dlg_insert<span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">jQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#embpicasa_dlg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">dialog</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"open\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">embpicasa_dlg_insert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> album_id <span class=\"token operator\">=</span> <span class=\"token function\">jQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#embpicasa_dlg_content_album\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">var</span> shortcode <span class=\"token operator\">=</span> <span class=\"token string\">'[embpicasa id=\"'</span><span class=\"token operator\">+</span>album_id<span class=\"token operator\">+</span><span class=\"token string\">'\"]'</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">typeof</span> tinyMCE <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span> ed <span class=\"token operator\">=</span> tinyMCE<span class=\"token punctuation\">.</span>activeEditor <span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>ed<span class=\"token punctuation\">.</span><span class=\"token function\">isHidden</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            ed<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tinymce<span class=\"token punctuation\">.</span>isIE<span class=\"token punctuation\">)</span>\n                ed<span class=\"token punctuation\">.</span>selection<span class=\"token punctuation\">.</span><span class=\"token function\">moveToBookmark</span><span class=\"token punctuation\">(</span>tinymce<span class=\"token punctuation\">.</span>EditorManager<span class=\"token punctuation\">.</span>activeEditor<span class=\"token punctuation\">.</span>windowManager<span class=\"token punctuation\">.</span>bookmark<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            ed<span class=\"token punctuation\">.</span><span class=\"token function\">execCommand</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mceInsertContent'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> shortcode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span>\n            <span class=\"token function\">edInsertContent</span><span class=\"token punctuation\">(</span>edCanvas<span class=\"token punctuation\">,</span> shortcode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">embpicasa_dlg_close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">embpicasa_dlg_close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">jQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#embpicasa_dlg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">dialog</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"close\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_js_dlg_markup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'embpicasa_options'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$success</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$msg</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$opts</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">set_include_path</span><span class=\"token punctuation\">(</span><span class=\"token function\">implode</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PATH_SEPARATOR</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n            <span class=\"token function\">realpath</span><span class=\"token punctuation\">(</span><span class=\"token function\">dirname</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/library'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function\">get_include_path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">require_once</span> <span class=\"token string single-quoted-string\">'Zend/Loader.php'</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Query'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_ClientLogin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_UserQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_AlbumQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name static-context\">Zend_Loader</span><span class=\"token operator\">::</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Zend_Gdata_Photos_PhotoQuery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Zend_Gdata_ClientLogin</span><span class=\"token operator\">::</span><span class=\"token function\">getHttpClient</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa_options_password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token class-name static-context\">Zend_Gdata_Photos</span><span class=\"token operator\">::</span><span class=\"token constant\">AUTH_SERVICE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$service</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Zend_Gdata_Photos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$client</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$albums</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$service</span><span class=\"token operator\">-></span><span class=\"token function\">getUserFeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$entry</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token variable\">$album_id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$entry</span><span class=\"token operator\">-></span><span class=\"token property\">gphotoId</span><span class=\"token operator\">-></span><span class=\"token property\">text</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$album_name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$entry</span><span class=\"token operator\">-></span><span class=\"token property\">title</span><span class=\"token operator\">-></span><span class=\"token property\">text</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token variable\">$albums</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                    <span class=\"token string single-quoted-string\">'id'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$album_id</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string single-quoted-string\">'name'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$album_name</span>\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$results</span><span class=\"token operator\">-></span><span class=\"token function\">getNextFeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$albums</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$opts</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$opts</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;option value=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$album</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/option>'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> <span class=\"token variable\">$ex</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$success</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$msg</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ex</span><span class=\"token operator\">-></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>embpicasa_dlg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Picasa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>embpicasa_dlg_content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$success</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token delimiter important\">?></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">></span></span>\n                        Select album:\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>embpicasa_dlg_content_album<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span>98%</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$opts</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span><span class=\"token delimiter important\">?></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>1em<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ui-state-error ui-corner-all<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>ERROR<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/></span></span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$msg</span><span class=\"token delimiter important\">?></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">endif</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">.ui-button-text-only .ui-button-text</span> <span class=\"token punctuation\">{</span><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.ui-widget-overlay</span> <span class=\"token punctuation\">{</span><span class=\"token property\">background</span><span class=\"token punctuation\">:</span>#AAAAAA<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'admin_footer'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_js_dlg_markup'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n<span class=\"token comment\">// add embpicasa button into tinymce</span>\n<span class=\"token comment\">// http://brettterpstra.com/adding-a-tinymce-button/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">add_embpicasa_button</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token function\">current_user_can</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'edit_posts'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span> <span class=\"token function\">current_user_can</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'edit_pages'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">get_user_option</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'rich_editing'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'true'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'mce_external_plugins'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'add_embpicasa_tinymce_plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'mce_buttons'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'register_embpicasa_button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'init'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'add_embpicasa_button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">register_embpicasa_button</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$buttons</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">array_push</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$buttons</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"|\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"embpicasa\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$buttons</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">add_embpicasa_tinymce_plugin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$plugin_array</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$plugin_array</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'embpicasa'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">WP_PLUGIN_URL</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token function\">basename</span><span class=\"token punctuation\">(</span> <span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token function\">plugin_basename</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'embpicasa.js'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$plugin_array</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Trick/hack to tinymce refresh all files</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">embpicasa_refresh_mce</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$ver</span> <span class=\"token operator\">+=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$ver</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'tiny_mce_version'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'embpicasa_refresh_mce'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>Here u can see how to make options for plugins and pages to set them, also there is default values for them.</p>\n<p>Then how to make shortcodes. In shortcode u may see how to retrive picasa album photos.</p>\n<p>And last bit of code makes jquery ui dialog and adds tinymce button.</p>\n<p>Here is tinymce plugin code:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">;</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  tinymce<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tinymce.plugins.embpicasa'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">init</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ed<span class=\"token punctuation\">,</span> url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> embpicasa_dlg_open <span class=\"token operator\">==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n\n      ed<span class=\"token punctuation\">.</span><span class=\"token function\">addButton</span><span class=\"token punctuation\">(</span><span class=\"token string\">'embpicasa'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">'Picasa'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">image</span><span class=\"token operator\">:</span> url <span class=\"token operator\">+</span> <span class=\"token string\">'/embpicasa.gif'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">onclick</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">embpicasa_dlg_open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">createControl</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">n<span class=\"token punctuation\">,</span> cm</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">getInfo</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">longname</span><span class=\"token operator\">:</span> <span class=\"token string\">'Embed picasa album'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">author</span><span class=\"token operator\">:</span> <span class=\"token string\">'Marchenko Alexandr'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">authorurl</span><span class=\"token operator\">:</span> <span class=\"token string\">'http://mac-blog.org.ua/'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">infourl</span><span class=\"token operator\">:</span> <span class=\"token string\">'http://mac-blog.org.ua/'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'1.0'</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  tinymce<span class=\"token punctuation\">.</span>PluginManager<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'embpicasa'</span><span class=\"token punctuation\">,</span> tinymce<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span>embpicasa<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"http://code.google.com/p/embpicasa/\">http://code.google.com/p/embpicasa/</a></p>"}},"pageContext":{"id":"59630ffd-faa7-5ef8-82dc-48472649ac52"}},"staticQueryHashes":[],"slicesMap":{}}