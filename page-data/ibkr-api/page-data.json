{"componentChunkName":"component---src-templates-note-js","path":"/ibkr-api/","result":{"data":{"remark":{"fields":{"path":"ibkr-api"},"meta":{"title":""},"headings":[{"value":"Interactive Brokers API"}],"html":"<h1>Interactive Brokers API</h1>\n<p>Short note of how to get up and running IBRK API</p>\n<h2>Prerequisites</h2>\n<p><div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token comment\"># Preparations:</span>\n<span class=\"token comment\"># - java</span>\n<span class=\"token comment\"># - client</span>\n<span class=\"token comment\"># - certs</span>\n\n\n<span class=\"token comment\"># Java (TODO: cross platform)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token operator\">!</span> <span class=\"token punctuation\">[</span> <span class=\"token parameter variable\">-d</span> <span class=\"token function\">java</span> <span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">then</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-s</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token keyword\">in</span>\n        Linux*<span class=\"token punctuation\">)</span>     <span class=\"token assign-left variable\">JRE_OS</span><span class=\"token operator\">=</span>linux<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        Darwin*<span class=\"token punctuation\">)</span>    <span class=\"token assign-left variable\">JRE_OS</span><span class=\"token operator\">=</span>mac<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        CYGWIN*<span class=\"token punctuation\">)</span>    <span class=\"token assign-left variable\">JRE_OS</span><span class=\"token operator\">=</span>windows<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        MINGW*<span class=\"token punctuation\">)</span>     <span class=\"token assign-left variable\">JRE_OS</span><span class=\"token operator\">=</span>windows<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        *<span class=\"token punctuation\">)</span>          <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Unsupported platform\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">esac</span>\n    <span class=\"token comment\"># echo \"JRE_OS: $JRE_OS\"</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token keyword\">in</span>\n        x86_64<span class=\"token punctuation\">)</span>     <span class=\"token assign-left variable\">JRE_ARCH</span><span class=\"token operator\">=</span>x64<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        arm64<span class=\"token punctuation\">)</span>      <span class=\"token assign-left variable\">JRE_ARCH</span><span class=\"token operator\">=</span>aarch64<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n        *<span class=\"token punctuation\">)</span>          <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Unsupported architecture\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">esac</span>\n    <span class=\"token comment\"># echo \"JRE_ARCH: $JRE_ARCH\"</span>\n\n    <span class=\"token comment\"># curl -s https://api.adoptopenjdk.net/v3/info/available_releases | jq -r \".most_recent_lts\"</span>\n    <span class=\"token assign-left variable\">JRE_LTS</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> https://api.adoptopenjdk.net/v3/info/available_releases <span class=\"token operator\">|</span> jq <span class=\"token parameter variable\">-r</span> <span class=\"token string\">\".most_recent_lts\"</span><span class=\"token variable\">)</span></span>\n    <span class=\"token comment\"># echo \"JRE_LTS: $JRE_LTS\"</span>\n\n    <span class=\"token comment\"># curl -s \"https://api.adoptopenjdk.net/v3/assets/latest/$(curl -s https://api.adoptopenjdk.net/v3/info/available_releases | jq -r \".most_recent_lts\")/hotspot\"</span>\n    <span class=\"token assign-left variable\">JRE_LINK</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token string\">\"https://api.adoptopenjdk.net/v3/assets/latest/<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> https://api.adoptopenjdk.net/v3/info/available_releases <span class=\"token operator\">|</span> jq <span class=\"token parameter variable\">-r</span> <span class=\"token string\">\".most_recent_lts\"</span><span class=\"token variable\">)</span></span>/hotspot\"</span> <span class=\"token operator\">|</span> jq <span class=\"token parameter variable\">-r</span> <span class=\"token string\">\".[] | .binary | select(.os == <span class=\"token entity\" title=\"\\&quot;\">\\\"</span><span class=\"token variable\">$JRE_OS</span><span class=\"token entity\" title=\"\\&quot;\">\\\"</span> and .architecture == <span class=\"token entity\" title=\"\\&quot;\">\\\"</span><span class=\"token variable\">$JRE_ARCH</span><span class=\"token entity\" title=\"\\&quot;\">\\\"</span> and .image_type == <span class=\"token entity\" title=\"\\&quot;\">\\\"</span>jre<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>) | .package.link\"</span><span class=\"token variable\">)</span></span>\n    <span class=\"token comment\"># echo \"JRE_LINK: $JRE_LINK\"</span>\n\n    <span class=\"token comment\"># if JRE_OS == \"windows\"</span>\n    <span class=\"token comment\"># if [ \"$JRE_OS\" = \"windows\" ]</span>\n    <span class=\"token comment\"># then</span>\n    <span class=\"token comment\">#     JRE_LINK=$(echo $JRE_LINK | sed 's/https/http/')</span>\n    <span class=\"token comment\"># else</span>\n    <span class=\"token comment\">#     wget $JRE_LINK</span>\n    <span class=\"token comment\">#     tar -xzf OpenJDK*.tar.gz</span>\n    <span class=\"token comment\">#     mv jdk-*-jre java</span>\n    <span class=\"token comment\">#     rm OpenJDK*.tar.gz</span>\n    <span class=\"token comment\"># fi</span>\n\n    <span class=\"token function\">wget</span> <span class=\"token variable\">$JRE_LINK</span>\n    <span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xzf</span> OpenJDK*.tar.gz\n    <span class=\"token function\">mv</span> jdk-*-jre <span class=\"token function\">java</span>\n    <span class=\"token function\">rm</span> OpenJDK*.tar.gz\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Client</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token operator\">!</span> <span class=\"token punctuation\">[</span> <span class=\"token parameter variable\">-d</span> jars <span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">then</span>\n    <span class=\"token function\">wget</span> https://download2.interactivebrokers.com/portal/clientportal.gw.zip\n    <span class=\"token function\">unzip</span> clientportal.gw.zip\n    <span class=\"token function\">rm</span> clientportal.gw.zip\n    <span class=\"token comment\"># mkdir jars</span>\n    <span class=\"token comment\"># cp build/lib/runtime/*.jar jars/</span>\n    <span class=\"token comment\"># cp dist/*.jar jars/</span>\n    <span class=\"token comment\"># rm -rf bin build dist doc root || true</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Certs</span>\n<span class=\"token comment\"># https://get.localhost.direct</span>\n<span class=\"token comment\"># https://github.com/Upinel/localhost.direct</span>\n<span class=\"token comment\"># wget -O certs.zip https://aka.re/localhost</span>\n<span class=\"token comment\"># unzip -P localhost certs.zip</span>\n<span class=\"token comment\"># rm certs.zip</span>\n\n<span class=\"token comment\"># JKS (TODO: what is openssl and especially keytool are not installed?)</span>\n<span class=\"token comment\"># openssl pkcs12 -export -in localhost.direct.crt -inkey localhost.direct.key -out keystore.p12 -name ib -passout pass:HelloWorldFromInteractiveBrokers2023</span>\n<span class=\"token comment\"># keytool -importkeystore -srckeystore keystore.p12 -srcstoretype PKCS12 -destkeystore keystore.jks -deststoretype JKS -storepass HelloWorldFromInteractiveBrokers2023 -srcstorepass HelloWorldFromInteractiveBrokers2023</span>\n<span class=\"token comment\"># rm localhost.direct.crt localhost.direct.key keystore.p12 || true</span>\n\n\n<span class=\"token comment\"># Start</span>\n<span class=\"token comment\"># TODO: JAVA_HOME depends on platform</span>\n<span class=\"token comment\"># export JAVA_HOME=./java/Contents/Home</span>\n<span class=\"token comment\"># java -server -cp \"./:jars/*\" ibgroup.web.core.clientportal.gw.GatewayStart --conf ./conf.yaml </span>\n\n<span class=\"token function\">rm</span> root/webapps/demo/index.html\n<span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> <span class=\"token string\">\"<span class=\"token environment constant\">$PWD</span>/index.html\"</span> <span class=\"token string\">\"<span class=\"token environment constant\">$PWD</span>/root/webapps/demo/index.html\"</span></code></pre></div></p>\n<p>Notes:</p>\n<ul>\n<li>technically all we need from gateway - jar files</li>\n<li>also we may want to swap self generated certificates with something trusted, but some how it did not worked out</li>\n<li>idea behind the script was to have cleaned up version, leaving it here as is for future</li>\n<li>html file is replaced with customized demo</li>\n</ul>\n<h2>Starting gateway</h2>\n<p><div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">JAVA_HOME</span><span class=\"token operator\">=</span>./java/Contents/Home\n\n./bin/run.sh ./root/conf.yaml</code></pre></div></p>\n<p>Notes:</p>\n<ul>\n<li>under the hood we are starting <code class=\"language-text\">java -jar gateway.jar</code></li>\n<li>it will start an server on port 5000 with self signed cert</li>\n<li>any request sent to server will be proxied to ibkr under the hood preserving cookies</li>\n<li>request to home page will serve <code class=\"language-text\">https://api.ibkr.com/sso/Login?forwardTo=22&amp;RL=1&amp;ip2loc=US</code></li>\n<li>safari does not recognize login response and downloads it, but after login <code class=\"language-text\">https://localhost:5000/demo/</code> should work</li>\n</ul>\n<h2>Sample web page</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9db25098d741ff550cd9f8e292d63562/9c1e6/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABO0lEQVR42r2STU7DMBCFU7hXD0IWcAK4D2IVFuUGFaiCrqvuQxMWUZDCj5NxJEdRTWw/NG5Tyo4GwUjPHnn8Po3sCYIgCN5Xq/HL29OZIDoholApFQohwizLvOI49uI8SZIwz/OwbVt/hzae06IoxsE2Rkq83gLAhzHGOccptNZQSqFpGpRl6cW5lNKfc1hrYYwxnNd1PeuBxySlBwJYA+gOFHtARAwcbYBEMz50zhkcGL2nruv7rw7/E2ishZYSpmngfgPsP6eqKjzGMZ7z3H/Kfm1Qh23bQgjBjw69Xg/scNtBV0nkaYpVkiBNUxRF4cdp8Bu6rvNdMaQXz95PgHfburbWmp2cMw5ggxebv9U30n8yh0T0sANGUXQ+uZlcT6fTy+VyebVYLA4Re6L5fH7RA3k52tuHaMf4BJqyb6KR4zgyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Sample web page\"\n        title=\"\"\n        src=\"/static/9db25098d741ff550cd9f8e292d63562/2bef9/image.png\"\n        srcset=\"/static/9db25098d741ff550cd9f8e292d63562/6f3f2/image.png 256w,\n/static/9db25098d741ff550cd9f8e292d63562/01e7c/image.png 512w,\n/static/9db25098d741ff550cd9f8e292d63562/2bef9/image.png 1024w,\n/static/9db25098d741ff550cd9f8e292d63562/71c1d/image.png 1536w,\n/static/9db25098d741ff550cd9f8e292d63562/9c1e6/image.png 1734w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Attaching an sample web page with examples of how to:</p>\n<ul>\n<li>get current positions</li>\n<li>subscribe to \"realtime\" updates</li>\n</ul>\n<p><div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/ico<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://www.interactivebrokers.com/favicon.ico<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>ib<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token selector\">html, body</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100vw<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100vh<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">justify-content</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">main</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">main table</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> auto<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stats<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>positions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://api.ibkr.com/images/web/logos/ib-logo-text-black.svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>200<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token comment\">/*\nSwagger: https://www.interactivebrokers.com/api/doc.html\n*/</span>\n\n<span class=\"token comment\">// Sample: retrieve account and its positions</span>\n<span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://localhost:5000/v1/api/portfolio/accounts'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://localhost:5000/v1/api/portfolio/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>accountId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/positions/0</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span>\n    p <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GOOGL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'AAPL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MSFT'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'AMZN'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>ticker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    positions<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;table cellpadding=\"5\" cellspacing=\"0\" border=\"0\">'</span> <span class=\"token operator\">+</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>conid<span class=\"token punctuation\">,</span> ticker<span class=\"token punctuation\">,</span> mktPrice<span class=\"token punctuation\">,</span> unrealizedPnl<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;tr data-conid=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>conid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">\n      &lt;td></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ticker<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>\n      &lt;td class=\"price\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mktPrice<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>\n      &lt;td class=\"change\">&lt;/td>\n      &lt;!--\n      &lt;td>&lt;font color=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>unrealizedPnl <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>unrealizedPnl<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/font>&lt;/td>  \n      -->\n    &lt;/tr></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/table>'</span>\n\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> x <span class=\"token keyword\">of</span> p<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      ws<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"smd+\"</span><span class=\"token operator\">+</span>x<span class=\"token punctuation\">.</span>conid<span class=\"token operator\">+</span><span class=\"token string\">\"+{\\\"fields\\\":[\\\"31\\\",\\\"83\\\"],\\\"tempo\\\":2000,\\\"snapshot\\\":true}\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">// Sample: web socket connection  </span>\n<span class=\"token comment\">// https://interactivebrokers.github.io/cpwebapi/websockets</span>\n<span class=\"token keyword\">var</span> ws <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebSocket</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wss://localhost:5000/v1/api/ws\"</span><span class=\"token punctuation\">)</span>\nws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onopen</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"open\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\nws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> txt <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> e<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> msg <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>txt<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>topic <span class=\"token operator\">===</span> <span class=\"token string\">'system'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'hb'</span> <span class=\"token keyword\">in</span> msg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>topic <span class=\"token operator\">===</span> <span class=\"token string\">'act'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// activated</span>\n      ws<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'spl{}'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// example: subscribe to overall stats for account, to unsubscribe send `upl{}`</span>\n\n      <span class=\"token comment\">// ws.send(\"smd+208813719+{\\\"fields\\\":[\\\"31\\\",\\\"83\\\"],\\\"tempo\\\":2000,\\\"snapshot\\\":true}\") // example: subscribe to concrete ticker updates, to unsubscribe send `umd+498854138+{}`</span>\n\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>topic<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'smd+'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// subscription to concrete ticker updates</span>\n      <span class=\"token keyword\">var</span> tr <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">tr[data-conid=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg<span class=\"token punctuation\">.</span>conid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'smd'</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>msg<span class=\"token punctuation\">.</span>conid <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'31'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'83'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'31'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          tr<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'td.price'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;font></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'31'</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/font></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">}</span> \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'83'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          tr<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'td.change'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;font color=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'83'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg<span class=\"token punctuation\">[</span><span class=\"token string\">'83'</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/font></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      \n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>topic <span class=\"token operator\">===</span> <span class=\"token string\">'spl'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// subscribe: ws.send('spl{}')</span>\n      <span class=\"token comment\">// unsubscribe: ws.send('upl{}')</span>\n      <span class=\"token keyword\">var</span> dpl <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dpl\n      <span class=\"token keyword\">var</span> upl <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>upl\n      <span class=\"token comment\">// document.getElementById('stats').innerHTML = `dpl: &lt;font color=\"${dpl > 0 ? 'green' : 'red'}\">${dpl}&lt;/font>, upl: &lt;font color=\"${upl > 0 ? 'green' : 'red'}\">${upl}&lt;/font>`</span>\n      document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'stats'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;font color=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dpl <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dpl<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/font></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'onmessage'</span><span class=\"token punctuation\">,</span>txt<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclose</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"closed\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\nws<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/*\nws.send('ech+hb') // \"ech+hb\"\n\nws.send('spl{}') // \"{\\\"topic\\\":\\\"spl\\\",\\\"args\\\":{\\\"U3413059.Core\\\":{\\\"rowType\\\":1,\\\"dpl\\\":23.61,\\\"nl\\\":14570.0,\\\"upl\\\":2258.0,\\\"el\\\":296.7,\\\"mv\\\":14270.0}}}\"\nws.send('upl{}')\n\nws.send('uor+{}') // orders?\n\n// curl -k 'https://localhost:5000/v1/api/md/snapshot?conids=498854138&amp;fields=31&amp;fields=84&amp;fields=85&amp;fields=86&amp;fields=88'\n// https://www.interactivebrokers.com/api/doc.html#tag/Market-Data/paths/~1md~1snapshot/get\n\nws.send(\"smd+498854138+{\\\"fields\\\":[\\\"31\\\",\\\"84\\\",\\\"85\\\",\\\"86\\\",\\\"87\\\",\\\"88\\\",\\\"7059\\\",\\\"7634\\\"],\\\"tempo\\\":2000,\\\"snapshot\\\":true}\")\n// \"{\\\"server_id\\\":\\\"q118\\\",\\\"conidEx\\\":\\\"498854138\\\",\\\"conid\\\":498854138,\\\"_updated\\\":1696011002361,\\\"6119\\\":\\\"q118\\\",\\\"86\\\":\\\"29.54\\\",\\\"topic\\\":\\\"smd+498854138\\\"}\" \nws.send('umd+498854138+{}')\n\nws.send(\"smd+498854138+{\\\"fields\\\":[\\\"31\\\",\\\"7676\\\"],\\\"tempo\\\":2000,\\\"snapshot\\\":true}\")\n\n31\tLast Price - The last price at which the contract traded. May contain one of the following prefixes: C - Previous day's closing price. H - Trading has halted.\n70\tHigh - Current day high price\n71\tLow - Current day low price\n82\tChange - The difference between the last price and the close on the previous trading day\n83\tChange % - The difference between the last price and the close on the previous trading day in percentage.\n7295\tOpen - Today's opening price.\n7296\tClose - Today's closing price.\n7674\tEMA(200) - Exponential moving average (N=200).\n7676\tEMA(50) - Exponential moving average (N=50).\n\n6509\tMarket Data Availability. The field may contain three chars. First char defines: R = RealTime, D = Delayed, Z = Frozen, Y = Frozen Delayed, N = Not Subscribed. Second char defines: P = Snapshot, p = Consolidated. Third char defines: B = Book\n  RealTime - Data is relayed back in real time without delay, market data subscription(s) are required.\n  Delayed - Data is relayed back 15-20 min delayed.\n  Frozen - Last recorded data at market close, relayed back in real time.\n  Frozen Delayed - Last recorded data at market close, relayed back delayed.\n  Not Subscribed - User does not have the required market data subscription(s) to relay back either real time or delayed data.\n  Snapshot - Snapshot request is available for contract.\n  Consolidated - Market data is aggregated across multiple exchanges or venues.\n  Book - Top of the book data is available for contract.\n\ncurl -k -X POST 'https://localhost:5000/v1/api/tickle' -d ''\n{\"session\":\"bd842d05d887a85a8362ac6b4620b999\",\"ssoExpires\":434805,\"collission\":false,\"userId\":45049960,\"hmds\":{\"error\":\"no bridge\"},\"iserver\":{\"authStatus\":{\"authenticated\":true,\"competing\":false,\"connected\":true,\"message\":\"\",\"MAC\":\"F4:03:43:E6:57:70\",\"serverInfo\":{\"serverName\":\"JifZ23102\",\"serverVersion\":\"Build 10.25.0d, Sep 21, 2023 6:05:00 PM\"}}}}\n\ncurl -k -X POST 'https://localhost:5000/v1/api/iserver/auth/status' -d ''\n{\"authenticated\":true,\"competing\":false,\"connected\":true,\"message\":\"\",\"MAC\":\"F4:03:43:E6:57:70\",\"serverInfo\":{\"serverName\":\"JifZ23102\",\"serverVersion\":\"Build 10.25.0d, Sep 21, 2023 6:05:00 PM\"},\"fail\":\"\"}\n\ncurl -k -X POST 'https://localhost:5000/v1/api/sso/validate' -d ''\n{\"USER_ID\":45049960,\"USER_NAME\":\"marche985\",\"RESULT\":true,\"AUTH_TIME\":1696010968984,\"SF_ENABLED\":true,\"IS_FREE_TRIAL\":false,\"CREDENTIAL\":\"marche985\",\"IP\":\"178.150.44.191\",\"EXPIRES\":300102,\"QUALIFIED_FOR_MOBILE_AUTH\":null,\"LANDING_APP\":\"PORTAL\",\"IS_MASTER\":false,\"lastAccessed\":1696011245028,\"features\":{\"env\":\"PROD\",\"wlms\":true,\"realtime\":true,\"bond\":true,\"optionChains\":true,\"calendar\":true,\"newMf\":true}}\n\ncurl -k -X POST 'https://localhost:5000/v1/api/iserver/reauthenticate' -d ''\n{\"message\":\"triggered\"}\n\nhttps://www.interactivebrokers.com/api/doc.html#tag/Market-Data/paths/~1md~1snapshot/get\n\ncurl -k 'https://localhost:5000/v1/api/iserver/account/orders'\n{\"orders\":[],\"snapshot\":false}\n*/</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div></p>\n<p>Notes:</p>\n<ul>\n<li>even so changes are streamed they are approx 15min delayed</li>\n</ul>\n<h2>Cleanup</h2>\n<p><div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> .vertx jars <span class=\"token function\">java</span> bin build dist doc logs root <span class=\"token operator\">||</span> <span class=\"token boolean\">true</span></code></pre></div></p>\n<h2>How it works</h2>\n<ul>\n<li>We are starting proxy that will serve any request from api.ibkr.com preserving cookies</li>\n<li>Homepage is served from <code class=\"language-text\">https://api.ibkr.com/sso/Login?forwardTo=22&amp;RL=1&amp;ip2loc=US</code></li>\n<li>After login cookies are saved</li>\n<li>Subsequent requests like <code class=\"language-text\">https://localhost:5000/v1/api/iserver/auth/status</code> or <code class=\"language-text\">https://localhost:5000/v1/api/iserver/accounts</code> will be proxied to api.ibkr.com with saved cookies</li>\n</ul>\n<p>Really good alternative approach to understand is to create your own app with electron</p>\n<h2>Creating custom Interactive Brokers Client</h2>\n<p>Following <a href=\"https://www.electronjs.org/docs/latest/tutorial/quick-start\">quick start</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> ib\n<span class=\"token builtin class-name\">cd</span> ib\n<span class=\"token function\">npm</span> init <span class=\"token parameter variable\">-y</span> <span class=\"token parameter variable\">-f</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-D</span> electron</code></pre></div>\n<p>Here is the <code class=\"language-text\">main.js</code>:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// main.js</span>\n\n<span class=\"token comment\">// Modules to control application life and create native browser window</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> app<span class=\"token punctuation\">,</span> BrowserWindow <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'electron'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node:path'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createWindow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Create the browser window.</span>\n  <span class=\"token keyword\">const</span> mainWindow <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BrowserWindow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">1248</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">768</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">webPreferences</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">preload</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'preload.js'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// and load the index.html of the app.</span>\n  <span class=\"token comment\">// mainWindow.loadFile('index.html') // instead of loading local file we are going to serve api.ibrk.com directly</span>\n  <span class=\"token comment\">// mainWindow.loadURL('https://api.ibkr.com/sso/Login') // note that we need following query string parameters taken from gateway</span>\n  mainWindow<span class=\"token punctuation\">.</span><span class=\"token function\">loadURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.ibkr.com/sso/Login?forwardTo=22&amp;RL=1&amp;ip2loc=US'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// Open the DevTools.</span>\n  <span class=\"token comment\">// mainWindow.webContents.openDevTools()</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// This method will be called when Electron has finished</span>\n<span class=\"token comment\">// initialization and is ready to create browser windows.</span>\n<span class=\"token comment\">// Some APIs can only be used after this event occurs.</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">whenReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">createWindow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  app<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'activate'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// On macOS it's common to re-create a window in the app when the</span>\n    <span class=\"token comment\">// dock icon is clicked and there are no other windows open.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>BrowserWindow<span class=\"token punctuation\">.</span><span class=\"token function\">getAllWindows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token function\">createWindow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Quit when all windows are closed, except on macOS. There, it's common</span>\n<span class=\"token comment\">// for applications and their menu bar to stay active until the user quits</span>\n<span class=\"token comment\">// explicitly with Cmd + Q.</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'window-all-closed'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>platform <span class=\"token operator\">!==</span> <span class=\"token string\">'darwin'</span><span class=\"token punctuation\">)</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// In this file you can include the rest of your app's specific main process</span>\n<span class=\"token comment\">// code. You can also put them in separate files and require them here.</span></code></pre></div></p>\n<p>it is almost the same as in quick start guide except we are serving api.ibkr.com instead of local file</p>\n<p>Our <code class=\"language-text\">preload.js</code> looks like this:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// preload.js</span>\n\n<span class=\"token comment\">// All the Node.js APIs are available in the preload process.</span>\n<span class=\"token comment\">// It has the same sandbox as a Chrome extension.</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DOMContentLoaded'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// const replaceText = (selector, text) => {</span>\n  <span class=\"token comment\">//   const element = document.getElementById(selector)</span>\n  <span class=\"token comment\">//   if (element) element.innerText = text</span>\n  <span class=\"token comment\">// }</span>\n\n  <span class=\"token comment\">// for (const dependency of ['chrome', 'node', 'electron']) {</span>\n  <span class=\"token comment\">//   replaceText(`${dependency}-version`, process.versions[dependency])</span>\n  <span class=\"token comment\">// }</span>\n  \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.ibkr.com/sso/Login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.download-text, footer, .xyz-sso-login-header, p.text-end.link-password, .xyzblock-username-submit > .text-center'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=></span> el<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://ndcdyn.interactivebrokers.com/Universal/servlet/AccountAccess.AuthenticateSSO'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'REDIRECT'</span><span class=\"token punctuation\">)</span>\n    window<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.ibkr.com/'</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'https://api.ibkr.com/'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'IBKR'</span>  \n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.ibkr.com/v1/api/portfolio/accounts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;h1>'</span> <span class=\"token operator\">+</span> data<span class=\"token operator\">?.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span>accountId <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/h1>'</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.ibkr.com/v1/api/portfolio/accounts'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.ibkr.com/v1/api/portfolio/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>accountId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/positions/0</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">positions</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;table cellpadding=\"5\" cellspacing=\"0\" border=\"1\">&lt;tr>&lt;td>ticker&lt;/td>&lt;td>avgprice&lt;/td>&lt;td>mrkprice&lt;/td>&lt;td>pnl&lt;/td>&lt;/tr>'</span> <span class=\"token operator\">+</span> positions<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>ticker<span class=\"token punctuation\">,</span> avgPrice<span class=\"token punctuation\">,</span> mktPrice<span class=\"token punctuation\">,</span> unrealizedPnl<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;tr>&lt;td></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ticker<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>&lt;td></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>avgPrice<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>&lt;td></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mktPrice<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>&lt;td style=\"color:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>unrealizedPnl <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>unrealizedPnl<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/td>&lt;/tr></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/table>'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'OTHER'</span><span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div></p>\n<p>Think of this - this script will be injected and run on each page load, aka the same way if it was an browser extension</p>\n<p>And because we are serving api.ibkr.com we will have all wanted cookies already</p>\n<p>So after login we are opening home page which is empty by default and drawing everything we want there</p>\n<p>Our <code class=\"language-text\">package.json</code> so far looks like this:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ibkr-api\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"private\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"main.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"electron-forge start\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"package\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"electron-forge package\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"make\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"electron-forge make\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@electron-forge/cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@electron-forge/maker-deb\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@electron-forge/maker-rpm\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@electron-forge/maker-squirrel\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@electron-forge/maker-zip\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@electron-forge/plugin-auto-unpack-natives\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^6.4.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"electron\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^27.0.0\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"electron-squirrel-startup\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.0.0\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div></p>\n<p>So we can run it like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> start</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/39793779be3adbd223b354dee9b8886d/53948/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.84375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABc0lEQVR42qWQvUoDQRRGpxKSVhst8jB27vPEp7DV0sJGsbBLpShZ7IwsBgyy6KIkm5Al7s7E/Mzs7sx+cscoGqIQM3BguPe7Zy7DgtvrSjt82I3iuDqYw9Y4r/aiyBJzbmuLsoM43g2CoML8VsvBH8fkOdJUIctSGGP+isL3fYc1Gg1HDIcQw2HOhdCEEEL3X4UO+1w/+S/67v5RNx8C/fjS051I6P6A28xX/mMW5GINz3PeRiPMpBZqTqYSU1UgNwVMAYs2BbSB7VHm+ww5yLVQmAgBpRQmMsNoLCHTHCrTUJlBlgNSquWFUin6QRSFBlD8+CvqLSWkMG1xet3H3tkz9mttHNTa9n5S70FK+Q+hUrhsxji6aOPUDXFc7+LwvIurJl9+w8+AMSmAn1Dtt7wV3njeTsI5vZgnnOvvDOJkIfO52SzIxTzPcybTKUbj8UqQg1zMdd3tTqcThWHYWwVykIsxxtY2yuXN9VJpaxXIQa53Y+1ssOlojAkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"start screen\"\n        title=\"\"\n        src=\"/static/39793779be3adbd223b354dee9b8886d/2bef9/image-1.png\"\n        srcset=\"/static/39793779be3adbd223b354dee9b8886d/6f3f2/image-1.png 256w,\n/static/39793779be3adbd223b354dee9b8886d/01e7c/image-1.png 512w,\n/static/39793779be3adbd223b354dee9b8886d/2bef9/image-1.png 1024w,\n/static/39793779be3adbd223b354dee9b8886d/71c1d/image-1.png 1536w,\n/static/39793779be3adbd223b354dee9b8886d/a878e/image-1.png 2048w,\n/static/39793779be3adbd223b354dee9b8886d/53948/image-1.png 2720w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>and after successfull login list of our positions will be drawn 💪</p>\n<p>To publish it</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-D</span> @electron-forge/cli\nnpx electron-forge <span class=\"token function\">import</span>\n<span class=\"token function\">npm</span> run <span class=\"token function\">make</span></code></pre></div>\n<p>And your binary will be here <code class=\"language-text\">out/ibkr-api-darwin-arm64/ibkr-api</code></p>\n<p>For custom icon I have added following:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">packagerConfig</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">asar</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">icon</span><span class=\"token operator\">:</span> <span class=\"token string\">'images/icon'</span> <span class=\"token comment\">// no file extension required</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here is how it looks like:</p>\n<video src=\"/c2f399f9c1211e4a0bfb6f50004b539d/ib3.mp4\" />\n<p>Techinically similar approach may be used in SwiftUI which will be probably an next milestone</p>"}},"pageContext":{"id":"a49e266d-6a02-5761-a85f-75bacefd728f"}},"staticQueryHashes":[],"slicesMap":{}}