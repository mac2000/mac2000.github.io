{"componentChunkName":"component---src-templates-note-js","path":"/appinsights-1-percent","result":{"data":{"remark":{"fields":{"path":"appinsights-1-percent"},"meta":{"title":""},"headings":[{"value":"ApplicationInsights set sampling to one percent"}],"html":"<h1>ApplicationInsights set sampling to one percent</h1>\n<p>here is an sample powershell script to set sampling 1% to all appinsights</p>\n<p><div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force</span>\n<span class=\"token comment\"># Connect-AzAccount</span>\n<span class=\"token comment\"># Get-AzSubscription</span>\n<span class=\"token comment\"># Get-AzSubscription | Where-Object Name -Match Azure | Set-AzContext</span>\n\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span> in <span class=\"token function\">Get-AzApplicationInsights</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>SamplingPercentage <span class=\"token operator\">-and</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>SamplingPercentage <span class=\"token operator\">-le</span> 1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\"># Write-Host $item.Name -ForegroundColor Cyan</span>\n        <span class=\"token keyword\">continue</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token variable\">$resource</span> = <span class=\"token function\">Get-AzResource</span> <span class=\"token operator\">-</span>Name <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>Name <span class=\"token operator\">-</span>ResourceType Microsoft<span class=\"token punctuation\">.</span>Insights/Components <span class=\"token operator\">-</span>ResourceGroupName <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>ResourceGroupName\n    <span class=\"token comment\"># $resource.Properties.SamplingPercentage = 12.5</span>\n    <span class=\"token variable\">$resource</span><span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">.</span>SamplingPercentage = 1\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$resource</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Set-AzResource</span> <span class=\"token operator\">-</span>Force <span class=\"token punctuation\">|</span> <span class=\"token function\">Out-Null</span>\n        <span class=\"token function\">Write-Host</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>Name <span class=\"token operator\">-</span>ForegroundColor Green\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">Write-Host</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>Name <span class=\"token operator\">-</span>ForegroundColor Red\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div></p>"}},"pageContext":{"id":"a86d3485-31d5-5447-b2e6-e830c1eacb45"}},"staticQueryHashes":[]}