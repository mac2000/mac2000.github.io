{"componentChunkName":"component---src-templates-note-js","path":"/notion/","result":{"data":{"remark":{"fields":{"path":"notion"},"meta":{"title":""},"headings":[{"value":"Notion API"}],"html":"<h1>Notion API</h1>\n<p>It is needed once per few years and each time took some time to recover knowledge, so writing a note for myself</p>\n<p>Let's pretend in Notion we have an movies database with some sample fields</p>\n<p>We will use following script to get some sample movies</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$genres</span> = <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token string\">\"https://api.themoviedb.org/3/genre/movie/list?language=en\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:TMDB<span class=\"token punctuation\">)</span></span>\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty genres\n<span class=\"token variable\">$movies</span> = @<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token variable\">$movies</span> <span class=\"token operator\">+=</span> <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token string\">\"https://api.themoviedb.org/3/movie/popular?language=en-US&amp;page=1\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:TMDB<span class=\"token punctuation\">)</span></span>\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty results <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> title<span class=\"token punctuation\">,</span> overview<span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'poster'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token string\">\"https://image.tmdb.org/t/p/w500<span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>poster_path<span class=\"token punctuation\">)</span></span>\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'rating'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>vote_average <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'year'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token namespace\">[int]</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>release_date<span class=\"token punctuation\">.</span>Substring<span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span> 4<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'genres'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>genre_ids <span class=\"token punctuation\">|</span> <span class=\"token function\">ForEach-Object</span> <span class=\"token punctuation\">{</span> <span class=\"token variable\">$genres</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Where-Object</span> id <span class=\"token operator\">-eq</span> <span class=\"token variable\">$_</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty name <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$movies</span> <span class=\"token operator\">+=</span> <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token string\">\"https://api.themoviedb.org/3/movie/top_rated?language=en-US&amp;page=1\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:TMDB<span class=\"token punctuation\">)</span></span>\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty results <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> title<span class=\"token punctuation\">,</span> overview<span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'poster'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token string\">\"https://image.tmdb.org/t/p/w500<span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>poster_path<span class=\"token punctuation\">)</span></span>\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'rating'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>vote_average <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'year'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token namespace\">[int]</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>release_date<span class=\"token punctuation\">.</span>Substring<span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span> 4<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n = <span class=\"token string\">'genres'</span><span class=\"token punctuation\">;</span> e = <span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>genre_ids <span class=\"token punctuation\">|</span> <span class=\"token function\">ForEach-Object</span> <span class=\"token punctuation\">{</span> <span class=\"token variable\">$genres</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Where-Object</span> id <span class=\"token operator\">-eq</span> <span class=\"token variable\">$_</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty name <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$movies</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">ConvertTo-Json</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Out-File</span> movies<span class=\"token punctuation\">.</span>json</code></pre></div>\n<p>Next step is to configure and database in Notion with corresponding columts</p>\n<p>After that is done we gonna need to</p>\n<p><a href=\"https://www.notion.so/profile/integrations\">https://www.notion.so/profile/integrations</a></p>\n<p>Create integration, and grab its token</p>\n<p>Then, in notion, click on tripple dots, and choose created integration from connections menu</p>\n<p>After that following sample scripts should work</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Post <span class=\"token string\">\"https://api.notion.com/v1/search\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"applicaion/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n  query = <span class=\"token string\">\"\"</span>\n  <span class=\"token keyword\">filter</span> = @<span class=\"token punctuation\">{</span>\n    property = <span class=\"token string\">\"object\"</span>\n    value = <span class=\"token string\">\"database\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty results <span class=\"token punctuation\">|</span> <span class=\"token function\">Where-Object</span> object <span class=\"token operator\">-EQ</span> <span class=\"token string\">\"database\"</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> id<span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">\"title\"</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>plain_text <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>in my case it was</p>\n<table>\n<thead>\n<tr>\n<th>id</th>\n<th>title</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1d637d44-7d4b-80f8-b5a6-c9977db0f450</td>\n<td>movies</td>\n</tr>\n</tbody>\n</table>\n<p>note: technically it is in url, but without dashes</p>\n<p>having database id in place we should be able to do some basic CRUD</p>\n<p><strong>create</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Post <span class=\"token string\">\"https://api.notion.com/v1/pages\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n    parent     = @<span class=\"token punctuation\">{</span> database_id = <span class=\"token string\">\"1d637d44-7d4b-80f8-b5a6-c9977db0f450\"</span> <span class=\"token punctuation\">}</span>\n    properties = @<span class=\"token punctuation\">{</span>\n      Title    = @<span class=\"token punctuation\">{</span> title = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token string\">\"Inception\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Genres   = @<span class=\"token punctuation\">{</span> multi_select = @<span class=\"token punctuation\">(</span> @<span class=\"token punctuation\">{</span> name = <span class=\"token string\">\"Sci-Fi\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span> name = <span class=\"token string\">\"Thriller\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Rating   = @<span class=\"token punctuation\">{</span> number = 8<span class=\"token punctuation\">.</span>8 <span class=\"token punctuation\">}</span>\n      Year     = @<span class=\"token punctuation\">{</span> number = 2010 <span class=\"token punctuation\">}</span>\n      Overview = @<span class=\"token punctuation\">{</span> rich_text = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token string\">\"A thief who steals corporate secrets through dream-sharing tech is given the inverse task of planting an idea.\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Poster   = @<span class=\"token punctuation\">{</span> files = @<span class=\"token punctuation\">(</span> @<span class=\"token punctuation\">{</span> <span class=\"token function\">type</span> = <span class=\"token string\">\"external\"</span><span class=\"token punctuation\">;</span> name = <span class=\"token string\">\"poster.jpg\"</span><span class=\"token punctuation\">;</span> external = @<span class=\"token punctuation\">{</span> url = <span class=\"token string\">\"https://image.tmdb.org/t/p/w500/xlaY2zyzMfkhk0HSC5VUwzoZPU1.jpg\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Note: more details of how properties are composed can be found <a href=\"https://developers.notion.com/reference/block\">here</a></p>\n<p><strong>read</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Get <span class=\"token string\">\"https://api.notion.com/v1/pages/1d637d44-7d4b-81dc-a4a3-f943559bd2d2\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>update</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Patch <span class=\"token string\">\"https://api.notion.com/v1/pages/1d637d44-7d4b-81dc-a4a3-f943559bd2d2\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n    parent     = @<span class=\"token punctuation\">{</span> database_id = <span class=\"token string\">\"1d637d44-7d4b-80f8-b5a6-c9977db0f450\"</span> <span class=\"token punctuation\">}</span>\n    properties = @<span class=\"token punctuation\">{</span>\n      Title      = @<span class=\"token punctuation\">{</span> title = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token string\">\"Inception2\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\"># Genres   = @{ multi_select = @( @{ name = \"Sci-Fi\" }, @{ name = \"Thriller\" } ) }</span>\n      <span class=\"token comment\"># Rating   = @{ number = 8.8 }</span>\n      Year       = @<span class=\"token punctuation\">{</span> number = 2020 <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\"># Overview = @{ rich_text = @(@{ text = @{ content = \"A thief who steals corporate secrets through dream-sharing tech is given the inverse task of planting an idea.\" } }) }</span>\n      <span class=\"token comment\"># Poster   = @{ files = @( @{ type = \"external\"; name = \"poster.jpg\"; external = @{ url = \"https://image.tmdb.org/t/p/w500/74hLDKjD5aGYOotO6esUVaeISa2.jpg\" } } ) }</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Note: with <code class=\"language-text\">Patch</code> you may update wanted fields</p>\n<p><strong>delete</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Patch <span class=\"token string\">\"https://api.notion.com/v1/pages/1d637d44-7d4b-81dc-a4a3-f943559bd2d2\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span> archived = <span class=\"token boolean\">$true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now, when we have basic CRUD, lets fill the database with movies</p>\n<p><strong>seed</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$movies</span> = <span class=\"token function\">Get-Content</span> movies<span class=\"token punctuation\">.</span>json <span class=\"token punctuation\">|</span> <span class=\"token function\">ConvertFrom-Json</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$movie</span> in <span class=\"token variable\">$movies</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Post <span class=\"token string\">\"https://api.notion.com/v1/pages\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n      parent     = @<span class=\"token punctuation\">{</span> database_id = <span class=\"token string\">\"1d637d44-7d4b-80f8-b5a6-c9977db0f450\"</span> <span class=\"token punctuation\">}</span>\n      properties = @<span class=\"token punctuation\">{</span>\n        Title    = @<span class=\"token punctuation\">{</span> title = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>title <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n        Genres   = @<span class=\"token punctuation\">{</span> multi_select = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>genres <span class=\"token punctuation\">|</span> <span class=\"token function\">ForEach-Object</span> <span class=\"token punctuation\">{</span> @<span class=\"token punctuation\">{</span> name = <span class=\"token variable\">$_</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n        Rating   = @<span class=\"token punctuation\">{</span> number = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>rating <span class=\"token punctuation\">}</span>\n        Year     = @<span class=\"token punctuation\">{</span> number = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>year <span class=\"token punctuation\">}</span>\n        Overview = @<span class=\"token punctuation\">{</span> rich_text = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>overview <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n        Poster   = @<span class=\"token punctuation\">{</span> files = @<span class=\"token punctuation\">(</span> @<span class=\"token punctuation\">{</span> <span class=\"token function\">type</span> = <span class=\"token string\">\"external\"</span><span class=\"token punctuation\">;</span> name = <span class=\"token string\">\"poster.jpg\"</span><span class=\"token punctuation\">;</span> external = @<span class=\"token punctuation\">{</span> url = <span class=\"token variable\">$movie</span><span class=\"token punctuation\">.</span>poster <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>and very last one</p>\n<p><strong>query</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Post <span class=\"token string\">\"https://api.notion.com/v1/databases/1d637d44-7d4b-80f8-b5a6-c9977db0f450/query\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">filter</span> = @<span class=\"token punctuation\">{</span>\n      and = @<span class=\"token punctuation\">(</span>\n        @<span class=\"token punctuation\">{</span>\n          property     = <span class=\"token string\">\"Genres\"</span>\n          multi_select = @<span class=\"token punctuation\">{</span>\n            contains = <span class=\"token string\">\"Action\"</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        @<span class=\"token punctuation\">{</span>\n          property = <span class=\"token string\">\"Year\"</span>\n          number   = @<span class=\"token punctuation\">{</span>\n            greater_than = 2020\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty results <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'title'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">.</span>Title<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>plain_text <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'year'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">.</span>Year<span class=\"token punctuation\">.</span>number <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'genres'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Properties<span class=\"token punctuation\">.</span>Genres<span class=\"token punctuation\">.</span>multi_select <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>ExpandProperty name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>note: more on how to query fields can be found <a href=\"https://developers.notion.com/reference/post-database-query-filter\">here</a></p>\n<p><strong>rich_text</strong></p>\n<p>note, rich text fields may contain basic markup</p>\n<p>that's the reason why it is returned as array</p>\n<p>once you have some markup it may look like:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"The adventures of a group of explorers who make use of a newly \"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"discovered\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"annotations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"bold\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\" wormhole to surpass the limitations on human space travel and conquer the vast distances involved in an interstellar voyage.\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>in example above, i have removed defaulted falsy properties, note how one bold word is extracted into dedicated array item.</p>\n<p>while creating - same shape should be used.</p>\n<p><strong>children</strong></p>\n<p>each record in database is actual page, so it can contain any children</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Method Post <span class=\"token string\">\"https://api.notion.com/v1/pages\"</span> <span class=\"token operator\">-</span>Headers @<span class=\"token punctuation\">{</span> Authorization = <span class=\"token string\">\"Bearer <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:NOTION<span class=\"token punctuation\">)</span></span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token string\">\"Notion-Version\"</span> = <span class=\"token string\">\"2022-06-28\"</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span>ContentType <span class=\"token string\">\"application/json\"</span> <span class=\"token operator\">-</span>Body <span class=\"token punctuation\">(</span><span class=\"token function\">ConvertTo-Json</span> <span class=\"token operator\">-</span>Depth 100 <span class=\"token operator\">-</span>InputObject @<span class=\"token punctuation\">{</span>\n    parent     = @<span class=\"token punctuation\">{</span> database_id = <span class=\"token string\">\"1d637d44-7d4b-80f8-b5a6-c9977db0f450\"</span> <span class=\"token punctuation\">}</span>\n    properties = @<span class=\"token punctuation\">{</span>\n      Title    = @<span class=\"token punctuation\">{</span> title = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token string\">\"Children2\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Genres   = @<span class=\"token punctuation\">{</span> multi_select = @<span class=\"token punctuation\">(</span> @<span class=\"token punctuation\">{</span> name = <span class=\"token string\">\"Sci-Fi\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span> name = <span class=\"token string\">\"Thriller\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Rating   = @<span class=\"token punctuation\">{</span> number = 8<span class=\"token punctuation\">.</span>8 <span class=\"token punctuation\">}</span>\n      Year     = @<span class=\"token punctuation\">{</span> number = 2010 <span class=\"token punctuation\">}</span>\n      Overview = @<span class=\"token punctuation\">{</span> rich_text = @<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">{</span> text = @<span class=\"token punctuation\">{</span> content = <span class=\"token string\">\"A thief who steals corporate secrets through dream-sharing tech is given the inverse task of planting an idea.\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      Poster   = @<span class=\"token punctuation\">{</span> files = @<span class=\"token punctuation\">(</span> @<span class=\"token punctuation\">{</span> <span class=\"token function\">type</span> = <span class=\"token string\">\"external\"</span><span class=\"token punctuation\">;</span> name = <span class=\"token string\">\"poster.jpg\"</span><span class=\"token punctuation\">;</span> external = @<span class=\"token punctuation\">{</span> url = <span class=\"token string\">\"https://image.tmdb.org/t/p/w500/74hLDKjD5aGYOotO6esUVaeISa2.jpg\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    children   = @<span class=\"token punctuation\">(</span>\n      @<span class=\"token punctuation\">{</span>\n        object    = <span class=\"token string\">\"block\"</span>\n        <span class=\"token function\">type</span>      = <span class=\"token string\">\"paragraph\"</span>\n        paragraph = @<span class=\"token punctuation\">{</span>\n          rich_text = @<span class=\"token punctuation\">(</span>\n            @<span class=\"token punctuation\">{</span>\n              <span class=\"token function\">type</span> = <span class=\"token string\">\"text\"</span>\n              text = @<span class=\"token punctuation\">{</span>\n                content = <span class=\"token string\">\"A thief who steals corporate secrets through dream-sharing tech is given the inverse task of planting an idea.\"</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\"># header</span>\n      @<span class=\"token punctuation\">{</span>\n        object    = <span class=\"token string\">\"block\"</span>\n        <span class=\"token function\">type</span>      = <span class=\"token string\">\"heading_2\"</span>\n        heading_2 = @<span class=\"token punctuation\">{</span>\n          rich_text = @<span class=\"token punctuation\">(</span>\n            @<span class=\"token punctuation\">{</span>\n              <span class=\"token function\">type</span> = <span class=\"token string\">\"text\"</span>\n              text = @<span class=\"token punctuation\">{</span>\n                content = <span class=\"token string\">\"Children\"</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\"># image</span>\n      @<span class=\"token punctuation\">{</span>\n        object = <span class=\"token string\">\"block\"</span>\n        <span class=\"token function\">type</span>   = <span class=\"token string\">\"image\"</span>\n        image  = @<span class=\"token punctuation\">{</span>\n          <span class=\"token function\">type</span>     = <span class=\"token string\">\"external\"</span>\n          external = @<span class=\"token punctuation\">{</span>\n            url = <span class=\"token string\">\"https://image.tmdb.org/t/p/w500/74hLDKjD5aGYOotO6esUVaeISa2.jpg\"</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>note: technically this children is same as properties but can be anything</p>"}},"pageContext":{"id":"795d7a11-38fd-5159-a4de-a88f5fa1bcf7"}},"staticQueryHashes":[],"slicesMap":{}}