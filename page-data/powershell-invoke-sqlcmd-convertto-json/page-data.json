{"componentChunkName":"component---src-templates-note-js","path":"/powershell-invoke-sqlcmd-convertto-json","result":{"data":{"remark":{"fields":{"path":"powershell-invoke-sqlcmd-convertto-json"},"meta":{"title":""},"headings":[{"value":"PowerShell Invoke-SqlCmd ConvertTo-Json"}],"html":"<h1>PowerShell Invoke-SqlCmd ConvertTo-Json</h1>\n<p>Here is simple one liner for dumping SQL queries into json</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Invoke-Sqlcmd</span> <span class=\"token operator\">-</span>InputFile <span class=\"token punctuation\">.</span>\\VacanciesExport<span class=\"token punctuation\">.</span>sql <span class=\"token operator\">-</span>ServerInstance <span class=\"token string\">'TESTSRV13'</span> <span class=\"token operator\">-</span>Database <span class=\"token string\">'Beta'</span> <span class=\"token operator\">-</span>Username <span class=\"token string\">'sa'</span> <span class=\"token operator\">-</span>Password <span class=\"token variable\">$env</span>:TESTSRV13_SQL_PASSWORD <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">*</span> <span class=\"token operator\">-</span>ExcludeProperty ItemArray<span class=\"token punctuation\">,</span> Table<span class=\"token punctuation\">,</span> RowError<span class=\"token punctuation\">,</span> RowState<span class=\"token punctuation\">,</span> HasErrors <span class=\"token punctuation\">|</span> <span class=\"token function\">ConvertTo-Json</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Out-File</span> <span class=\"token punctuation\">.</span>\\vacancies<span class=\"token punctuation\">.</span>json</code></pre></div>\n<p>If you will try <code class=\"language-text\">ConvertTo-Json</code> results of <code class=\"language-text\">Invoke-SqlCmd</code> as is you will get bunch of unwanted data like <code class=\"language-text\">ItemArray</code>, <code class=\"language-text\">Table</code> etc. To reduce it we are using: <code class=\"language-text\">Select-Object * -ExcludeProperty ItemArray, Table, RowError, RowState, HasErrors</code></p>"}},"pageContext":{"id":"1c8398c1-344e-593c-92ba-23d1d124f8ac"}},"staticQueryHashes":[]}