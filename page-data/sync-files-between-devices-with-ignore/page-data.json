{"componentChunkName":"component---src-templates-note-js","path":"/sync-files-between-devices-with-ignore/","result":{"data":{"remark":{"fields":{"path":"sync-files-between-devices-with-ignore"},"meta":{"title":""},"headings":[{"value":"Sync Files Between Devices With Ignore List"}],"html":"<h1>Sync Files Between Devices With Ignore List</h1>\n<p>OneDrive, iCloud, Dropbox all them lack ability to ignore folders like node_modules, but there is <a href=\"https://www.resilio.com/individuals/\">Resilio Sync</a> which has <a href=\"https://help.resilio.com/hc/en-us/articles/205458165-Ignoring-files-in-Sync-Ignore-List-\">IgnoreList</a> feature which might solve that issue</p>\n<p>In my case I'm syncing between desktop PC and macbook, so most of the time one of them is turned off, which makes things little bit harden</p>\n<p>Sync can be run as a docker container described <a href=\"https://hub.docker.com/r/resilio/sync/\">here</a></p>\n<p>Which allows me to have something like:</p>\n<p>When everyone online:</p>\n<svg width=\"115pt\" height=\"188pt\" viewBox=\"0.00 0.00 115.25 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"max-width: 100%; height: auto;\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n<title>%0</title>\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-184 111.2523,-184 111.2523,4 -4,4\"></polygon>\n<!-- server -->\n<g id=\"node1\" class=\"node\">\n<title>server</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"66.176\" cy=\"-162\" rx=\"34.7476\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"66.176\" y=\"-157.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">server</text>\n</g>\n<!-- laptop -->\n<g id=\"node2\" class=\"node\">\n<title>laptop</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"35.176\" cy=\"-90\" rx=\"35.3528\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"35.176\" y=\"-85.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">laptop</text>\n</g>\n<!-- server&#45;&gt;laptop -->\n<g id=\"edge1\" class=\"edge\">\n<title>server-&gt;laptop</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M58.513,-144.2022C54.9843,-136.0064 50.7201,-126.1024 46.8072,-117.0145\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"49.9201,-115.3938 42.7507,-107.593 43.4907,-118.162 49.9201,-115.3938\"></polygon>\n</g>\n<!-- desktop -->\n<g id=\"node3\" class=\"node\">\n<title>desktop</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"66.176\" cy=\"-18\" rx=\"41.1529\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"66.176\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">desktop</text>\n</g>\n<!-- server&#45;&gt;desktop -->\n<g id=\"edge2\" class=\"edge\">\n<title>server-&gt;desktop</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M71.585,-144.1926C74.4714,-133.7568 77.7214,-120.2568 79.176,-108 81.0615,-92.1115 81.0615,-87.8885 79.176,-72 78.1692,-63.5166 76.3023,-54.4376 74.2912,-46.1913\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"77.6232,-45.0971 71.7206,-36.2988 70.8482,-46.8576 77.6232,-45.0971\"></polygon>\n</g>\n<!-- laptop&#45;&gt;desktop -->\n<g id=\"edge3\" class=\"edge\">\n<title>laptop-&gt;desktop</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M42.8389,-72.2022C46.3413,-64.0675 50.5683,-54.2501 54.4571,-45.2181\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"57.7538,-46.4115 58.4938,-35.8425 51.3244,-43.6433 57.7538,-46.4115\"></polygon>\n</g>\n</g>\n</svg>\n<p>And usually when just one device is online:</p>\n<svg width=\"178pt\" height=\"116pt\" viewBox=\"0.00 0.00 178.25 116.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"max-width: 100%; height: auto;\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 112)\">\n<title>%0</title>\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-112 174.2523,-112 174.2523,4 -4,4\"></polygon>\n<!-- server -->\n<g id=\"node1\" class=\"node\">\n<title>server</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"35.176\" cy=\"-90\" rx=\"34.7476\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"35.176\" y=\"-85.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">server</text>\n</g>\n<!-- laptop -->\n<g id=\"node2\" class=\"node\">\n<title>laptop</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"35.176\" cy=\"-18\" rx=\"35.3528\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"35.176\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">laptop</text>\n</g>\n<!-- server&#45;&gt;laptop -->\n<g id=\"edge1\" class=\"edge\">\n<title>server-&gt;laptop</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M35.176,-71.8314C35.176,-64.131 35.176,-54.9743 35.176,-46.4166\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"38.6761,-46.4132 35.176,-36.4133 31.6761,-46.4133 38.6761,-46.4132\"></polygon>\n</g>\n<!-- desktop -->\n<g id=\"node3\" class=\"node\">\n<title>desktop</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"129.176\" cy=\"-90\" rx=\"41.1529\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"129.176\" y=\"-85.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">desktop</text>\n</g>\n</g>\n</svg>\n<p>But when desktop will be turned on it will catch up all changes.</p>\n<p>Whenever you are adding directory to sync inside it there is <code class=\"language-text\">.sync/IgnoreList</code> <strong>note</strong> that it is <strong>not synced</strong> and should be edited on each machine</p>\n<p>So if you wish to ignore <code class=\"language-text\">node_modules</code> from being synced you need to add it to all thre machines</p>\n<p>And here is what I ended up with for deployment:</p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Namespace\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ConfigMap\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">sync.conf</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    {\n      \"device_name\": \"cub\",\n      \"listening_port\": 30555,\n      \"shared_folders\": [\n        {\n          \"secret\": \"xxxxxxxxxxxxxxxxxxx\",\n          \"dir\": \"/mnt/sync/folders/data\",\n          \"use_relay_server\": true,\n          \"use_tracker\": true,\n          \"search_lan\": true,\n          \"use_sync_trash\": true,\n          \"overwrite_changes\": false,\n          \"selective_sync\": false\n        }\n      ]\n    }</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> resilio/sync<span class=\"token punctuation\">:</span>2.7.2\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30555</span>\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n              <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /mnt/sync/sync.conf\n              <span class=\"token key atrule\">subPath</span><span class=\"token punctuation\">:</span> sync.conf\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> data\n              <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /mnt/sync/folders/data\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n          <span class=\"token key atrule\">configMap</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> data\n          <span class=\"token key atrule\">hostPath</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /data/sync\n            <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> DirectoryOrCreate\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sync\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30555</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30555</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30555</span></code></pre></div></p>\n<p>Notes for deployment:</p>\n<ul>\n<li>was forced to change everywhere <code class=\"language-text\">55555</code> to <code class=\"language-text\">30555</code> because of given constraints, make sure for this port to be the same everywhere because it is being used by torrent procol underneath</li>\n<li>if you provide <code class=\"language-text\">shared_folders</code> it will automatically disable UI and ability to add/remove them</li>\n<li><code class=\"language-text\">secret</code> can be generated like so <code class=\"language-text\">docker run -it --rm resilio/sync rslync --generate-secret</code></li>\n<li>if you can use persistence volume instead of <code class=\"language-text\">hostPath</code></li>\n<li>be sure to have same <code class=\"language-text\">nodePort</code> in service as <code class=\"language-text\">listening_port</code> in config</li>\n</ul>\n<p>So from now on my desktop mess is synced between machines</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/96cfe914d2328b46be6cdbff91a0e5e7/a2498/sync.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.32812499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACkklEQVR42qWUTWsTQRjHpwexoF+lkJCSiCAEFUUw3cXUkPo5vIilJy+mealoTNO0tW3opb30O0jF6E1skRaSrEkopXpJ9mVmdmceeWazzbaNeHDgzzM7zzy/+c8LSwghRL9zK558kEhHpxMzsVhcu6xk8p4S9qemIkqRSEyLxW9r0Wh0ZjqaSCdiiQQZtslM6uHH7DMdUjOap2s66LoOmqYpYT+TySjh99zcHGSzWZhNz0LqcQrS6Vnx5KkO9x/d3SeEXEfgzRfzC5+X3ryFfD7v5fMFmcvlZLFYlIVCQS4u5pWKxZIslUpybW1drlRX5FKlJl+Va/J9uepVPizBwuvnX5ClgMetdgMAgDpUeJ4ASilw7oLneUApU8KGOZQQAlzsS4lzBOY6RncEbLWaCug4jnBdF1C2bYOUEhijqo9jpmmqyDlXi8kQsNu9AGwp4GAwEIPBQAEY811hxG90hUBUv9/HxVVeYOJvQNM0hWVZasuocUDMY0SX/wRaliWwOAzEQnSDdQjDPAJxIRzjnF8FNpv+Gdq2LYLtBg4wIhyLMYfQwCXGfr8/zmH7gkMEBmd42aFlmeewoVv/ljudEfDo6EfDfxaeumUsxhsM4jg5rgfcdeHX2W8FbLWMEfDw+KABgAAQtu1vaXjgIIbgMFyIQAJ6vRPBmAuGEXJ42PS3jK8azyt4YyPIeKeYPz09Uw4vAL9/O9jHFR2HUtu2OWMO55wqUc64Qx1Oqc0ZjrnMj5hhjPd6J5RSDkb756dzoGEYjfCbCjccOHcFV5vresGlfA2Ak+Vy5WW9vr23sbG1s7m5tRtodXV9t7pc3a3VVpWq1ZoaC8+pb9V3Nurbe4V3y/PB32aCEHKNEHLjP4WMiT+wENXgsPftuwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sync\"\n        title=\"\"\n        src=\"/static/96cfe914d2328b46be6cdbff91a0e5e7/2bef9/sync.png\"\n        srcset=\"/static/96cfe914d2328b46be6cdbff91a0e5e7/6f3f2/sync.png 256w,\n/static/96cfe914d2328b46be6cdbff91a0e5e7/01e7c/sync.png 512w,\n/static/96cfe914d2328b46be6cdbff91a0e5e7/2bef9/sync.png 1024w,\n/static/96cfe914d2328b46be6cdbff91a0e5e7/71c1d/sync.png 1536w,\n/static/96cfe914d2328b46be6cdbff91a0e5e7/a2498/sync.png 1764w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>"}},"pageContext":{"id":"74829044-b14f-58cf-b1f2-3f81dd03c669"}},"staticQueryHashes":[],"slicesMap":{}}