{"componentChunkName":"component---src-templates-note-js","path":"/c-work-with-services","result":{"data":{"remark":{"fields":{"path":"c-work-with-services"},"meta":{"title":""},"headings":[{"value":"C# Work with Services"}],"html":"<h1>C# Work with Services</h1>\n<p>To work with services you need to add reference to <code class=\"language-text\">System.ServiceProccess</code></p>\n<h2>Example List Installed Services</h2>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\">ServiceController<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> services <span class=\"token operator\">=</span> ServiceController<span class=\"token punctuation\">.</span><span class=\"token function\">GetServices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">StringBuilder</span> sb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ServiceController</span> service <span class=\"token keyword\">in</span> services<span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span><span class=\"token function\">AppendLine</span><span class=\"token punctuation\">(</span>service<span class=\"token punctuation\">.</span>ServiceName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ntextBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> sb<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Example Restart Service</h2>\n<p><a href=\"http://www.csharp-examples.net/restart-windows-service/\">http://www.csharp-examples.net/restart-windows-service/</a></p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\">ServiceController</span> service <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ServiceController</span><span class=\"token punctuation\">(</span>serviceName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nservice<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nservice<span class=\"token punctuation\">.</span><span class=\"token function\">WaitForStatus</span><span class=\"token punctuation\">(</span>ServiceControllerStatus<span class=\"token punctuation\">.</span>Stopped<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nservice<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nservice<span class=\"token punctuation\">.</span><span class=\"token function\">WaitForStatus</span><span class=\"token punctuation\">(</span>ServiceControllerStatus<span class=\"token punctuation\">.</span>Running<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>To work with services you must have administrator privilegies so in manifest file change requestedExecutionLevel to:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>requestedExecutionLevel</span> <span class=\"token attr-name\">level</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>requireAdministrator<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">uiAccess</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>"}},"pageContext":{"id":"33ab1a71-35cd-5d06-a671-a45e79b82030"}},"staticQueryHashes":[]}