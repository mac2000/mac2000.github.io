{"componentChunkName":"component---src-templates-note-js","path":"/stackoverflow-api-powershell/","result":{"data":{"remark":{"fields":{"path":"stackoverflow-api-powershell"},"meta":{"title":""},"headings":[{"value":"StackOverflow PowerShell API Clien Sample"}],"html":"<h1>StackOverflow PowerShell API Clien Sample</h1>\n<p><a href=\"http://stackoverflow.com/\">Stack Overflow</a> you guys are awesome, thank you for being open!</p>\n<p>First of all there is <a href=\"http://data.stackexchange.com/\">StackExchange Data Explorer</a> which allow you to run SQL queries like <a href=\"http://data.stackexchange.com/stackoverflow/query/302668\">this</a> over Stack Overflows databases which is awesome!</p>\n<p>Second stuff is <a href=\"https://api.stackexchange.com/\">StackExchange API</a> which allows you to retrieve some interesting data via REST API.</p>\n<p>Here is example of such request and its response:</p>\n<p><a href=\"https://api.stackexchange.com/2.2/tags/synonyms?site=stackoverflow&#x26;pagesize=5\">https://api.stackexchange.com/2.2/tags/synonyms?site=stackoverflow&#x26;pagesize=5</a></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"items\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"creation_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1427427681</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"applied_count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"to_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"from_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"font-weight\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"creation_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1428794822</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"last_applied_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1429012623</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"applied_count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"to_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"javascript\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"from_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"javascript-library\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"creation_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1364923625</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"last_applied_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1429037717</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"applied_count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"to_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sql-like\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"from_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"like-operator\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"creation_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1428596908</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"last_applied_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1429223402</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"applied_count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"to_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"swift\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"from_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"swift1.2\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"creation_date\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1285959378</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"applied_count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"to_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"each\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"from_tag\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\".each\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"has_more\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"quota_max\"</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"quota_remaining\"</span><span class=\"token operator\">:</span> <span class=\"token number\">197</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To retrieve full list of synonyms (which can be later used in stuffs like ElasticSearch) you could use following script:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$body</span> = @<span class=\"token punctuation\">{</span>\n    site = <span class=\"token string\">'stackoverflow'</span>\n    pagesize = 100\n    page = 1\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">]</span> = <span class=\"token variable\">$key</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$items</span> = @<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'filter'</span><span class=\"token punctuation\">]</span> = <span class=\"token string\">'total'</span>\n<span class=\"token variable\">$response</span> = <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Uri <span class=\"token string\">\"https://api.stackexchange.com/2.2/tags/synonyms\"</span> <span class=\"token operator\">-</span>Body <span class=\"token variable\">$body</span>\n<span class=\"token variable\">$pages</span> = <span class=\"token variable\">$response</span><span class=\"token punctuation\">.</span>total <span class=\"token operator\">/</span> <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'pagesize'</span><span class=\"token punctuation\">]</span>\n<span class=\"token variable\">$body</span><span class=\"token punctuation\">.</span>Remove<span class=\"token punctuation\">(</span><span class=\"token string\">'filter'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">Write-Progress</span> <span class=\"token operator\">-</span>Activity <span class=\"token string\">'Retrieving page'</span> <span class=\"token operator\">-</span>Status <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span>PercentComplete <span class=\"token punctuation\">(</span> <span class=\"token namespace\">[Math]</span>::Min<span class=\"token punctuation\">(</span><span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token variable\">$pages</span> <span class=\"token operator\">*</span> 100<span class=\"token punctuation\">,</span> 100<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n    <span class=\"token variable\">$response</span> = <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Uri <span class=\"token string\">\"https://api.stackexchange.com/2.2/tags/synonyms\"</span> <span class=\"token operator\">-</span>Body <span class=\"token variable\">$body</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">+=</span> <span class=\"token variable\">$response</span><span class=\"token punctuation\">.</span>items\n    <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> 1\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">.</span>has_more<span class=\"token punctuation\">)</span>\n\n<span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 10 <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'From'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>from_tag<span class=\"token punctuation\">.</span>Replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">' '</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'To'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>to_tag<span class=\"token punctuation\">.</span>Replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">' '</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Which will produce output like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">From               To\n----               --\nfont weight        css\njavascript library javascript\nlike operator      sql like\nswift1.2           swift\n.each              each\ncolumn store index columnstore\nandroid ui         android\nuber               uber api\nelixir lang        elixir\ncss box model      css</code></pre></div>\n<p>While requesting API you should define site data from which you want to retrieve, to get list of available sites you can use something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$body</span> = @<span class=\"token punctuation\">{</span>\n    pagesize = 100\n    page = 1\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">]</span> = <span class=\"token variable\">$key</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$items</span> = @<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$response</span> = <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token operator\">-</span>Uri <span class=\"token string\">\"https://api.stackexchange.com/2.2/sites\"</span> <span class=\"token operator\">-</span>Body <span class=\"token variable\">$body</span>\n    <span class=\"token variable\">$items</span> <span class=\"token operator\">+=</span> <span class=\"token variable\">$response</span><span class=\"token punctuation\">.</span>items\n    <span class=\"token variable\">$body</span><span class=\"token punctuation\">[</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> 1\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">.</span>has_more<span class=\"token punctuation\">)</span>\n\n<span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> where site_type <span class=\"token operator\">-eq</span> <span class=\"token string\">'main_site'</span> <span class=\"token punctuation\">|</span> where site_state <span class=\"token operator\">-eq</span> <span class=\"token string\">'normal'</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> name<span class=\"token punctuation\">,</span> api_site_parameter<span class=\"token punctuation\">,</span> audience <span class=\"token punctuation\">|</span> <span class=\"token function\">ft</span> <span class=\"token operator\">-</span>AutoSize</code></pre></div>\n<p>Here is list of \"normal\" main (not meta) sites:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name                           api_site_parameter\n----                           ------------------\nStack Overflow                 stackoverflow\nServer Fault                   serverfault\nSuper User                     superuser\nMeta Stack Exchange            meta\nWeb Applications               webapps\nArqade                         gaming\nWebmasters                     webmasters\nSeasoned Advice                cooking\nGame Development               gamedev\nPhotography                    photo\nCross Validated                stats\nMathematics                    math\nHome Improvement               diy\nGeographic Information Systems gis\nTeX - LaTeX                    tex\nAsk Ubuntu                     askubuntu\nPersonal Finance &amp;amp; Money   money\nEnglish Language &amp;amp; Usage   english\nStack Apps                     stackapps\nUser Experience                ux\nUnix &amp;amp; Linux               unix\nWordPress Development          wordpress\nTheoretical Computer Science   cstheory\nAsk Different                  apple\nRole-playing Games             rpg\nBicycles                       bicycles\nProgrammers                    programmers\nElectrical Engineering         electronics\nAndroid Enthusiasts            android\nPhysics                        physics\nInformation Security           security\nGraphic Design                 graphicdesign\nDatabase Administrators        dba\nScience Fiction &amp;amp; Fantasy  scifi\nSkeptics                       skeptics\nDrupal Answers                 drupal\nSharePoint                     sharepoint\nMi Yodeya                      judaism\nTravel                         travel\nChristianity                   christianity\nMovies &amp;amp; TV                movies\nMathematica                    mathematica\nAcademia                       academia\nThe Workplace                  workplace\nSalesforce                     salesforce\nExpressionEngine&amp;#174; Answers expressionengine\nMathOverflow                   mathoverflow.net</code></pre></div>\n<p>To be able to make more requests you should <a href=\"http://stackapps.com/apps/oauth/register\">register</a> your app.</p>\n<p>Unfortunatelly there is not API for careers but there is <a href=\"http://careers.stackoverflow.com/jobs/feed\">feed</a> that contains interesting information, here is few samples what can be done:</p>\n<p>Firs of all we need retrieve feed itself and process it:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$xml</span> = <span class=\"token namespace\">[xml]</span><span class=\"token punctuation\">(</span><span class=\"token function\">Invoke-WebRequest</span> http:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>careers<span class=\"token punctuation\">.</span>stackoverflow<span class=\"token punctuation\">.</span>com/jobs/feed<span class=\"token punctuation\">)</span>\n\n<span class=\"token variable\">$items</span> = @<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span> in <span class=\"token variable\">$xml</span><span class=\"token punctuation\">.</span>rss<span class=\"token punctuation\">.</span>channel<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$parts</span> = <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>Substring<span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>LastIndexOf<span class=\"token punctuation\">(</span><span class=\"token string\">'('</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Trim<span class=\"token punctuation\">(</span>@<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'('</span><span class=\"token punctuation\">,</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Split<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token variable\">$city</span> = <span class=\"token variable\">$parts</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 1\n        <span class=\"token variable\">$region</span> = <span class=\"token variable\">$parts</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>Last 1\n\n        <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$category</span> in <span class=\"token variable\">$item</span><span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$el</span> = <span class=\"token function\">New-Object</span> psobject\n            <span class=\"token variable\">$el</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Add-Member</span> NoteProperty <span class=\"token string\">'City'</span> <span class=\"token variable\">$city</span><span class=\"token punctuation\">.</span>Trim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token variable\">$el</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Add-Member</span> NoteProperty <span class=\"token string\">'Region'</span> <span class=\"token variable\">$region</span><span class=\"token punctuation\">.</span>Trim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token variable\">$el</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Add-Member</span> NoteProperty <span class=\"token string\">'Category'</span> <span class=\"token variable\">$category</span>\n            <span class=\"token variable\">$items</span> <span class=\"token operator\">+=</span> <span class=\"token variable\">$el</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now we can get some aggregated data</p>\n<p><strong>Top 10 vacancies by region</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Group-Object</span> Region <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> Name<span class=\"token punctuation\">,</span> Count <span class=\"token punctuation\">|</span> <span class=\"token function\">Sort-Object</span> Count <span class=\"token operator\">-</span>Descending <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 10 <span class=\"token punctuation\">|</span> <span class=\"token function\">ft</span> <span class=\"token operator\">-</span>AutoSize</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Name          Count\n----          -----\nUK              512\nCA              479\nDeutschland     373\nallows remote   291\nNY              290\nNetherlands     195\nGermany         190\nWA              123\nCanada          114\nSweden           95</code></pre></div>\n<p><strong>Top 10 vacancies by category</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Group-Object</span> Category <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> Name<span class=\"token punctuation\">,</span> Count <span class=\"token punctuation\">|</span> <span class=\"token function\">Sort-Object</span> Count <span class=\"token operator\">-</span>Descending <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 10 <span class=\"token punctuation\">|</span> <span class=\"token function\">ft</span> <span class=\"token operator\">-</span>AutoSize</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Name       Count\n----       -----\njava         246\njavascript   223\npython       128\nc#           108\nphp          107\nc++          103\nsql           84\nlinux         79\nmysql         73\ncss           70</code></pre></div>\n<p><strong>Top 10 vacancies by both region and category</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Group-Object</span> Region<span class=\"token punctuation\">,</span> Category <span class=\"token punctuation\">|</span> <span class=\"token function\">Sort-Object</span> Count <span class=\"token operator\">-</span>Descending <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'Region'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span>0<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'Category'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span>1<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> Count <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 10 <span class=\"token punctuation\">|</span> <span class=\"token function\">ft</span> <span class=\"token operator\">-</span>AutoSize</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Region        Category   Count\n------        --------   -----\nUK            java          34\nUK            javascript    33\nCA            java          27\nCA            javascript    26\nNY            java          23\nDeutschland   java          23\nallows remote javascript    22\nCA            python        22\nUK            c#            20\nUK            php           20</code></pre></div>\n<p>Google Pie chart can be made from PowerShell with that piece of code:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$chart</span> = <span class=\"token variable\">$items</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Group-Object</span> Region <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> Name<span class=\"token punctuation\">,</span> Count <span class=\"token punctuation\">|</span> <span class=\"token function\">Sort-Object</span> Count <span class=\"token operator\">-</span>Descending <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>First 5\n<span class=\"token variable\">$chd</span> = <span class=\"token string\">'t:'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$chart</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>ExpandProperty Count<span class=\"token punctuation\">)</span> <span class=\"token operator\">-join</span> <span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n<span class=\"token variable\">$chl</span>=<span class=\"token punctuation\">(</span><span class=\"token variable\">$chart</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'Label'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Name <span class=\"token operator\">+</span> <span class=\"token string\">' - '</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Count <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> <span class=\"token operator\">-</span>ExpandProperty Label<span class=\"token punctuation\">)</span> <span class=\"token operator\">-join</span> <span class=\"token string\">'|'</span>\n<span class=\"token string\">\"https://chart.googleapis.com/chart?cht=p&amp;chs=600x200&amp;chd=<span class=\"token variable\">$chd</span>&amp;chl=<span class=\"token variable\">$chl</span>\"</span></code></pre></div>"}},"pageContext":{"id":"9058b848-8655-560c-b369-ee40e6c363eb"}},"staticQueryHashes":[],"slicesMap":{}}