{"componentChunkName":"component---src-templates-note-js","path":"/c-read-xslx/","result":{"data":{"remark":{"fields":{"path":"c-read-xslx"},"meta":{"title":""},"headings":[{"value":"c# read xslx"}],"html":"<h1>c# read xslx</h1>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> filePath <span class=\"token operator\">=</span> <span class=\"token string\">@\"C:\\Users\\AlexandrM\\Dropbox\\unon.com.ua\\boilers.xlsx\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> conStr <span class=\"token operator\">=</span> <span class=\"token string\">\"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\"</span> <span class=\"token operator\">+</span> filePath <span class=\"token operator\">+</span> <span class=\"token string\">\"; Extended Properties=\\\"Excel 12.0 Xml; HDR=YES\\\";\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">OleDbConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OleDbConnection</span><span class=\"token punctuation\">(</span>conStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">OleDbCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OleDbCommand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncmd<span class=\"token punctuation\">.</span>Connection <span class=\"token operator\">=</span> con<span class=\"token punctuation\">;</span>\ncon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> con<span class=\"token punctuation\">.</span><span class=\"token function\">GetOleDbSchemaTable</span><span class=\"token punctuation\">(</span>OleDbSchemaGuid<span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SheetName <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"TABLE_NAME\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">DataSet</span> ds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">OleDbDataAdapter</span> da <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OleDbDataAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncmd<span class=\"token punctuation\">.</span>CommandText <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM [\"</span> <span class=\"token operator\">+</span> SheetName <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">;</span>\nda<span class=\"token punctuation\">.</span>SelectCommand <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">;</span>\nda<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ndataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> ds<span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\ncon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>"}},"pageContext":{"id":"8fd3eb7a-672d-5c03-a686-d31d2aa30fa2"}},"staticQueryHashes":[],"slicesMap":{}}