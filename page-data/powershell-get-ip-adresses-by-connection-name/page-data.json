{"componentChunkName":"component---src-templates-note-js","path":"/powershell-get-ip-adresses-by-connection-name","result":{"data":{"remark":{"fields":{"path":"powershell-get-ip-adresses-by-connection-name"},"meta":{"title":""},"headings":[{"value":"PowerShell get ip adresses by connection name"}],"html":"<h1>PowerShell get ip adresses by connection name</h1>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$connection_name</span> = <span class=\"token string\">\"lan\"</span>\n\n<span class=\"token variable\">$index</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">gwmi</span> <span class=\"token operator\">-</span>query <span class=\"token string\">\"SELECT Index FROM Win32_NetworkAdapter WHERE NetConnectionID='<span class=\"token variable\">$connection_name</span>'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Index\n<span class=\"token variable\">$ipaddresses</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">gwmi</span> <span class=\"token operator\">-</span>query <span class=\"token string\">\"SELECT IPAddress FROM Win32_NetworkAdapterConfiguration WHERE Index=<span class=\"token variable\">$index</span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>IPAddress\n<span class=\"token variable\">$ipaddresses</span> <span class=\"token punctuation\">|</span> <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">{</span> <span class=\"token variable\">$_</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>or even better to retrive only ipv4</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$connection_name</span> = <span class=\"token string\">\"lan\"</span>\n<span class=\"token variable\">$index</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">gwmi</span> <span class=\"token operator\">-</span>query <span class=\"token string\">\"SELECT Index FROM Win32_NetworkAdapter WHERE NetConnectionID='<span class=\"token variable\">$connection_name</span>'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Index\n<span class=\"token variable\">$ip</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">gwmi</span> <span class=\"token operator\">-</span>query <span class=\"token string\">\"SELECT IPAddress FROM Win32_NetworkAdapterConfiguration WHERE Index=<span class=\"token variable\">$index</span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>IPAddress <span class=\"token punctuation\">|</span> <span class=\"token function\">select-string</span> <span class=\"token operator\">-</span>Pattern <span class=\"token string\">'[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+'</span>\n<span class=\"token variable\">$ip</span></code></pre></div>"}},"pageContext":{"id":"e74ea98a-38e0-5ab8-b654-190dbd38b9b7"}},"staticQueryHashes":[]}