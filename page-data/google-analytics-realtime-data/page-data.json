{"componentChunkName":"component---src-templates-note-js","path":"/google-analytics-realtime-data/","result":{"data":{"remark":{"fields":{"path":"google-analytics-realtime-data"},"meta":{"title":""},"headings":[{"value":"Google Analytics RealTime Data"}],"html":"<h1>Google Analytics RealTime Data</h1>\n<p>Task is to monitor google analytics realtime active visitors counter</p>\n<p><a href=\"https://developers.google.com/api-client-library/php/\">https://developers.google.com/api-client-library/php/</a> - php client library</p>\n<p><a href=\"https://packagist.org/packages/google/apiclient\">https://packagist.org/packages/google/apiclient</a> - packagist</p>\n<p><a href=\"http://ga-dev-tools.appspot.com/explorer/\">http://ga-dev-tools.appspot.com/explorer/</a> - query builder</p>\n<p><a href=\"https://developers.google.com/apis-explorer/#p/analytics/v3/analytics.data.realtime.get\">https://developers.google.com/apis-explorer/#p/analytics/v3/analytics.data.realtime.get</a> - realtime analytics query builder</p>\n<p><a href=\"https://developers.google.com/analytics/devguides/reporting/realtime/dimsmets/\">https://developers.google.com/analytics/devguides/reporting/realtime/dimsmets/</a> - realtime metrics and dimensions</p>\n<p><a href=\"https://console.developers.google.com/project\">https://console.developers.google.com/project</a> - developers console, you need create project here and turn on analytics API. After that you will be able to create your <strong>Service Account</strong> and get your certificate file. Also <strong>do not forget</strong> to add given service account email address to your analytics account, otherwise you will not have access.</p>\n<p>And here is working example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">require_once</span> <span class=\"token string single-quoted-string\">'vendor/autoload.php'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Google_Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$client</span><span class=\"token operator\">-></span><span class=\"token function\">setApplicationName</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'RabotaUA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// your project name on google developers console</span>\n\n<span class=\"token variable\">$client</span><span class=\"token operator\">-></span><span class=\"token function\">setAssertionCredentials</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">Google_Auth_AssertionCredentials</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string single-quoted-string\">'********************************************@developer.gserviceaccount.com'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// email you added to GA</span>\n        <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'https://www.googleapis.com/auth/analytics.readonly'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__DIR__</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/****************************************-privatekey.p12'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// keyfile you downloaded</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$client</span><span class=\"token operator\">-></span><span class=\"token function\">setClientId</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'********************************************.apps.googleusercontent.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// client id from API console</span>\n<span class=\"token variable\">$client</span><span class=\"token operator\">-></span><span class=\"token function\">setAccessType</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'offline_access'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// this may be unnecessary?</span>\n\n<span class=\"token variable\">$service</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Google_Service_Analytics</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$client</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$service</span><span class=\"token operator\">-></span><span class=\"token property\">data_realtime</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ga:*******'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'rt:activeVisitors'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'fields'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'rows'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$activeVisitors</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$results</span><span class=\"token operator\">-></span><span class=\"token property\">rows</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$activeVisitors</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2356</span></span></code></pre></div>\n<p>'ga:<strong>***</strong>' - can be found under Administrator\\View settings (3d column)</p>"}},"pageContext":{"id":"7181ca8b-8e2c-5472-a859-8b55ed0ae3b4"}},"staticQueryHashes":[],"slicesMap":{}}