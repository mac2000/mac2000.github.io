{"componentChunkName":"component---src-templates-note-js","path":"/powershell-parse-rss/","result":{"data":{"remark":{"fields":{"path":"powershell-parse-rss"},"meta":{"title":""},"headings":[{"value":"PowerShell parse RSS"}],"html":"<h1>PowerShell parse RSS</h1>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$URL</span> = <span class=\"token string\">\"http://hh.ua/employer.do?showRss=1&amp;employerId=\"</span>\n\ncls\n<span class=\"token variable\">$wc</span> = <span class=\"token function\">new-object</span> net<span class=\"token punctuation\">.</span>webclient\n<span class=\"token variable\">$wc</span><span class=\"token punctuation\">.</span>Encoding = <span class=\"token namespace\">[Text.Encoding]</span>::UTF8\n\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> = 1<span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-lt</span> 423153<span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$ID</span> = <span class=\"token variable\">$i</span>\n    <span class=\"token variable\">$rss</span> = <span class=\"token variable\">$url</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$id</span>\n    <span class=\"token variable\">$x</span> = <span class=\"token namespace\">[xml]</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$wc</span><span class=\"token punctuation\">.</span>DownloadString<span class=\"token punctuation\">(</span><span class=\"token variable\">$rss</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token variable\">$companyName</span> = <span class=\"token punctuation\">(</span><span class=\"token namespace\">[string]</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">.</span>rss<span class=\"token punctuation\">.</span>channel<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"HeadHunter Vacancies - \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token variable\">$companyName</span>\n    <span class=\"token variable\">$f</span> = <span class=\"token punctuation\">(</span><span class=\"token string\">\"C:\\Users\\mac\\Desktop\\res\\\"</span><span class=\"token operator\">+</span><span class=\"token variable\">$ID</span><span class=\"token operator\">+</span><span class=\"token string\">\".csv\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token variable\">$x</span><span class=\"token punctuation\">.</span>rss<span class=\"token punctuation\">.</span>channel<span class=\"token punctuation\">.</span>item <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> pubDate<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> link<span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$companyName</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> Label=<span class=\"token string\">\"companyName\"</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">export-csv</span> <span class=\"token operator\">-</span>Encoding UTF8 <span class=\"token operator\">-</span>NoTypeInformation <span class=\"token variable\">$f</span>\n<span class=\"token punctuation\">}</span></code></pre></div>"}},"pageContext":{"id":"c21074f8-09d5-56c1-8465-2e6a34164d03"}},"staticQueryHashes":[],"slicesMap":{}}