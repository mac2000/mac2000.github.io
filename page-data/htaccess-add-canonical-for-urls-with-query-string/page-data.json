{"componentChunkName":"component---src-templates-note-js","path":"/htaccess-add-canonical-for-urls-with-query-string","result":{"data":{"remark":{"fields":{"path":"htaccess-add-canonical-for-urls-with-query-string"},"meta":{"title":""},"headings":[{"value":"Automatically add canonical header for urls with non empty query strings"}],"html":"<h1>Automatically add canonical header for urls with non empty query strings</h1>\n<p>Suppose we have simple html site and we still wish to use canonicals for our pages so Google can index them correct.</p>\n<p>But here is tricky part - how could we automate adding canonicals for pages?</p>\n<p>Seems that google undestands special <code class=\"language-text\">Link</code> header for canonicals - <a href=\"https://support.google.com/webmasters/answer/139066?hl=en#6\">https://support.google.com/webmasters/answer/139066?hl=en#6</a></p>\n<p>Here is what I end up with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># If non empty query string add Canonical header\nRewriteCond %{QUERY_STRING} ^.+$ [NC]\nSetEnvIf Host (.*) HOSTNAME=$1\nSetEnvIf Request_URI (.*) URI=$1\nRewriteRule .* - [E=SET_CANONICAL_HEADER:1]\nHeader set Link \"&lt;http://%{HOSTNAME}e%{URI}e>; rel=\\\"canonical\\\"\" env=SET_CANONICAL_HEADER</code></pre></div>\n<p>So we have non empty query string rewrite condition in first line.</p>\n<p>Two next lines with <code class=\"language-text\">SetEnvIf</code> is needed just to duplicate apache variables into environment variables.</p>\n<p>Our rewrite rule do nothing except setting <code class=\"language-text\">SET_CANONICAL_HEADER</code> into <code class=\"language-text\">1</code> only if rewrite condition met.</p>\n<p>And if so we are setting header to exactly same url but without query string.</p>"}},"pageContext":{"id":"a564c6f8-8f95-5420-aa62-eabf57b19181"}},"staticQueryHashes":[]}