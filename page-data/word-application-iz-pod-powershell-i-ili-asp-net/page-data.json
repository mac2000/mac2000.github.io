{"componentChunkName":"component---src-templates-note-js","path":"/word-application-iz-pod-powershell-i-ili-asp-net/","result":{"data":{"remark":{"fields":{"path":"word-application-iz-pod-powershell-i-ili-asp-net"},"meta":{"title":""},"headings":[{"value":"Word.Application из под Powershell и/или Asp.Net"}],"html":"<h1>Word.Application из под Powershell и/или Asp.Net</h1>\n<p>Если написать простенькую программку или скрипт которая будет что либо делать с word'ом или любым другим продуктом из пакета Microsoft Office - все будет работать ровно до тех пор пока мы не попытаемся вызвать труды нашей работы из под asp.net или другого скритпа, или триггера или шедаллера.</p>\n<p>Дело в том что все это добро работает нормально только если запущенно вручную из под вашей учетной записи, иначе просто напросто отваливается, по причине того что офис не может работать вне окружения пользователя.</p>\n<p>С горем по полам нашел следующие ссылки:</p>\n<p><a href=\"http://theether.net/download/Microsoft/kb/288368.html\">http://theether.net/download/Microsoft/kb/288368.html</a></p>\n<p><a href=\"http://theether.net/download/Microsoft/kb/288366.html\">http://theether.net/download/Microsoft/kb/288366.html</a></p>\n<p>Идея в следующем - нам необходимо подправить настройки com объекта word'а чтобы он всегда запускался с определенной учетной записью.</p>\n<p>Запускаем: <strong>DCOMCNFG.exe</strong></p>\n<p>Службы компонентов\\Компьютеры\\Мой компьютер\\Настройка DCOM\\ и тут самое интересное - ищем среди всего этого бардака нужный нам word.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c5987fcac361cf84b6544cddad705a42/e45a9/128.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.765625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACTUlEQVR42l2S627aQBCFef/n6K+2UqpW6UVUJFFIaAqJwYCxvfau7wanoCRcDBT4KtspTTN/RjPSfnP2zNT0/hBNN6k32miDiOYPi/pZh8vWkK4Rc9HU6VspzdaAtqboGSGNizvOmj0sNcUNnxD+I8Iv8gO1W13QaPZpXOpogwHn19/58OWKVsdA6yu6fcFJXfLuVOfTt3OuftrcaC5v3p5zctrm7MrhtN7j/cdrWh1JzRACx3EwRYTnCRyhow8tHBkQJRlJmmGIMT3DwxIurozxwzGd2z43bZ3hSHHXHdG6ucUwXWqW20OKS0ZDE9uWeCrAk5LAD8hXK5bLBes8p4rDi3zg8FzO508o5bHdbqkF8ZjpdErgDbGNLpqmMTIMBnofvdfHNC2CIPrH+os8HNjvq2aW3aN1u6zynFoyHpfNx2nALNYYGgrbFAjLRjqSzWbLdrs5qnkNLWKxWOD7HmEUUwsmWdnc73ekkxkjMySQIzzl4RaeCQfbslksV6xWq6Oql7Fer4njmM1mQ81S4XFaMXA9T8mzaxzhoVwXRzj4SpVZuuqo6jUwip6BIkyPwN0e5g8TFlkPXwmk45SgQq2wTLLJPbvd71JpnuflsgpIUR+Bbjypvnw4HLe4mk8JBl/xPb88KWFX6jwly7qwwLEF5shESUkShsRxUgHDdPKfwUUsn+5R+ufydEzDKL0Utl0+FrYogUrJ0pJicb70SJK0Aqpo/AJYQfPFDH/wjSAMiKKIMIgIw6gEFkqUVNi2TRonxGHE9NeMJK2AfwB/rHOOIEwGkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/c5987fcac361cf84b6544cddad705a42/e45a9/128.png\"\n        srcset=\"/static/c5987fcac361cf84b6544cddad705a42/6f3f2/128.png 256w,\n/static/c5987fcac361cf84b6544cddad705a42/e45a9/128.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>У меня на машине стоить Microsoft Office 2010 - но ворд нашел как: <strong>Документ Microsoft Word 97-2003</strong></p>\n<p>В англоязычной системе все может быть совсем наоборот, и что еще более важно - названия может не быть вообще - вместо него может быть соотв. guid.</p>\n<p>Для того чтобы наверняка вычислить тот ли объект мы редактируем идем в <strong>regedit.exe</strong> и ищем <strong>winword.exe</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 774px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9238c176846144730c39a64a1e37ead7/41d3b/215.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.734375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+klEQVR42q2TfU/aUBSH+/0/zOYcKm7ZMtkYanlRGFCBFmgLhVp621JeKm2fpdXJEs2yTX/Jk5Nz/3hyX86VzuQO5UaPz3KPN2cdCucaRxdDDsp9CufDR05kndOayYeayadri2LN4P25xklV57CicVo3+dK0kMbDNu1OH03TmU5mTCwbReljTubcLnwWYpljWreIYJ0z1AyMoYkzc3ICN8AXS3wvRHJnDQZ9FU1VEa5LtF5j33SxFIWlNeVOCHaewOx2ufMErFeM2220Vgu928Xs9bgdjXBUldg0kJxZE6WjIBaCLCshCAwTlgFpEIDvg+ftq+eR+gFpGD4S+z5xEJBGEdJi1qSn9LFtmzRN2Wy3LMNVLk+ThJRnkqZPeYgk5i16NwMmk0m+ngnDX8L0Wd0fI7l2JrzfYZbNZkMYhv8vdKwrBgONbRS9jjC7w25HQR/rxHHMNj/yC4UjbYw9n7Pb7V5HeJMNsmESRdHLhe68lQs1VctFryLUBhrWdIphmDiOQ7jaz+E/C6dKmcuvMoaq//bKT+fwb/cqDSslah9LjCoyfr+Po+u4us5WCCI/ILmLSeKEJHkgTvZ9vCf/VUmC9O3giPLbd1SOi5QKJ5QKRUpHRc7eHvL98Jha9ZrqdYfKRR253qLa+JHXy1oTuXHfZ1QuG9Sv2vwEfWDCVT9tbl0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/9238c176846144730c39a64a1e37ead7/41d3b/215.png\"\n        srcset=\"/static/9238c176846144730c39a64a1e37ead7/6f3f2/215.png 256w,\n/static/9238c176846144730c39a64a1e37ead7/01e7c/215.png 512w,\n/static/9238c176846144730c39a64a1e37ead7/41d3b/215.png 774w\"\n        sizes=\"(max-width: 774px) 100vw, 774px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 858px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b52be4974058773fc47e66ff40a36b9d/42d54/37.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.703125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACwUlEQVR42lWR2VIjRxBF9f9/4wc/2OPxjDGgBVq9d3UtvUtCQoAGqSWgJTiOLozxVERGZWVFnLh57+DS01x4GV+HEd/cim/hLb+OS353F/wZrvnDX3KW3HOebmz1/1/9pa3v0Zqh2jCWK84vPEZfzhgMgxwvFFxOAmJRcjFRTByBH5VMpobRVYLKVwh9gzRLsuqOrLonr+/RxRqZrZDmhny2QS+2DJpZwbwpmM8W3K5uSfwJmTFUZUWRFxRFQdPMiMIImaZUVW1nSim220fmNyt++XLJb3+7XCc1g/3hwP16QRp75HmJ9M+YXl8R+CFhEOC5PnVV43u+nfVgx3HwPJ+Xl462PXC32bFc/2D1sGOwbQ/AG/MiwGiNjkbEYUie5VapTCWL+Zw4ijEmIzMZaSLsvHvp2O/3HI9H+vO4f2aw2z/Zx91CUZcZOhoSeh5xlFg1vh/Q1I3twyAkiRPc6ZTACzidTrRtS9d1lvGwe/oErpoYLRN0NEaKhCzP0UqTppJZ06CksuoybSxUSc3p9GqBHwrbp+5jZbibS+qqIPXPCVwXIVK7ZhSENqDA8xGJIIljQj/AuXZo2z2Hw57uX+Du0DFoD8/2cX+jqKvceqhSYdUYbdBKMZ/N0VJhjLHzPu1UpDaU/3vYPh8/gav6feVeYeh7FiTihMAPKIvSKu2D6FV6UxfP9Xh6ev4JuD28fALfQ8nR8ZhECExeIJVGSEUzm5P2CrMcbQwiTcmKkte3t588fNy/fIayngkKo1HX35GOQx4lKN+nUZplXhCOJwhnSnzl4F4Mka4Hb29sd7v/UrYe/tju3iNfZtS5obr+i2IypvE86umUbVnyWJZkkwml49C4HmY4Qg9HvHYdD5sNx+4j5SODiRMQhAmJUERxSixShMpspSojkcb2/R0JRZhIe/elTW9Lhs5K8qImTjP+Aa/U9lRP/jIKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/b52be4974058773fc47e66ff40a36b9d/42d54/37.png\"\n        srcset=\"/static/b52be4974058773fc47e66ff40a36b9d/6f3f2/37.png 256w,\n/static/b52be4974058773fc47e66ff40a36b9d/01e7c/37.png 512w,\n/static/b52be4974058773fc47e66ff40a36b9d/42d54/37.png 858w\"\n        sizes=\"(max-width: 858px) 100vw, 858px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Ну и естественно в туле нет никаких фильтров либо возможности поиска, так что придеться все перелопачивать вручную.</p>\n<p>Теперь необходимо настроить свойства этого объекта.</p>\n<p>Первое что необходимо это разрешить доступ к объекту из нужной нам учетной записи (в моем случае это была сетевая служба)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 721px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1720b8a37c8e8d0c69f6f2452e0f447f/01dae/46.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.296875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADO0lEQVR42mWT6W7jRhCE9f6vECAvkF9JdhFnjXh9LCRZsq2bokQdFE9RJCXeEsXjC4aOg92kgMYAA0xNVVd3a+846LrObLllIqsMpwovAxl5bbDRXMYLlf5swWyjIqk7JFVF2u2QdxqKZWPHCap/ZK4ZTbXWqxWWrtF5m/L8OqP7/Mz9Y4+ptOLuaczXzhRV0xhNpgzHEyR5wUJZoaw3aIaJvFQYjsZYewfDcWh960+47464eWzzx8Mzv9/1uGnPeBquuf18w93PPzF4G6BpGra9x7ZthAh1q3I+n7nmOUEQUJYl/imgtTEcjEOAfUwwvQh1f2Rt+mxtH8N2UVYqg4mE5/lYpkUcxxRFweWS84G6rpvTPZ5oOeYOx1Axt0uSwAUKIKeuxYOSUxAwnS9Jk5QwjH4gELhcLnieR57neKeQ1i/tLb8NT9zKGb9OM/5cw41SN/VZgcE2YLmQSdOMJElIk4SyqqjqqiGuqqqxK9AQ3g223A117scmt0OLTz2NL0ObF+2C5MPSODGaSDjOAcuyiKKI/+JDsR+EtIrrmTJPKa8ZdXHmdDCJ/D1FFnGJPFzXZSgpRHGM55+ovrMrIKz6vk9+vb4rPBxcwigmCGOOp5Dlao1h2jgHF820MGWF8fMrpCllFFGcjlzjmGtRIKiF/Uv+HpAnFMpzGdf1yLKMNE2bHy3LblJ1PQ97q/LWH+DqOvpGxd07RHuHQDeozmfh91/L3jGgpWt6QyjG4QNxIoiv5CLBIOS198ZxvcZdLqmyTERLnSRgGMSqyno6I9Z1fNOiJcirqqYs/0mtrhsbogQc12c0XUCWUgQBdZ5TFwWVSFY4OhwITIvieMQ7+LTmksRKTP5m22xDGAQkccRquWw2YquKPd/8b/6+T/jj/ih6OFVMFuoedR9i+Qn74ILqZ2heTFlc8f0Tnf6QKAzwohw3LvCSkkNUUpT1Dx95H6u31h0U1WS1s3iRVb70prQnCt3+C4+dPv3hrCGP04w4PTfNFxWEEb733n8Rqrl3aY0mM95GEx6e2jw8fKPT7dHt9mi3n2m3O/z19ZHBaIxtWRimiWEYzOdzpPkcWZYZjEYoqxWbzbYZub8BljKlmCs47DcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/1720b8a37c8e8d0c69f6f2452e0f447f/01dae/46.png\"\n        srcset=\"/static/1720b8a37c8e8d0c69f6f2452e0f447f/6f3f2/46.png 256w,\n/static/1720b8a37c8e8d0c69f6f2452e0f447f/01e7c/46.png 512w,\n/static/1720b8a37c8e8d0c69f6f2452e0f447f/01dae/46.png 721w\"\n        sizes=\"(max-width: 721px) 100vw, 721px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Далее необходимо настроить запуск объекта из под необходимой нам учетной записи</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 410px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63f7f5dee9475d15a9765f2c3d26c533/d68e4/55.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 136.328125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD0klEQVR42q2WWW/bVhCF+ff71D/QPuYlLpA+BHXRxEjtOk1i2VJEKaJFiRKXy30TtYui9BW8lhclRVukGWDAISGee87MubxSfn2r8vK8yW/vOvxyofLi9TUvL7qcvGrw/KzJ89ctnp1e8/y1yslZi58udH5uBJy2Ql61A16cq5w+O+Hy++/444cfUa7UIaYI6GhD1N6AoeWhmx79sYuqGTTUPh+aPa4+atyOBN2+iW76qNoI9XZEq6vzsTfkduzQGzooN6qG7wo6qsrvb97QvLmhq6p01DafOirN6waNqw+MDIPZtCDwfcyRwfXVe/68vKTVbOIKwXQywRI+SlsbkmUZ+aTA8310fYA+GMp0PZ8sz0nSjO12Sx31tf59lmbEccxsNuc+vDBBGTkhnhConS56X2c8HuN5Pr7v4wcBtm1jWTau6+I4AuE4eK6HEC5JmrLb7djv9xIwiDMUfSyYzWYEQUgYhExnM/4x9nsJ8DTvw49TlLHtstmsybOcNEmlnPpaM0zT7OiFf4soOTDcrNekaUoUxRIwiRPCMCTNMrbllj3/DTSsARudAfuqlAC1ZM/zCMOYJE7xPR/bslmuVge1+88Y38u+u3OjDOXj7ZismBInKXEUS6b1VAM/wPcD5vPF37TxGPi+8uIcpa3brDcrTNPGMEYMBgOiKGI6ncpe6v0BwnElc9uy8LxAWqcsS3zPo9/vSwcsFvMDw74N7AhrdlnGZDJhvd7IFWtLhFEkB1S3xPc9gjBiU5YyayBN0zBNi/l8hhflNaAlAR3hkueTIwlVtZVedIRAuOLgRYfVai0Xe+IkGU6QoKgDIQHrCQeeL80bhtFhV5QI18W0LCy7TlvWy+WSqqoeernb7R+H0jFcyWkyKSiKu1wuH6da14vFgsVyKYHquqp3x9Gsj4biUFWlHEJRTJkUhazzPJc5lfcz+ayusyw/kvtUsggfJMO2qijLrZzgUVbVF88+3z33d1JyzfDpKl8TjwxTFPVbAD7tYUsbPwzg/wK6NWB3KL4ZQwmo6vY366E0dvsAWJvza2U/AsYovbFHkWfyDLEtEzeaoHlrVGeJHq7p+ys6zoK2s8RMNo/93n8pWYS1bQYO+13FelOy2ZQPG/8ut2ykF3eU8guzPWy5uw/Hg2+rit2uwglSlOuuzma1pJgWzGbTh5zPpqSTAiNM6Romt47POEzxhEOv9wnDMEiThCSO746LJGbseCinb94h/IihKRhZLiPbxbBc6rNGMxzO231OL685a3R5/8ngptXh7PwtF28/0NF0erqB2tPRBvWfAp2/AHJ1AzpDquycAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/63f7f5dee9475d15a9765f2c3d26c533/d68e4/55.png\"\n        srcset=\"/static/63f7f5dee9475d15a9765f2c3d26c533/6f3f2/55.png 256w,\n/static/63f7f5dee9475d15a9765f2c3d26c533/d68e4/55.png 410w\"\n        sizes=\"(max-width: 410px) 100vw, 410px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Логично что запись должна существовать, так же было бы не плохо под ней залогиниться и запустить ворд чтобы тот в свою очередь проинициализировался и сделал все свои темные дела.</p>\n<p>Все, после этих манипуляций можно дергать ворд из asp.net или powershell да в принципе из чего угодно.</p>\n<p>Записи в реестре могут жить в таких местах:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HKEY_CLASSES_ROOT\\AppID\\WINWORD.EXE[@AppID]\nHKEY_CLASSES_ROOT\\Wow6432Node\\AppID\\WINWORD.EXE[@AppID]\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\WINWORD.EXE[@AppID]\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Wow6432Node\\AppID\\WINWORD.EXE[@AppID]\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Classes\\AppID\\WINWORD.EXE[@AppID]</code></pre></div>"}},"pageContext":{"id":"16bdd568-3a16-59ef-8bad-ec79d537f5b8"}},"staticQueryHashes":[],"slicesMap":{}}