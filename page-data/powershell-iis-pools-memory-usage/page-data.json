{"componentChunkName":"component---src-templates-note-js","path":"/powershell-iis-pools-memory-usage","result":{"data":{"remark":{"fields":{"path":"powershell-iis-pools-memory-usage"},"meta":{"title":""},"headings":[{"value":"PowerShell List Memory Usage by IIS Application Pools"}],"html":"<h1>PowerShell List Memory Usage by IIS Application Pools</h1>\n<p>Following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">gwmi</span> <span class=\"token operator\">-</span>ComputerName SRV01<span class=\"token punctuation\">,</span> SRV02<span class=\"token punctuation\">,</span> SRV03<span class=\"token punctuation\">,</span> SRV04 <span class=\"token operator\">-</span>NS <span class=\"token string\">'root\\WebAdministration'</span> <span class=\"token operator\">-</span><span class=\"token keyword\">class</span> <span class=\"token string\">'WorkerProcess'</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">select</span> PSComputerName<span class=\"token punctuation\">,</span> AppPoolName<span class=\"token punctuation\">,</span>ProcessId <span class=\"token punctuation\">,</span> @<span class=\"token punctuation\">{</span>n=<span class=\"token string\">'RAM'</span><span class=\"token punctuation\">;</span>e=<span class=\"token punctuation\">{</span> <span class=\"token namespace\">[math]</span>::round<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">Get-Process</span> <span class=\"token operator\">-</span>Id <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>ProcessId <span class=\"token operator\">-</span>ComputerName <span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>PSComputerName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>WorkingSet <span class=\"token operator\">/</span> 1Mb<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">sort</span> RAM <span class=\"token operator\">-</span>Descending <span class=\"token punctuation\">|</span> <span class=\"token function\">ft</span> <span class=\"token operator\">-</span>AutoSize</code></pre></div>\n<p>Will show iis pools on servers and their memory usage:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PSComputerName AppPoolName             ProcessId  RAM\n-------------- -----------             ---------  ---\nSRV01          RabotaUA 2.0 CMS              376 1443\nSRV03          RabotaUA2 Admin             11616 1421\nSRV01          RabotaUA 2.0 CMS            13084 1371\nSRV02          RabotaUA 2.0                 4564 1260\nSRV02          RabotaUA 2.0                11964 1250\nSRV02          RabotaUA 2.0                 6044 1245\nSRV02          RabotaUA 2.0                 7112 1235\nSRV02          RabotaUA 2.0                20352 1173\nSRV01          RabotaUA 2.0                13868 1051\nSRV01          RabotaUA 2.0                15568 1037\nSRV01          RabotaUA 2.0                10180 1018\nSRV01          RabotaUA 2.0                13480  997\nSRV02          RabotaUA 2.0                19136  964\nSRV02          RabotaUA 2.0 SubPortals      1560  935\nSRV01          RabotaUA 2.0                 2424  920\nSRV02          RabotaUA 2.0 Admin           5724  806\nSRV01          RabotaUA 2.0                11960  781\nSRV02          ReportServer                15188  726\nSRV02          RabotaUA 2.0 Admin           9468  559\nSRV01          RabotaUA 2.0 SubPortals      2752  234\nSRV01          RabotaUA 2.0 Admin          11096   81\nSRV03          RabotaUA2 Admin              9816   51\nSRV03          img1                         4944   49\nSRV03          js                          10448   30\nSRV03          img2                        14552   27\nSRV03          css                          8440   25</code></pre></div>"}},"pageContext":{"id":"3cbf0ecb-3272-59a6-af9b-75c551e87ce0"}},"staticQueryHashes":[]}