{"componentChunkName":"component---src-templates-note-js","path":"/docker-elasticsearch-with-kibana/","result":{"data":{"remark":{"fields":{"path":"docker-elasticsearch-with-kibana"},"meta":{"title":""},"headings":[{"value":"docker elasticsearch with kibana"}],"html":"<h1>docker elasticsearch with kibana</h1>\n<p><strong>docker-compose.yml</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">elasticsearch</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> docker.elastic.co/elasticsearch/elasticsearch<span class=\"token punctuation\">:</span>7.6.0\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> elasticsearch\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> discovery.type=single<span class=\"token punctuation\">-</span>node\n      <span class=\"token punctuation\">-</span> cluster.name=elastic\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./data<span class=\"token punctuation\">:</span>/usr/share/elasticsearch/data\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 9200<span class=\"token punctuation\">:</span><span class=\"token number\">9200</span>\n  <span class=\"token key atrule\">kibana</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> docker.elastic.co/kibana/kibana<span class=\"token punctuation\">:</span>7.6.0\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> kibana\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 5601<span class=\"token punctuation\">:</span><span class=\"token number\">5601</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker-compose</span> up</code></pre></div>\n<p>Make sure that: you are running commend in a folder with <code class=\"language-text\">docker-compose.yml</code> and <code class=\"language-text\">data</code> dir</p>\n<h2>Foreground stateless</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>elasticsearch <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9200</span>:9200 <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"discovery.type=single-node\"</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"cluster.name=elastic\"</span> docker.elastic.co/elasticsearch/elasticsearch:7.6.0\n\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-it</span> <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>kibana <span class=\"token parameter variable\">-p</span> <span class=\"token number\">5601</span>:5601 <span class=\"token parameter variable\">--link</span> elasticsearch docker.elastic.co/kibana/kibana:7.6.0</code></pre></div>\n<h2>Background statefull</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>elasticsearch <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9200</span>:9200 <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"discovery.type=single-node\"</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"cluster.name=elastic\"</span> <span class=\"token parameter variable\">-v</span> D:/OneDrive/Desktop/es7/data:/usr/share/elasticsearch/data docker.elastic.co/elasticsearch/elasticsearch:7.6.0\n\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>kibana <span class=\"token parameter variable\">-p</span> <span class=\"token number\">5601</span>:5601 <span class=\"token parameter variable\">--link</span> elasticsearch docker.elastic.co/kibana/kibana:7.6.0</code></pre></div>\n<p>Do not forget to change volume path in first command</p>\n<h2>Logs</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> logs elasticsearch <span class=\"token parameter variable\">-f</span>\n<span class=\"token function\">docker</span> logs kibana <span class=\"token parameter variable\">-f</span></code></pre></div>\n<h2>Cleanup</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> stop elasticsearch\n<span class=\"token function\">docker</span> stop kibana\n<span class=\"token function\">docker</span> <span class=\"token function\">rm</span> elasticsearch\n<span class=\"token function\">docker</span> <span class=\"token function\">rm</span> kibana</code></pre></div>\n<h2>Versions</h2>\n<ul>\n<li>6.5.4 - cloud.elastic</li>\n<li>7.6.0 - colocall.com</li>\n</ul>\n<h2>Run second 7.x elastic side by side with first 6.x on same VM</h2>\n<p>In our case we had elasticsearch 6.x on 192.168.5.101 and decided to run 7.x side by side for experiments, to do so:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /es760_data\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> g+w /es760_data\n\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>es760 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9760</span>:9200 <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"discovery.type=single-node\"</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"cluster.name=es760\"</span> <span class=\"token parameter variable\">-v</span> /es760_data:/usr/share/elasticsearch/data docker.elastic.co/elasticsearch/elasticsearch:7.6.0\n\n<span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>kibana760 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">5760</span>:5601 <span class=\"token parameter variable\">--link</span> es760:elasticsearch docker.elastic.co/kibana/kibana:7.6.0</code></pre></div>\n<p>Making data directory and changing its permission is vm specific here, the main point is to change names and ports for everything to work</p>"}},"pageContext":{"id":"5cd1fece-d558-5f97-8574-5369ea88632e"}},"staticQueryHashes":[],"slicesMap":{}}