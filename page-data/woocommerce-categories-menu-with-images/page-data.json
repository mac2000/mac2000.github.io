{"componentChunkName":"component---src-templates-note-js","path":"/woocommerce-categories-menu-with-images/","result":{"data":{"remark":{"fields":{"path":"woocommerce-categories-menu-with-images"},"meta":{"title":""},"headings":[{"value":"WooCommerce Categories Menu with Images"}],"html":"<h1>WooCommerce Categories Menu with Images</h1>\n<p>Adding categories with images menu widget to head of site</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/366e4e0d91526a8ef5ba7541b956e8c6/f53a0/woo-categories-menu-with-images.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.9375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABxElEQVR42lWN3WtScRiAz5+zC7M2W1tKi2VdTVmLLKlm0E1Bl120PjEi+vgHuigqzdhW5qC1VgtWdhFUpPOodxGhsxmCO+d4PJ8enziHWnTx8Ht5frzPK/gGQ/gDY2zfOUZgdB/3H6R4ms0RmYxzLz3LzN008cQZHqUyPM7MMjEZJ/t8gXQqQ3p5lSdv84yHJxjw78Y3FELw7QiyLbAH/5/g3NwzXr9ZIRI9zMOld5xfLnP85Gmy2Ry5hRdEpo7xPv+BpcWXpPJfmP9YJLw/yoB/FN9gECEwMs6uYJjhYJiDsQQXr97k8rXbnJtJMp9b5NXKKpeSt7hw5QbJ63eYPnWWqViC6KETxGLTHD2SYDh0ALczNLIXYU2s8rlY5VOhzLfvP1A0E7mro1kOhu2gmj3aukNb62E50Gq1+FooURIrFNZECsUSolhBLFcRyxUEx3EwbRvTsrEs2wtpZg/dcuj3+/ScPnbP8V6nj+f+ggv/cJ3Q6XSo12rU6nWPtqQgyR1vbqyv86vZ5GejQXNjA9MwMAwDTdO2UFV1i263i+BKSZZptzfpqCruAfdDliVkWUaSJBRF8Zyu6//hOndvU5I83OBvulS7otY+qX4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"\"\n        src=\"/static/366e4e0d91526a8ef5ba7541b956e8c6/2bef9/woo-categories-menu-with-images.png\"\n        srcset=\"/static/366e4e0d91526a8ef5ba7541b956e8c6/6f3f2/woo-categories-menu-with-images.png 256w,\n/static/366e4e0d91526a8ef5ba7541b956e8c6/01e7c/woo-categories-menu-with-images.png 512w,\n/static/366e4e0d91526a8ef5ba7541b956e8c6/2bef9/woo-categories-menu-with-images.png 1024w,\n/static/366e4e0d91526a8ef5ba7541b956e8c6/f53a0/woo-categories-menu-with-images.png 1062w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>(Do not take it hard from visual point of view, it is WIP)</p>\n<p>To make such things you need:</p>\n<h2>Register widget</h2>\n<p>It is almost straigh forward copy paste from <code class=\"language-text\">WC_Widget_Product_Categories</code> unfortunatelly there is no way to extend it</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Trofi_Widget_Product_Categories_Menu</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">WC_Widget</span>\n<span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cat_ancestors</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$current_cat</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">widget_cssclass</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'trofi cat-menu'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">widget_description</span> <span class=\"token operator\">=</span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'A list of product categories.'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'trofi'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">widget_id</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'trofi_product_categories'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">widget_name</span> <span class=\"token operator\">=</span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Product Categories Menu'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'trofi'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">settings</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string single-quoted-string\">'title'</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                <span class=\"token string single-quoted-string\">'type'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'std'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Product Categories'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'label'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Title'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'orderby'</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                <span class=\"token string single-quoted-string\">'type'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'select'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'std'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'label'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Order by'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string single-quoted-string\">'options'</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n                    <span class=\"token string single-quoted-string\">'order'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Category Order'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string single-quoted-string\">'name'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Name'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword static-context\">parent</span><span class=\"token operator\">::</span><span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">widget</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$instance</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">global</span> <span class=\"token variable\">$wp_query</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$orderBy</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$instance</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'orderby'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$instance</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'orderby'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">settings</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'orderby'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'std'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">require_once</span><span class=\"token punctuation\">(</span><span class=\"token function\">trailingslashit</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_stylesheet_directory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'walkers/Trofi_Product_Cat_Menu_Walker.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$list_args</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'show_count'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'hierarchical'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'taxonomy'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'hide_empty'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'menu_order'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'title_li'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'pad_counts'</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'show_option_none'</span> <span class=\"token operator\">=></span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'No product categories exist.'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'walker'</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Trofi_Product_Cat_Menu_Walker</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Menu Order</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$orderBy</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'order'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$list_args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'menu_order'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'asc'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$list_args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'orderby'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">// Setup Current Category</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cat_ancestors</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_tax</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$wp_query</span><span class=\"token operator\">-></span><span class=\"token property\">queried_object</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cat_ancestors</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_ancestors</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_singular</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'product'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$product_category</span> <span class=\"token operator\">=</span> <span class=\"token function\">wc_get_product_terms</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token constant\">ID</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'orderby'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'parent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$product_category</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span> <span class=\"token operator\">=</span> <span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$product_category</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cat_ancestors</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_ancestors</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token variable\">$list_args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">current_cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$list_args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category_ancestors'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cat_ancestors</span><span class=\"token punctuation\">;</span>\n\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">widget_start</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$instance</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;ul class=\"product-categories\">'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">wp_list_categories</span><span class=\"token punctuation\">(</span><span class=\"token function\">apply_filters</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'woocommerce_product_categories_widget_args'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$list_args</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;/ul>'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">widget_end</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>in your <code class=\"language-text\">functions.php</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'widgets_init'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">require_once</span><span class=\"token punctuation\">(</span><span class=\"token function\">trailingslashit</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_stylesheet_directory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'widgets/Trofi_Widget_Product_Categories_Menu.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">register_widget</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Trofi_Widget_Product_Categories_Menu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The key difference here is that we use our custom walker <code class=\"language-text\">Trofi_Product_Cat_Menu_Walker</code> which will render category image for top level categories.</p>\n<h2>Walker</h2>\n<p>Here we are extending WooCommerce product categories list walker and overriding its <code class=\"language-text\">start_el</code> method. The only difference from parent method if that we are adding category images inside anchors for top level categories.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ABSPATH'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Exit if accessed directly</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">require_once</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ABSPATH</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/wp-content/plugins/woocommerce/includes/walkers/class-product-cat-list-walker.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Trofi_Product_Cat_Menu_Walker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">WC_Product_Cat_List_Walker</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">start_el</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$output</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$cat</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$depth</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$args</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$current_object_id</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;li class=\"cat-item cat-item-'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">' current-cat'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'has_children'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'hierarchical'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">' cat-parent'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category_ancestors'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$args</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'current_category_ancestors'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">' current-cat-parent'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">//$output .=  '\">&lt;a href=\"' . get_term_link( (int) $cat->term_id, 'product_cat' ) . '\">' . __($cat->name, 'woocommerce') . '&lt;/a>';</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'\">&lt;a href=\"'</span> <span class=\"token operator\">.</span> <span class=\"token function\">get_term_link</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'product_cat'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$depth</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$category_thumbnail</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_woocommerce_term_meta</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">term_id</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'thumbnail_id'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$image</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_attachment_url</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$category_thumbnail</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$image</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$image</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$image</span> <span class=\"token punctuation\">:</span> <span class=\"token function\">get_theme_mod</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'trofi_category_default_image'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$image</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$image</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$image</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'http://placehold.it/100x100&amp;text=No+photo'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;span class=\"category-image\" style=\"background-image:url('</span> <span class=\"token operator\">.</span> <span class=\"token function\">esc_attr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$image</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')\">&lt;/span>'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">.=</span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cat</span><span class=\"token operator\">-></span><span class=\"token property\">name</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'woocommerce'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/a>'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>And thats all, now you can drop widget to header area or call it from <code class=\"language-text\">functions.php</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'init'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'storefront_header'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">the_widget</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Trofi_Widget_Product_Categories_Menu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>All is left is to have fun with styling it :)</p>"}},"pageContext":{"id":"4b330a45-b524-5a04-aabc-27ffbb4e8078"}},"staticQueryHashes":[],"slicesMap":{}}