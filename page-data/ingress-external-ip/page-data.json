{"componentChunkName":"component---src-templates-note-js","path":"/ingress-external-ip/","result":{"data":{"remark":{"fields":{"path":"ingress-external-ip"},"meta":{"title":""},"headings":[{"value":"ingress external ip"}],"html":"<h1>ingress external ip</h1>\n<p>in kubernetes our ingress is looking at service and it looks at endpoint</p>\n<p>technically we can craete endpoint manualy by defining target ip address</p>\n<p>and if there is connectivity between we can accomplish something like that</p>\n<svg width=\"130pt\" height=\"451pt\" viewBox=\"0.00 0.00 130.00 450.60\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"max-width: 100%; height: auto;\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 446.6)\">\n<title>G</title>\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-446.6 126,-446.6 126,4 -4,4\"></polygon>\n<g id=\"clust1\" class=\"cluster\">\n<title>cluster_0</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"8,-80.8 8,-379.6 114,-379.6 114,-80.8 8,-80.8\"></polygon>\n<text text-anchor=\"middle\" x=\"61\" y=\"-363\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">kubernetes</text>\n</g>\n<!-- ingress -->\n<g id=\"node1\" class=\"node\">\n<title>ingress</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"61\" cy=\"-328.8\" rx=\"38.2799\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"61\" y=\"-324.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">ingress</text>\n</g>\n<!-- service -->\n<g id=\"node2\" class=\"node\">\n<title>service</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"61\" cy=\"-217.8\" rx=\"38.2587\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"61\" y=\"-213.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">service</text>\n</g>\n<!-- ingress&#45;&gt;service -->\n<g id=\"edge1\" class=\"edge\">\n<title>ingress-&gt;service</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M61,-310.4706C61,-293.0373 61,-266.5482 61,-246.3489\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"64.5001,-246.1566 61,-236.1566 57.5001,-246.1567 64.5001,-246.1566\"></polygon>\n</g>\n<!-- endpoint -->\n<g id=\"node3\" class=\"node\">\n<title>endpoint</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"61\" cy=\"-106.8\" rx=\"44.6665\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"61\" y=\"-102.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">endpoint</text>\n</g>\n<!-- service&#45;&gt;endpoint -->\n<g id=\"edge2\" class=\"edge\">\n<title>service-&gt;endpoint</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M61,-199.4706C61,-182.0373 61,-155.5482 61,-135.3489\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"64.5001,-135.1566 61,-125.1566 57.5001,-135.1567 64.5001,-135.1566\"></polygon>\n</g>\n<!-- externalip -->\n<g id=\"node5\" class=\"node\">\n<title>externalip</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"61\" cy=\"-18\" rx=\"49.7962\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"61\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">externalip</text>\n</g>\n<!-- endpoint&#45;&gt;externalip -->\n<g id=\"edge4\" class=\"edge\">\n<title>endpoint-&gt;externalip</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M61,-88.4006C61,-76.2949 61,-60.2076 61,-46.4674\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"64.5001,-46.072 61,-36.072 57.5001,-46.0721 64.5001,-46.072\"></polygon>\n<text text-anchor=\"middle\" x=\"90.7381\" y=\"-58.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">external ip</text>\n</g>\n<!-- request -->\n<g id=\"node4\" class=\"node\">\n<title>request</title>\n<ellipse fill=\"none\" stroke=\"#000000\" cx=\"61\" cy=\"-424.6\" rx=\"38.842\" ry=\"18\"></ellipse>\n<text text-anchor=\"middle\" x=\"61\" y=\"-420.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">request</text>\n</g>\n<!-- request&#45;&gt;ingress -->\n<g id=\"edge3\" class=\"edge\">\n<title>request-&gt;ingress</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M61,-406.5808C61,-392.7527 61,-373.393 61,-357.4477\"></path>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"64.5001,-357.0641 61,-347.0642 57.5001,-357.0642 64.5001,-357.0641\"></polygon>\n</g>\n</g>\n</svg>\n<p>by applying</p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token punctuation\">---</span>\n<span class=\"token comment\"># Note: we are creating endpoint manualy, usualy it is done by defauly by kubernetes, whenever we create service</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Endpoints\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">subsets</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">addresses</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ip</span><span class=\"token punctuation\">:</span> 10.53.10.3 <span class=\"token comment\"># ip address accessible from kuberenetes</span>\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token comment\"># Note: we are not defining any selectors for pods</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n<span class=\"token comment\"># Note: alternative approach with dns cname instead of ip address</span>\n<span class=\"token comment\"># ---</span>\n<span class=\"token comment\"># apiVersion: v1</span>\n<span class=\"token comment\"># kind: Service</span>\n<span class=\"token comment\"># metadata:</span>\n<span class=\"token comment\">#   name: my-awesome-app</span>\n<span class=\"token comment\"># spec:</span>\n<span class=\"token comment\">#   type: ExternalName</span>\n<span class=\"token comment\">#   externalName: my-awesome-app.rabota.ua</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Ingress\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ingressClassName</span><span class=\"token punctuation\">:</span> external\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app.mac<span class=\"token punctuation\">-</span>blog.org.ua\n    <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app\n            <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /\n        <span class=\"token key atrule\">pathType</span><span class=\"token punctuation\">:</span> ImplementationSpecific</code></pre></div></p>\n<p>note that we can have two options - by defining ip addresses or dns names</p>\n<p>and to check if thats working we may do something like</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> some-pod-in-kube-xxxx -- <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">--resolve</span> my-awesome-app.mac-blog.org.ua:80:20.12.178.67 http://my-awesome-app.mac-blog.org.ua/login.aspx\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">--resolve</span> my-awesome-app.mac-blog.org.ua:80:20.12.178.67 http://my-awesome-app.mac-blog.org.ua/login.aspx</code></pre></div>"}},"pageContext":{"id":"3709a491-a68f-579b-9f44-c71d7113ef1e"}},"staticQueryHashes":[],"slicesMap":{}}