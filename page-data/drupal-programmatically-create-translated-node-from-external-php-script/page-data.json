{"componentChunkName":"component---src-templates-note-js","path":"/drupal-programmatically-create-translated-node-from-external-php-script/","result":{"data":{"remark":{"fields":{"path":"drupal-programmatically-create-translated-node-from-external-php-script"},"meta":{"title":""},"headings":[{"value":"Drupal programmatically create translated node from external php script"}],"html":"<h1>Drupal programmatically create translated node from external php script</h1>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token comment\">//set the working directory to your Drupal root</span>\n<span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/home/mac/Projects/drupal/multi/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//require the bootstrap include</span>\n<span class=\"token keyword\">require_once</span> <span class=\"token string single-quoted-string\">'./includes/bootstrap.inc'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Load Drupal</span>\n<span class=\"token function\">drupal_bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DRUPAL_BOOTSTRAP_FULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//(loads everything, but doesn't render anything)</span>\n\n<span class=\"token comment\">// create node in default language</span>\n<span class=\"token variable\">$node</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StdClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">type</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'product'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">uid</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">title</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Product 4 title ru'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">body</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Product 4 body ru'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">promote</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*$node->created = time();\n$node->changed = $node->created;\n$node->status = 1; // Published by default\n$node->promote = 1;\n$node->sticky = 0;\n$node->format = 1;       // Filtered HTML\n*/</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">language</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'ru'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// add CCK field data</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">field_code</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'value'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'code for product 4 ru'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// save node</span>\n<span class=\"token function\">node_save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$node</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// modify node:tnid - used by i18n</span>\n<span class=\"token variable\">$tnid</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">nid</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">tnid</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$tnid</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">node_save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$node</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// create translation</span>\n<span class=\"token variable\">$node</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StdClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">type</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'product'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">uid</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">title</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Product 4 title en'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">body</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Product 4 body en'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">promote</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">language</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'en'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">field_code</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'value'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'code for product 4 en'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$node</span><span class=\"token operator\">-></span><span class=\"token property\">tnid</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$tnid</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">node_save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$node</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//display a node</span>\n<span class=\"token keyword\">print</span> <span class=\"token string single-quoted-string\">'&lt;pre>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$node</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span> <span class=\"token string single-quoted-string\">'&lt;/pre>'</span><span class=\"token punctuation\">;</span></span></code></pre></div>"}},"pageContext":{"id":"8f360e46-d36a-5826-83d1-4b6aa5f608e5"}},"staticQueryHashes":[],"slicesMap":{}}