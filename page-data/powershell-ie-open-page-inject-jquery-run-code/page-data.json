{"componentChunkName":"component---src-templates-note-js","path":"/powershell-ie-open-page-inject-jquery-run-code","result":{"data":{"remark":{"fields":{"path":"powershell-ie-open-page-inject-jquery-run-code"},"meta":{"title":""},"headings":[{"value":"PowerShell IE open page, inject jQuery, run code"}],"html":"<h1>PowerShell IE open page, inject jQuery, run code</h1>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># Create instance of InternetExplorer</span>\n<span class=\"token variable\">$ie</span> = <span class=\"token function\">new-object</span> <span class=\"token operator\">-</span>com internetexplorer<span class=\"token punctuation\">.</span>application\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>visible = <span class=\"token boolean\">$true</span>\n\n<span class=\"token comment\"># Go to page</span>\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>navigate2<span class=\"token punctuation\">(</span><span class=\"token string\">\"http://example.com/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Wait for page load</span>\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>busy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token function\">start-sleep</span> 1<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># Inject jQuery</span>\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML = <span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;div id=`\"a`\" onclick=`\"var th = document.getElementsByTagName('body')[0];var s = document.createElement('script');s.setAttribute('type','text/javascript');s.setAttribute('src','http://code.jquery.com/jquery-1.4.2.min.js');th.appendChild(s);`\">hello&lt;/div>\"</span>\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>getElementById<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Run our javascript</span>\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML = <span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;div id=`\"x`\" onclick=`\"`$('a').hide()`\">hello&lt;/div>\"</span>\n<span class=\"token variable\">$ie</span><span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span>getElementById<span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>"}},"pageContext":{"id":"f9a87684-1592-5f47-bbde-33f4b3536560"}},"staticQueryHashes":[]}