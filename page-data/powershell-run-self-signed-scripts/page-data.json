{"componentChunkName":"component---src-templates-note-js","path":"/powershell-run-self-signed-scripts/","result":{"data":{"remark":{"fields":{"path":"powershell-run-self-signed-scripts"},"meta":{"title":""},"headings":[{"value":"PowerShell run self signed scripts"}],"html":"<h1>PowerShell run self signed scripts</h1>\n<p>Run console as Administrator and execute following commands:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token string\">\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\\x64\\makecert.exe\"</span> <span class=\"token operator\">-</span>n <span class=\"token string\">\"CN=PowerShell Local Certificate Root\"</span> <span class=\"token operator\">-</span>a sha1 <span class=\"token operator\">-</span>eku 1<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>5<span class=\"token punctuation\">.</span>5<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">.</span>3 <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span><span class=\"token function\">sv</span> root<span class=\"token punctuation\">.</span>pvk root<span class=\"token punctuation\">.</span>cer <span class=\"token operator\">-</span>ss Root <span class=\"token operator\">-</span>sr localMachine\n<span class=\"token string\">\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\\x64\\makecert.exe\"</span> <span class=\"token operator\">-</span>pe <span class=\"token operator\">-</span>n <span class=\"token string\">\"CN=PowerShell User\"</span> <span class=\"token operator\">-</span>ss MY <span class=\"token operator\">-</span>a sha1 <span class=\"token operator\">-</span>eku 1<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">.</span>6<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>5<span class=\"token punctuation\">.</span>5<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">.</span>3 <span class=\"token operator\">-</span>iv root<span class=\"token punctuation\">.</span>pvk <span class=\"token operator\">-</span>ic root<span class=\"token punctuation\">.</span>cer</code></pre></div>\n<p>Then from powershell with Administrator privilegies allow execute selfsigned scripts</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">set-executionpolicy</span> AllSigned</code></pre></div>\n<p>Then</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Set-AuthenticodeSignature</span> C:\\Users\\mac\\Scripts\\ImagesShedule<span class=\"token punctuation\">.</span>ps1 @<span class=\"token punctuation\">(</span><span class=\"token function\">Get-ChildItem</span> cert:\\CurrentUser\\My <span class=\"token operator\">-</span>codesigning<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>0<span class=\"token punctuation\">]</span></code></pre></div>\n<p>makecert.exe ships with Microsoft Windows Software Development Kit, available at <a href=\"http://msdn.microsoft.com/en-us/windowsserver/bb980924.aspx\">http://msdn.microsoft.com/en-us/windowsserver/bb980924.aspx</a>.</p>\n<p>Also note that makecert.exe may be located in another folder.</p>\n<p>If all ok, running two first commands will display dialogs with promts to enter passwords.</p>\n<p>Do not forget to run them from cmd.exe as Administrator.</p>"}},"pageContext":{"id":"0f326682-21bc-5555-8315-ac9bedab2d9f"}},"staticQueryHashes":[],"slicesMap":{}}