{"componentChunkName":"component---src-templates-note-js","path":"/winforms-webbrowser-documentcompleted","result":{"data":{"remark":{"fields":{"path":"winforms-webbrowser-documentcompleted"},"meta":{"title":""},"headings":[{"value":"WinForms WebBrowser DocumentCompleted"}],"html":"<h1>WinForms WebBrowser DocumentCompleted</h1>\n<p>WebBrowser can give you fake <code class=\"language-text\">DocumentCompleted</code> event, it do not count iframes, counters etc. Here is how to fix it:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>ComponentModel</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Drawing</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Security<span class=\"token punctuation\">.</span>Permissions</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">mshtml</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>IO</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">HeadHunterNewCompanies</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">PermissionSet</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span>SecurityAction<span class=\"token punctuation\">.</span>Demand<span class=\"token punctuation\">,</span> Name <span class=\"token operator\">=</span> <span class=\"token string\">\"FullTrust\"</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Runtime<span class=\"token punctuation\">.</span>InteropServices<span class=\"token punctuation\">.</span>ComVisibleAttribute</span><span class=\"token attribute-arguments\"><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">Form</span></span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            webBrowser1<span class=\"token punctuation\">.</span>AllowWebBrowserDrop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            webBrowser1<span class=\"token punctuation\">.</span>IsWebBrowserContextMenuEnabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            webBrowser1<span class=\"token punctuation\">.</span>WebBrowserShortcutsEnabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            webBrowser1<span class=\"token punctuation\">.</span>ObjectForScripting <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// Uncomment the following line when you are finished debugging.</span>\n            webBrowser1<span class=\"token punctuation\">.</span>ScriptErrorsSuppressed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            webBrowser1<span class=\"token punctuation\">.</span><span class=\"token function\">Navigate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://hh.ua/employersList.do\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">webBrowser1_DocumentCompleted</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">WebBrowserDocumentCompletedEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Url<span class=\"token punctuation\">.</span>AbsolutePath <span class=\"token operator\">!=</span> <span class=\"token punctuation\">(</span>sender <span class=\"token keyword\">as</span> <span class=\"token class-name\">WebBrowser</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Url<span class=\"token punctuation\">.</span>AbsolutePath<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">HtmlElement</span> head <span class=\"token operator\">=</span> webBrowser1<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">GetElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"head\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">HtmlElement</span> scriptEl <span class=\"token operator\">=</span> webBrowser1<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">CreateElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">IHTMLScriptElement</span> element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>IHTMLScriptElement<span class=\"token punctuation\">)</span>scriptEl<span class=\"token punctuation\">.</span>DomElement<span class=\"token punctuation\">;</span>\n            element<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> File<span class=\"token punctuation\">.</span><span class=\"token function\">ReadAllText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jquery-1.4.2.min.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            head<span class=\"token punctuation\">.</span><span class=\"token function\">AppendChild</span><span class=\"token punctuation\">(</span>scriptEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            scriptEl <span class=\"token operator\">=</span> webBrowser1<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">CreateElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            element <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>IHTMLScriptElement<span class=\"token punctuation\">)</span>scriptEl<span class=\"token punctuation\">.</span>DomElement<span class=\"token punctuation\">;</span>\n            element<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">\"function myfunc() { var lastPageNumber = $('.b-pager-lite a:last').text(); alert(lastPageNumber); }\"</span><span class=\"token punctuation\">;</span>\n            head<span class=\"token punctuation\">.</span><span class=\"token function\">AppendChild</span><span class=\"token punctuation\">(</span>scriptEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            webBrowser1<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">InvokeScript</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myfunc\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>"}},"pageContext":{"id":"92c0bdd2-ab2f-52f9-9520-83323e93ee08"}},"staticQueryHashes":[]}