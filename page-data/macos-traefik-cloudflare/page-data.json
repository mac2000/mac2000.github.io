{"componentChunkName":"component---src-templates-note-js","path":"/macos-traefik-cloudflare/","result":{"data":{"remark":{"fields":{"path":"macos-traefik-cloudflare"},"meta":{"title":""},"headings":[{"value":"MacOS Traefik Cloudflre"}],"html":"<h1>MacOS Traefik Cloudflre</h1>\n<p>Keeping an note of exposing local MacOS with Traefik behind Cloudflare</p>\n<p>By intent, in my setup I did not use Docker or Kubernetes.</p>\n<p>Notes:</p>\n<ul>\n<li>only HTTP traffic is allowed</li>\n<li>requests are allowed only from Cloudflare</li>\n<li>requests are verified with mTLS</li>\n<li>obviously for this to work, port forwarding and static IP should be configured in home router</li>\n<li>remember that Cloudflare can proxy only http traffic, so it is not possible to proxy lets say Postgresql</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> traefik</code></pre></div>\n<p>yep, that's it :)</p>\n<p>defaults:</p>\n<ul>\n<li>plist - <code class=\"language-text\">/opt/homebrew/Cellar/traefik/3.3.4/homebrew.mxcl.traefik.plist</code></li>\n<li>config - <code class=\"language-text\">/opt/homebrew/etc/traefik/traefik.toml</code></li>\n<li>logs - <code class=\"language-text\">/opt/homebrew/var/log/traefik.log</code></li>\n</ul>\n<p>in my case, I need <code class=\"language-text\">CLOUDFLARE_DNS_API_TOKEN</code> environment variable and brew will override plist, so going to have my own configurations</p>\n<p><strong>~/.config/traefik/static.yml</strong></p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">log</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># we need this for debugging, talke closer look at</span>\n  <span class=\"token comment\"># DBG github.com/traefik/traefik/v3/cmd/traefik/traefik.go:114 > Static configuration loaded [json] staticConfiguration={</span>\n  <span class=\"token comment\"># it will print actual configuration that Traefik uses</span>\n  <span class=\"token key atrule\">level</span><span class=\"token punctuation\">:</span> DEBUG\n<span class=\"token key atrule\">accessLog</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">format</span><span class=\"token punctuation\">:</span> common\n\n<span class=\"token key atrule\">providers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">file</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">filename</span><span class=\"token punctuation\">:</span> /Users/mini/.config/traefik/dynamic.yml\n\n<span class=\"token key atrule\">certificatesResolvers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">cloudflare</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">acme</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> marchenko.alexandr@gmail.com\n      <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> /Users/mini/.config/traefik/acme.json\n      <span class=\"token key atrule\">dnsChallenge</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span> cloudflare\n        <span class=\"token key atrule\">resolvers</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> 1.1.1.1<span class=\"token punctuation\">:</span><span class=\"token number\">53</span>\n          <span class=\"token punctuation\">-</span> 1.0.0.1<span class=\"token punctuation\">:</span><span class=\"token number\">53</span>\n\n<span class=\"token key atrule\">metrics</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">prometheus</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">#addEntryPointsLabels: true</span>\n    <span class=\"token comment\">#addRoutersLabels: true</span>\n    <span class=\"token comment\">#addServicesLabels: true</span>\n\n<span class=\"token key atrule\">entryPoints</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># note: we have only https entrypoint, no http at all</span>\n  <span class=\"token key atrule\">https</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">address</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">:</span><span class=\"token number\">443</span>\n    <span class=\"token comment\"># and it is set as default, so no need to specify it in routers</span>\n    <span class=\"token comment\"># as well as configuring redirects here and there</span>\n    <span class=\"token key atrule\">asDefault</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># here we are configuring default wildcard certificate</span>\n      <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">certResolver</span><span class=\"token punctuation\">:</span> cloudflare\n        <span class=\"token key atrule\">domains</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">main</span><span class=\"token punctuation\">:</span> mac<span class=\"token punctuation\">-</span>blog.org.ua\n            <span class=\"token key atrule\">sans</span><span class=\"token punctuation\">:</span>\n              <span class=\"token punctuation\">-</span> <span class=\"token string\">\"*.mac-blog.org.ua\"</span>\n    <span class=\"token comment\"># we need this one for traefik to log client ip</span>\n    <span class=\"token key atrule\">forwardedHeaders</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">trustedIPs</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># https://www.cloudflare.com/ips-v4</span>\n        <span class=\"token punctuation\">-</span> 173.245.48.0/20\n        <span class=\"token punctuation\">-</span> 103.21.244.0/22\n        <span class=\"token punctuation\">-</span> 103.22.200.0/22\n        <span class=\"token punctuation\">-</span> 103.31.4.0/22\n        <span class=\"token punctuation\">-</span> 141.101.64.0/18\n        <span class=\"token punctuation\">-</span> 108.162.192.0/18\n        <span class=\"token punctuation\">-</span> 190.93.240.0/20\n        <span class=\"token punctuation\">-</span> 188.114.96.0/20\n        <span class=\"token punctuation\">-</span> 197.234.240.0/22\n        <span class=\"token punctuation\">-</span> 198.41.128.0/17\n        <span class=\"token punctuation\">-</span> 162.158.0.0/15\n        <span class=\"token punctuation\">-</span> 104.16.0.0/13\n        <span class=\"token punctuation\">-</span> 104.24.0.0/14\n        <span class=\"token punctuation\">-</span> 172.64.0.0/13\n        <span class=\"token punctuation\">-</span> 131.0.72.0/22\n        <span class=\"token comment\"># https://www.cloudflare.com/ips-v6</span>\n        <span class=\"token punctuation\">-</span> 2400<span class=\"token punctuation\">:</span>cb00<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n        <span class=\"token punctuation\">-</span> 2606<span class=\"token punctuation\">:</span>4700<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n        <span class=\"token punctuation\">-</span> 2803<span class=\"token punctuation\">:</span>f800<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n        <span class=\"token punctuation\">-</span> 2405<span class=\"token punctuation\">:</span>b500<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n        <span class=\"token punctuation\">-</span> 2405<span class=\"token punctuation\">:</span>8100<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n        <span class=\"token punctuation\">-</span> 2a06<span class=\"token punctuation\">:</span>98c0<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/29\n        <span class=\"token punctuation\">-</span> 2c0f<span class=\"token punctuation\">:</span>f248<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>/32\n\n<span class=\"token comment\"># quite simple but awesome plugin to protect some services</span>\n<span class=\"token key atrule\">experimental</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">google-oidc-auth-middleware</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">moduleName</span><span class=\"token punctuation\">:</span> github.com/andrewkroh/google<span class=\"token punctuation\">-</span>oidc<span class=\"token punctuation\">-</span>auth<span class=\"token punctuation\">-</span>middleware\n      <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> v0.1.0</code></pre></div></p>\n<p><strong>~/.config/traefik/dynamic.yml</strong></p>\n<p><div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">routers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># note how simple routers are - just define host and service and you are ready to go</span>\n    <span class=\"token key atrule\">foo</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">rule</span><span class=\"token punctuation\">:</span> Host(`foo.mac<span class=\"token punctuation\">-</span>blog.org.ua`)\n      <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span> foo\n    <span class=\"token key atrule\">bar</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">rule</span><span class=\"token punctuation\">:</span> Host(`bar.mac<span class=\"token punctuation\">-</span>blog.org.ua`)\n      <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span> bar\n      <span class=\"token key atrule\">middlewares</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> auth\n  <span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">foo</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">loadBalancer</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">servers</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//localhost<span class=\"token punctuation\">:</span>3000/\n    <span class=\"token key atrule\">bar</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">loadBalancer</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">servers</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//localhost<span class=\"token punctuation\">:</span>9090/\n\n  <span class=\"token key atrule\">middlewares</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># just as example, we can use built in basic asuth</span>\n    <span class=\"token key atrule\">basicauth</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">basicAuth</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">users</span><span class=\"token punctuation\">:</span>\n          <span class=\"token comment\"># htpasswd -nb hello world</span>\n          <span class=\"token punctuation\">-</span> hello<span class=\"token punctuation\">:</span>$apr1$xwaBOwva$/FgrbWFvzTIRvm4p9LK4h1\n    <span class=\"token comment\"># added in static.yml</span>\n    <span class=\"token key atrule\">auth</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">plugin</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">google-oidc-auth-middleware</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">authorized</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">emails</span><span class=\"token punctuation\">:</span>\n              <span class=\"token punctuation\">-</span> marchenko.alexandr@gmail.com\n          <span class=\"token key atrule\">cookie</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">secret</span><span class=\"token punctuation\">:</span> some_random_string_at_least_32_characters_longs\n            <span class=\"token comment\"># insecure: true</span>\n            <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> google\n          <span class=\"token key atrule\">oidc</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">clientID</span><span class=\"token punctuation\">:</span> xxx.apps.googleusercontent.com\n            <span class=\"token key atrule\">clientSecret</span><span class=\"token punctuation\">:</span> GOCSPX<span class=\"token punctuation\">-</span>xxxxxxxxxxxxxxxxxxx\n\n<span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">options</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># require SNI to be present and valid</span>\n      <span class=\"token key atrule\">sniStrict</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token comment\"># cloudflare origin pull certificate</span>\n      <span class=\"token key atrule\">clientAuth</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">caFiles</span><span class=\"token punctuation\">:</span>\n          <span class=\"token comment\"># https://developers.cloudflare.com/ssl/static/authenticated_origin_pull_ca.pem</span>\n          <span class=\"token punctuation\">-</span> /Users/mini/.config/traefik/authenticated_origin_pull_ca.pem\n        <span class=\"token key atrule\">clientAuthType</span><span class=\"token punctuation\">:</span> RequireAndVerifyClientCert</code></pre></div></p>\n<p><strong>~/.config/traefik/traefik.plist</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">plist</span> <span class=\"token name\">PUBLIC</span> <span class=\"token string\">\"-//Apple//DTD PLIST 1.0//EN\"</span> <span class=\"token string\">\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plist</span> <span class=\"token attr-name\">version</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dict</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>Label<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>traefik<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>LimitLoadToSessionType<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>array</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>Aqua<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>Background<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>LoginWindow<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>StandardIO<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>System<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>array</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>ProgramArguments<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>array</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/opt/homebrew/opt/traefik/bin/traefik<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>--configfile=/Users/mini/.config/traefik/static.yml<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>array</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>EnvironmentVariables<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dict</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>CLOUDFLARE_DNS_API_TOKEN<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>TODO_PASTE_CLOUDFLARE_ACCESS_TOKEN_HERE<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dict</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>RunAtLoad<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>true</span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>StandardErrorPath<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/opt/homebrew/var/log/traefik.log<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>StandardOutPath<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/opt/homebrew/var/log/traefik.log<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>WorkingDirectory<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/opt/homebrew/var<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dict</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plist</span><span class=\"token punctuation\">></span></span>\n</code></pre></div>\n<p>Cloudflare access token should have Zone Read and DNS Edit permissions</p>\n<p>While you are configuring everything you always may test it like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">CLOUDFLARE_DNS_API_TOKEN</span><span class=\"token operator\">=</span>xxxxxxxx traefik <span class=\"token parameter variable\">--configfile</span><span class=\"token operator\">=</span>/Users/mini/.config/traefik/static.yml</code></pre></div>\n<p>And finally:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> ~/.config/traefik/traefik.plist ~/Library/LaunchAgents/traefik.plist\n\nlaunchctl load ~/Library/LaunchAgents/traefik.plist</code></pre></div>\n<p>Other commands used often:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> ~/.config/traefik/traefik.plist ~/Library/LaunchAgents/traefik.plist\n\nlaunchctl load ~/Library/LaunchAgents/traefik.plist\nlaunchctl unload ~/Library/LaunchAgents/traefik.plist\n<span class=\"token function\">rm</span> ~/Library/LaunchAgents/traefik.plist\n\n<span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span> /opt/homebrew/var/log/traefik.log\n\n<span class=\"token function\">ps</span> aux <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> traefik</code></pre></div>"}},"pageContext":{"id":"3d2a9e11-5ce0-5b6f-811c-b5a9827c9bc6"}},"staticQueryHashes":[],"slicesMap":{}}