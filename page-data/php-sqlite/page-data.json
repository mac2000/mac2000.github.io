{"componentChunkName":"component---src-templates-note-js","path":"/php-sqlite","result":{"data":{"remark":{"fields":{"path":"php-sqlite"},"meta":{"title":""},"headings":[{"value":"PHP SQLite"}],"html":"<h1>PHP SQLite</h1>\n<p>Short note to memorize how to access sqlite databases from php</p>\n<h2>DBAL</h2>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Doctrine<span class=\"token punctuation\">\\</span>DBAL<span class=\"token punctuation\">\\</span>Configuration</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Doctrine<span class=\"token punctuation\">\\</span>DBAL<span class=\"token punctuation\">\\</span>DriverManager</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">require_once</span> <span class=\"token string single-quoted-string\">'vendor/autoload.php'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DriverManager</span><span class=\"token operator\">::</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string single-quoted-string\">'driver'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'pdo_sqlite'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//'path' => 'database.sqlite3',</span>\n    <span class=\"token string single-quoted-string\">'memory'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'DROP TABLE IF EXISTS users'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"CREATE TABLE IF NOT EXISTS users (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    first_name VARCHAR(50) NOT NULL,\n    last_name VARCHAR(50) NOT NULL,\n    age INTEGER DEFAULT 0\n)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'first_name'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'Alexandr'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'last_name'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'Marchenko'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'age'</span> <span class=\"token operator\">=></span> <span class=\"token number\">29</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SELECT first_name || ' ' || last_name AS full_name, age FROM users WHERE age > :age\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'age'</span> <span class=\"token operator\">=></span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token class-name static-context\">PDO</span><span class=\"token operator\">::</span><span class=\"token constant\">FETCH_ASSOC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'full_name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' ('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<h2>PDO</h2>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$connection</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PDO</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'sqlite::memory:'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token class-name static-context\">PDO</span><span class=\"token operator\">::</span><span class=\"token constant\">ERRMODE_EXCEPTION</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//$connection = new PDO('sqlite:database.sqlite3', null, null, [PDO::ERRMODE_EXCEPTION => true]);</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"DROP TABLE IF EXISTS users\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"CREATE TABLE IF NOT EXISTS users (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    first_name VARCHAR(50) NOT NULL,\n    last_name VARCHAR(50) NOT NULL,\n    age INTEGER DEFAULT 0\n)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"INSERT INTO users VALUES(NULL, :first_name, :last_name, :age)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'first_name'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'Alexandr'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'last_name'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'Marchenko'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'age'</span> <span class=\"token operator\">=></span> <span class=\"token number\">29</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SELECT first_name || ' ' || last_name AS full_name, age FROM users WHERE age > :age\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'age'</span> <span class=\"token operator\">=></span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token class-name static-context\">PDO</span><span class=\"token operator\">::</span><span class=\"token constant\">FETCH_ASSOC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'full_name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' ('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<h2>SQLite3</h2>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$connection</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLite3</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':memory:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//$connection = new SQLite3('database.sqlite3');</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"DROP TABLE IF EXISTS users\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"CREATE TABLE IF NOT EXISTS users (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    first_name VARCHAR(50) NOT NULL,\n    last_name VARCHAR(50) NOT NULL,\n    age INTEGER DEFAULT 0\n)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"INSERT INTO users VALUES(NULL, :first_name, :last_name, :age)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">bindValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':first_name'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Alexandr'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">bindValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':last_name'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Marchenko'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">bindValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':age'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$connection</span><span class=\"token operator\">-></span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SELECT first_name || ' ' || last_name AS full_name, age FROM users WHERE age > :age\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">bindValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':age'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$result</span><span class=\"token operator\">-></span><span class=\"token function\">fetchArray</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SQLITE3_ASSOC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'full_name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' ('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'age'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>"}},"pageContext":{"id":"e0d2ad06-dcd7-53f3-b0b5-d681cf1e8df8"}},"staticQueryHashes":[]}