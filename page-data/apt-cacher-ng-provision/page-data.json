{"componentChunkName":"component---src-templates-note-js","path":"/apt-cacher-ng-provision/","result":{"data":{"remark":{"fields":{"path":"apt-cacher-ng-provision"},"meta":{"title":""},"headings":[{"value":"Apt-cacher-ng provision"}],"html":"<h1>Apt-cacher-ng provision</h1>\n<p>apt-cacher-ng speeds up provision of 3 lamp nodes from 12 to 4 minutes.</p>\n<p>here is simple example how to get it up and running:</p>\n<p><strong>Vagrantfile</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">Vagrant<span class=\"token punctuation\">.</span>configure<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n  config<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>box <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"ubuntu/trusty64\"</span></span>\n\n  config<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>define <span class=\"token string-literal\"><span class=\"token string\">\"server\"</span></span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>node<span class=\"token operator\">|</span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>hostname <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"server\"</span></span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>network <span class=\"token string-literal\"><span class=\"token string\">\"private_network\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">ip</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"192.168.33.11\"</span></span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>provider <span class=\"token string-literal\"><span class=\"token string\">\"virtualbox\"</span></span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>vb<span class=\"token operator\">|</span>\n      vb<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"server\"</span></span>\n    <span class=\"token keyword\">end</span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>provision <span class=\"token symbol\">:shell</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">path</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Server.sh\"</span></span>\n  <span class=\"token keyword\">end</span>\n\n  config<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>define <span class=\"token string-literal\"><span class=\"token string\">\"client\"</span></span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>node<span class=\"token operator\">|</span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>hostname <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"client\"</span></span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>network <span class=\"token string-literal\"><span class=\"token string\">\"private_network\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">ip</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"192.168.33.12\"</span></span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>provider <span class=\"token string-literal\"><span class=\"token string\">\"virtualbox\"</span></span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>vb<span class=\"token operator\">|</span>\n      vb<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"client\"</span></span>\n    <span class=\"token keyword\">end</span>\n    node<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>provision <span class=\"token symbol\">:shell</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">path</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Client.sh\"</span></span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p><strong>Server.sh</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> apt-cacher-ng</code></pre></div>\n<p><strong>Client.sh</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Acquire::http { Proxy \"http://apt.mac.rabota.ua:3142\"; };'</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/apt/apt.conf.d/02proxy</code></pre></div>\n<p><strong>Proxy stats</strong></p>\n<p><a href=\"http://apt.mac.rabota.ua:3142/acng-report.html?doCount=Count+Data\">http://apt.mac.rabota.ua:3142/acng-report.html?doCount=Count+Data</a></p>"}},"pageContext":{"id":"0cdf6335-bb1a-5582-a467-670cb70ed222"}},"staticQueryHashes":[],"slicesMap":{}}