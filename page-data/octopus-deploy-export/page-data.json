{"componentChunkName":"component---src-templates-note-js","path":"/octopus-deploy-export","result":{"data":{"remark":{"fields":{"path":"octopus-deploy-export"},"meta":{"title":""},"headings":[{"value":"Export Octopus Deploy History as CSV"}],"html":"<h1>Export Octopus Deploy History as CSV</h1>\n<p>Even so Octopus Deploy stored limited amount of releases history there is an endpoint to export full history which is dramatically helpfull for audit</p>\n<p>The script itselft is as simple as</p>\n<p><div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Get-Date</span>\n<span class=\"token variable\">$res</span> = <span class=\"token function\">Invoke-RestMethod</span> <span class=\"token string\">\"https://robota.octopus.app/api/reporting/deployments/xml?apikey=<span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$env</span>:OCTOPUS_CLI_API_KEY<span class=\"token punctuation\">)</span></span>\"</span>\n<span class=\"token variable\">$res</span> = <span class=\"token namespace\">[xml]</span><span class=\"token variable\">$res</span><span class=\"token punctuation\">.</span>Substring<span class=\"token punctuation\">(</span>1<span class=\"token punctuation\">)</span>\n<span class=\"token function\">Write-Host</span> <span class=\"token string\">\"Got <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$res</span><span class=\"token punctuation\">.</span>Deployments<span class=\"token punctuation\">.</span>Deployment<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">)</span></span> records from OCtopus\"</span>\n<span class=\"token variable\">$res</span><span class=\"token punctuation\">.</span>Deployments<span class=\"token punctuation\">.</span>Deployment <span class=\"token punctuation\">|</span> <span class=\"token function\">ConvertTo-Csv</span> <span class=\"token operator\">-</span>NoTypeInformation <span class=\"token punctuation\">|</span> <span class=\"token function\">Out-File</span> <span class=\"token operator\">/</span>Users/mac/Desktop/octopus<span class=\"token punctuation\">.</span>csv\n<span class=\"token function\">Write-Host</span> <span class=\"token string\">\"Lines in csv: <span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">Get-Content</span> <span class=\"token operator\">/</span>Users/mac/Desktop/octopus<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">)</span></span>.Count)\"</span>\n<span class=\"token function\">Get-Date</span></code></pre></div></p>\n<p>Which will produce CSV file with something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"csv\"><pre class=\"language-csv\"><code class=\"language-csv\"><span class=\"token value\">\"DeploymentId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"DeploymentName\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ProjectId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ProjectName\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ProjectSlug\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"TenantId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"TenantName\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ChannelId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ChannelName\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"EnvironmentId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"EnvironmentName\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ReleaseId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ReleaseVersion\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"TaskId\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"TaskState\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Created\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"QueueTime\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"StartTime\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"CompletedTime\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"DurationSeconds\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"DeployedBy\"</span>\n<span class=\"token value\">\"Deployments-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Deploy to Dev\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Projects-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"adjwt\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"adjwt\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Channels-2\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"master\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Environments-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"dev\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Releases-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"1.1.28-b5144e3-master\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ServerTasks-421\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Success\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:44:17\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:44:17\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:44:17\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:44:41\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"24\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"administrator\"</span>\n<span class=\"token value\">\"Deployments-2\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Deploy to Dev (#2)\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Projects-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"adjwt\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"adjwt\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Channels-2\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"master\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Environments-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"dev\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Releases-1\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"1.1.28-b5144e3-master\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"ServerTasks-422\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"Success\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:50:18\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:50:18\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:50:18\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"2018-06-20T13:50:36\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"18\"</span><span class=\"token punctuation\">,</span><span class=\"token value\">\"administrator\"</span></code></pre></div>"}},"pageContext":{"id":"5854382e-ebb8-52c0-83bd-8a144890cb54"}},"staticQueryHashes":[]}