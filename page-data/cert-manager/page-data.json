{"componentChunkName":"component---src-templates-note-js","path":"/cert-manager/","result":{"data":{"remark":{"fields":{"path":"cert-manager"},"meta":{"title":""},"headings":[{"value":"Cert-Manager"}],"html":"<h1>Cert-Manager</h1>\n<p>certificates have 90 days life time and rotated 30 days before expire, there is <code class=\"language-text\">certmanager_certificate_expiration_timestamp_seconds</code> prometheus metric to watch for this</p>\n<h2>Installation</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply <span class=\"token parameter variable\">-f</span> https://github.com/cert-manager/cert-manager/releases/download/v1.10.0/cert-manager.yaml</code></pre></div>\n<p>Wait for pods in Cert-manager namespace to be up and running</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token parameter variable\">-n</span> cert-manager get po</code></pre></div>\n<blockquote>\n<p>note: to upgrade just apply new version but before read upgrading notes if any</p>\n</blockquote>\n<p>You need to wait few minutes after installing certmanager before proceeding, underneath it will create and sign self signed certificate for webhooks which will be used by cainjector and while it is not done trying to create cluster issues will error:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Error from server (InternalError): error when creating \"issuer.yml\": Internal error occurred: failed calling webhook \"webhook.cert-manager.io\": failed to call webhook: Post \"https://cert-manager-webhook.cert-manager.svc:443/mutate?timeout=10s\": x509: certificate signed by unknown authority</code></pre></div>\n<h2>Cluster Issuer</h2>\n<p>Next, we need to create cluster wide certificate issuer, done once per cluster</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Secret\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cloudflare<span class=\"token punctuation\">-</span>api<span class=\"token punctuation\">-</span>token<span class=\"token punctuation\">-</span>secret\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Opaque\n<span class=\"token key atrule\">stringData</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">api-token</span><span class=\"token punctuation\">:</span> fRVcLb3iZ0RHF9YL2Y4yGWDx11XvO_MMBt<span class=\"token punctuation\">-</span>jvOHh\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterIssuer\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> letsencrypt\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">acme</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//acme<span class=\"token punctuation\">-</span>v02.api.letsencrypt.org/directory\n    <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> svc@rabota.ua\n    <span class=\"token key atrule\">privateKeySecretRef</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> letsencrypt\n    <span class=\"token key atrule\">solvers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">dns01</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">cloudflare</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">apiTokenSecretRef</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cloudflare<span class=\"token punctuation\">-</span>api<span class=\"token punctuation\">-</span>token<span class=\"token punctuation\">-</span>secret\n              <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>token</code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>if everything fine <code class=\"language-text\">kubectl get clusterissuer</code> should show our letstencrypt issuer in ready state</li>\n</ul>\n<h2>Wildcard Certificate</h2>\n<p>To not create certificates each time we may want to create them once and reuse them</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Secret\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> wildcard<span class=\"token punctuation\">-</span>tls\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> kubernetes.io/tls\n<span class=\"token key atrule\">stringData</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">tls.key</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token key atrule\">tls.crt</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Certificate\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> wildcard<span class=\"token punctuation\">-</span>tls\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> wildcard<span class=\"token punctuation\">-</span>tls\n  <span class=\"token key atrule\">issuerRef</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">group</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterIssuer\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> letsencrypt\n  <span class=\"token key atrule\">dnsNames</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"dev.rabota.ua\"</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"*.dev.rabota.ua\"</span></code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>secret in this example is added just for <code class=\"language-text\">kubectl delete -f</code> will delete it also</li>\n<li>secret will be created or updated and filled with tls keys</li>\n<li>need to be done per each namespace</li>\n<li>wait till <code class=\"language-text\">kubectl -n dev get certificate wildcard-tls</code> will become ready (may take up to few minutes, in my initial case it was almost 3min)</li>\n<li>after that <code class=\"language-text\">kubectl -n dev get secret wildcard-tls -o yaml</code> should be filled by certificates</li>\n</ul>\n<h2>Ingress wildcard usage example</h2>\n<p>For ingress to use an pre-created wildcard certificate we need to add the following to its spec:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> demo.dev.rabota.ua\n    <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> wildcard<span class=\"token punctuation\">-</span>tls</code></pre></div>\n<p>here is a deployment example:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">kubernetes.io/os</span><span class=\"token punctuation\">:</span> linux\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> ClusterIP\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Ingress\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># ADDED</span>\n  <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> demo.dev.rabota.ua\n      <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> wildcard<span class=\"token punctuation\">-</span>tls\n  <span class=\"token comment\"># -----</span>\n\n  <span class=\"token key atrule\">ingressClassName</span><span class=\"token punctuation\">:</span> external\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> demo.dev.rabota.ua\n      <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n                <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n            <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /\n            <span class=\"token key atrule\">pathType</span><span class=\"token punctuation\">:</span> ImplementationSpecific</code></pre></div>\n<p>and to check:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-v</span> <span class=\"token parameter variable\">--resolve</span> demo.dev.rabota.ua:443:20.13.179.68  https://demo.dev.rabota.ua/</code></pre></div>\n<p>also <code class=\"language-text\">kubectl get ing demo</code> should state that it is listening not only port 80 but 443 as well</p>\n<p>to cleanup demo run <code class=\"language-text\">kubectl delete ing,svc,deployment demo -n dev</code></p>\n<h2>Ingress personal certificate per service</h2>\n<p>For this to work DNS record should be precreated and pointing to cluster, otherwise certificate wont be created. Do not forget that domain for this example must be demo.dev. Do not forget that in future access will be allowed only from cloudflare so proxy mode should be turned on.</p>\n<p>In case we need to have a dedicated certificate per service we may do so by applying the following to ingress:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Ingress\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> dev\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> demo\n\n  <span class=\"token comment\"># ADDED</span>\n  <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">cert-manager.io/cluster-issuer</span><span class=\"token punctuation\">:</span> letsencrypt\n  <span class=\"token comment\"># -----</span>\n\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># ADDED</span>\n  <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> demo.dev.rabota.ua\n      <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> demo<span class=\"token punctuation\">-</span>tls\n  <span class=\"token comment\"># -----</span>\n\n  <span class=\"token key atrule\">ingressClassName</span><span class=\"token punctuation\">:</span> external\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> demo.dev.rabota.ua\n      <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo\n                <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n            <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /\n            <span class=\"token key atrule\">pathType</span><span class=\"token punctuation\">:</span> ImplementationSpecific</code></pre></div>\n<p>So technically we are notifying cert manager about the need of new certificate by adding <code class=\"language-text\">cert-manager.io/issuer: letsencrypt</code> annotation to ingress.</p>\n<p>After that <code class=\"language-text\">kubectl get certificates</code> will show our new demo-tls certificate and in few minutes when it will become ready <code class=\"language-text\">kubectl get secrets demo-tls -o yaml</code> will contain our certs (in my case I did not created DNS and realized that only after 7mins of looking around, after adding DNS it took</p>\n<p>All this may be checked the same as before:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-v</span> <span class=\"token parameter variable\">--resolve</span> demo.dev.rabota.ua:443:20.13.179.68  https://demo.dev.rabota.ua/</code></pre></div>\n<p>And to cleanup:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token parameter variable\">-n</span> dev delete ing,svc,deployment demo\n\n<span class=\"token comment\"># certificate will be deleted automaticaly by cert-manager</span>\n<span class=\"token comment\">#kubectl -n dev delete certificate demo-tls</span>\n\nkubectl <span class=\"token parameter variable\">-n</span> dev delete secret demo-tls</code></pre></div>\n<h2>Uninstall</h2>\n<p>Delete all resources (except secrets) created by cert-manager</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get Issuers,ClusterIssuers,Certificates,CertificateRequests,Orders,Challenges --all-namespaces</code></pre></div>\n<p>Delete cert-manager</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete <span class=\"token parameter variable\">-f</span> https://github.com/cert-manager/cert-manager/releases/download/v1.10.0/cert-manager.yaml</code></pre></div>\n<p>Delete namespace</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete ns cert-manager</code></pre></div>\n<h2>Cloudflare Token</h2>\n<p><a href=\"https://cert-manager.io/docs/configuration/acme/dns01/cloudflare/\">https://cert-manager.io/docs/configuration/acme/dns01/cloudflare/</a></p>\n<p>cert-manager</p>\n<p><code class=\"language-text\">xxxxxxxxxxxxxxxxxxxxxx</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> GET <span class=\"token string\">\"https://api.cloudflare.com/client/v4/user/tokens/verify\"</span> <span class=\"token punctuation\">\\</span>\n     <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxx\"</span> <span class=\"token punctuation\">\\</span>\n     <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Content-Type:application/json\"</span></code></pre></div>\n<h2>Command line tool</h2>\n<p><a href=\"https://cert-manager.io/docs/reference/cmctl/\">https://cert-manager.io/docs/reference/cmctl/</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> cmctl</code></pre></div>\n<p>Manual certificate renew</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token parameter variable\">-n</span> dev get certificates\ncmctl status certificate wildcard-tls <span class=\"token parameter variable\">-n</span> dev\ncmctl renew wildcard-tls <span class=\"token parameter variable\">-n</span> dev\n<span class=\"token comment\"># Manually triggered issuance of Certificate dev/wildcard-tls</span>\n`<span class=\"token variable\"><span class=\"token variable\">`</span>\n\n<span class=\"token comment\">## Troubleshooting</span>\n\n<span class=\"token punctuation\">[</span>https://cert-manager.io/docs/troubleshooting/webhook/<span class=\"token comment\">#error-x509-certificate-signed-by-unknown-authority](https://cert-manager.io/docs/troubleshooting/webhook/#error-x509-certificate-signed-by-unknown-authority)</span>\n\nCertmanager website has very detailed troubleshooting guides\n\nExample of troubleshooting dedicated certificate\n\n<span class=\"token variable\">`</span></span>``bash\nkubectl get certificate demo-tls</code></pre></div>\n<p>Shows as not ready for more than 5 minutes</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get cecrtificaterequest</code></pre></div>\n<p>Shows that our request is approved but not ready</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl describe certificaterequest demo-tls-rkn65</code></pre></div>\n<p>Explains what wen wrong, in my case initially I had wrong configuration of ingress so it was not able to find issuer</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Normal  IssuerNotFound   9m40s  cert-manager-certificaterequests-issuer-acme        Referenced \"Issuer\" not found: issuer.cert-manager.io \"letsencrypt\" not found</code></pre></div>\n<p><a href=\"https://cert-manager.io/docs/troubleshooting/\">https://cert-manager.io/docs/troubleshooting/</a></p>\n<p>By mistake in ingress annotation I have asked for issuer rather than cluster issuer, and because there is no such issuer in dev namespace certificate creation process stuck</p>"}},"pageContext":{"id":"93d313ca-a5d2-57e1-899e-327490d67279"}},"staticQueryHashes":[],"slicesMap":{}}