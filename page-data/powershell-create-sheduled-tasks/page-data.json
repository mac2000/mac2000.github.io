{"componentChunkName":"component---src-templates-note-js","path":"/powershell-create-sheduled-tasks/","result":{"data":{"remark":{"fields":{"path":"powershell-create-sheduled-tasks"},"meta":{"title":""},"headings":[{"value":"Powershell create scheduled task"}],"html":"<h1>Powershell create scheduled task</h1>\n<div class=\"gatsby-highlight\" data-language=\"ps1\"><pre class=\"language-ps1\"><code class=\"language-ps1\"># if (Get-ScheduledTask elastic -ErrorAction SilentlyContinue) {\n#     Unregister-ScheduledTask elastic -Confirm\n# }\n\n$action1 = New-ScheduledTaskAction -WorkingDirectory &#39;C:\\Program Files\\Rabota.UA\\ElasticSearchTool&#39; -Execute &#39;ElasticSearchTool.exe&#39; -Argument &#39;1&#39;\n\n$action2 = New-ScheduledTaskAction -WorkingDirectory &#39;C:\\Program Files\\Rabota.UA\\ElasticSearchTool&#39; -Execute &#39;ElasticSearchTool.exe&#39; -Argument &#39;2&#39;\n\n$trigger = New-ScheduledTaskTrigger -Daily -At 8pm\n\n# $trigger = New-ScheduledTaskTrigger -Weekly -WeeksInterval 1 -DaysOfWeek Friday -At 8pm\n\n$principal = New-ScheduledTaskPrincipal -UserID &quot;NT AUTHORITY\\SYSTEM&quot; -LogonType ServiceAccount -RunLevel Highest\n\nRegister-ScheduledTask -Principal $principal -Action $action1, $action2 -Trigger $trigger -TaskName &#39;elastic&#39; -Description &#39;import data into elastic&#39;\n\n# Start-ScheduledTask elastic</code></pre></div>"}},"pageContext":{"id":"e9c50661-91bc-52ac-a2b9-f97d4a8dcaaf"}},"staticQueryHashes":[],"slicesMap":{}}