{"componentChunkName":"component---src-templates-note-js","path":"/google-analytics-realtime-charts/","result":{"data":{"remark":{"fields":{"path":"google-analytics-realtime-charts"},"meta":{"title":""},"headings":[{"value":"Google Analytics RealTime Charts"}],"html":"<h1>Google Analytics RealTime Charts</h1>\n<p>Here is way you can retrieve Google Analytics Realtime report charts:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> casper <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'casper'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">viewportSize</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">1440</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">800</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://google.com.ua/analytics'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Click on Sig In button</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a.secondary-button'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Fill &amp; submit login form</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">thenEvaluate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input[name=\"Email\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'YOUR_USER_NAME_HERE@gmail.com'</span><span class=\"token punctuation\">)</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input[name=\"Passwd\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'****************'</span><span class=\"token punctuation\">)</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Got second screen with question to confirm second email</span>\n<span class=\"token comment\">//casper.thenEvaluate(function() {</span>\n<span class=\"token comment\">//    if(document.querySelector('input[name=\"emailAnswer\"]')) {</span>\n<span class=\"token comment\">//        document.querySelector('input[name=\"emailAnswer\"]').setAttribute('value', 'SECOND_EMAIL@gmail.com');</span>\n<span class=\"token comment\">//        document.querySelector('form').submit();</span>\n<span class=\"token comment\">//    }</span>\n<span class=\"token comment\">//});</span>\n\n<span class=\"token comment\">// Navigate to Realtime report</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">thenOpen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.google.com/analytics/web/?hl=ru&amp;pli=1#realtime/rt-overview/YOUR_ID_HERE/'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Wait for data &amp; save screenshots</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">waitFor</span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#ID-overviewPanelRequestUriTable tr'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span>\n        document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#ID-overviewPanelTrafficSourceValueOrganicTable tr'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">3</span>\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">captureSelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:/inetpub/img1/anal/minute.png'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#ID-minuteChart'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">captureSelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:/inetpub/img1/anal/second.png'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#ID-secondChart'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">timeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Script uses headless webkit to navigate to relatime report and takes screenshots from charts, and saves them to given location</p>\n<p>Required software: <a href=\"http://phantomjs.org/\">phantomjs</a>, <a href=\"http://casperjs.org/\">casperjs</a></p>\n<p>Both are portables so you do not need to install anything.</p>\n<p>In our case we are running this script each minute to save fresh chart images, which then used in alert mails if something is wrong to determine is alert false or not.</p>\n<p>Here is how it looks:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0358df1e31b0189cd4a0314969fd992c/466da/anal.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 117.96875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADoUlEQVR42qVU328UVRS+QQkJbwomEhJJIGjib0gEfaCE1viC+Gj8O3zxSVG7WhMloDEEKtrWGgqKGNREG6yBpKLUbbtlt7AtAep2Z2d3Z3Z3dubOnTs/P3Pv7Gx3aerPm3y535lz7znfmdxzCABEUSQ21N06Dl0+hH0X96F3ohd9E8/LPUHfRB8O/HRA8p6LPTh46SAUpsi7YRTKnYhgiaEyFRvPbgQZJrhnbD2e/mE3Xrr8Ip4dfw6Pff8odn63E1u/2QryBQEZIdhwZgNumje7A6JjlZ0y7h1bDzJEQEYJtl3Yjj3jz+DB81vwwNebsOncZtx/7j6Qz4k8s+70uq6AQhxxmAOLUtiUocEMHM0fRSqbwru5AfRnUzh87U28ne3HW9l+aadyKQzMDyCVewdHbhyRv6kroO958BwHrk2BMMR/W1GbEcZdlC0Hiw2OfI2hyTmWTRu3DYp8zUJOM7FQsyRfrFtoOBy250KzHcmZF8DxA5QsDu4HIBWLY0G3Ma/ZuK4z/KqYmK1QXKvamNeZTJLTYr/ATJliSrUwVYpxtWThl6KJTIXCDUIQzWQoNRmqtocKdbtQTXbbQ5V6ci9ZroT4Xu6AsH0RULc9KKaLEhWH/x4qjbHa58IPo1hh0bBbmXlbwVpQ1vpu8rhk3Y6NJMv/gXw2muWgaDCo1IUqHGasUu04qHbYa3EhSmceiEY5ik0HSwaXUG0fiuWhYLoomnGJdxoOCk0uudj/MFb4UosvmxyLNQZC3QAG91F3PFRNhqphQa2bUPQm6jaH4XjQKUeDuZLXbVci4TXmosl9GI4v32RXL0dBAO4wMEpBLUuMoX/dM3LatHF3Q3X6/iFI5zwMhELOpR2GocRfXU78nclJp5qkzQWND6CtPPneOQ6ilctt3q1QZAz8lr2CWEkoL4ozQcuO1lTYUiMuFxo2giiST6HGPNxqOK1kkeyEZIVy0ke4u0KSOMUS7+7Vn+/g/atFvHwhj9cuLeGjdAmjuQq+yms4llZwpdjESLaCD9MKfrxdx1KTr1Yomlqs8Vs6nvw0jaeGM3hiaBYvfDmPV75dwK7hDPaOzmHXSAY9p7PYMzqH/WNZ9J7J4fyi3q5gVcCzNzRsOf47Hj41g4dOpLF7ZE5i28lpPHJqBo9/Novtg9PYMTgt+eaPpzCUrawOmJScrdqyxP4ry3h9soDjMyo+mFLwxmRB/oZP5srSd3iygMFMGe/9VpQDOYkhAv4JsIfIiLYJhekAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Example\"\n        title=\"\"\n        src=\"/static/0358df1e31b0189cd4a0314969fd992c/466da/anal.png\"\n        srcset=\"/static/0358df1e31b0189cd4a0314969fd992c/6f3f2/anal.png 256w,\n/static/0358df1e31b0189cd4a0314969fd992c/466da/anal.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>"}},"pageContext":{"id":"68ae52bc-e0b4-5038-ac1f-fe647e388b16"}},"staticQueryHashes":[],"slicesMap":{}}