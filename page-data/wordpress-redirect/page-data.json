{"componentChunkName":"component---src-templates-note-js","path":"/wordpress-redirect/","result":{"data":{"remark":{"fields":{"path":"wordpress-redirect"},"meta":{"title":""},"headings":[{"value":"WordPress redirect"}],"html":"<h1>WordPress redirect</h1>\n<p>In sample code, we have posts of category \"task\", that have \"author\" custom field, and redirect not logged users or users that not assigned to this task.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">test_redirect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_single</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">global</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">global</span> <span class=\"token variable\">$current_user</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$current_post_categories</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_post_categories</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token constant\">ID</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$is_task</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;--</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_cat_id</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'task'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$current_post_categories</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$is_task</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token variable\">$author</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_post_meta</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token constant\">ID</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Author'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;--</span>\n        <span class=\"token variable\">$current_user_login</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;--</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$current_user</span><span class=\"token operator\">-></span><span class=\"token property\">data</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$current_user_login</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$current_user</span><span class=\"token operator\">-></span><span class=\"token property\">data</span><span class=\"token operator\">-></span><span class=\"token property\">user_login</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$is_task</span> <span class=\"token operator\">==</span> <span class=\"token constant boolean\">true</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$author</span> <span class=\"token operator\">!=</span> <span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$current_user_login</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$author</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$current_user_login</span> <span class=\"token operator\">!=</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">wp_redirect</span><span class=\"token punctuation\">(</span> <span class=\"token function\">get_bloginfo</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'siteurl'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/notallowed/'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'template_redirect'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'test_redirect'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Also <code class=\"language-text\">template_redirect</code> can be used to assign custom template files. See: <a href=\"http://www.mihaivalentin.com/wordpress-tutorial-load-the-template-you-want-with-template_redirect/\">http://www.mihaivalentin.com/wordpress-tutorial-load-the-template-you-want-with-template_redirect/</a></p>"}},"pageContext":{"id":"4db15c89-201a-5d47-8c68-0750b5ac3c7d"}},"staticQueryHashes":[],"slicesMap":{}}