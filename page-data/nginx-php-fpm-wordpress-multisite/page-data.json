{"componentChunkName":"component---src-templates-note-js","path":"/nginx-php-fpm-wordpress-multisite","result":{"data":{"remark":{"fields":{"path":"nginx-php-fpm-wordpress-multisite"},"meta":{"title":""},"headings":[{"value":"Nginx, php-fpm, wordpress multisite"}],"html":"<h1>Nginx, php-fpm, wordpress multisite</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mysql-server mysql-client\n<span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> nginx\n<span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> php5-cli php5-common php5-mysql php5-suhosin php5-gd php5-dev php5-fpm php5-cgi php-pear php-apc\n<span class=\"token function\">touch</span> /etc/nginx/sites-available/example.com\n<span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /etc/nginx/sites-available/example.com</code></pre></div>\n<p><strong>/etc/nginx/sites-available/example.com</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n    server_name *.example.com;\n    index  index.php index.html index.htm;\n    charset utf-8;\n    root /var/www;\n\n    location / {\n        try_files $uri $uri/ /index.php?$args;\n    }\n\n    rewrite /wp-admin$ $scheme://$host$uri/ permanent;\n\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico)$ {\n        expires max;\n        log_not_found off;\n    }\n\n    rewrite /files/$ /index.php last;\n\n    set $cachetest \"$document_root/wp-content/ms-filemap/${host}${uri}\";\n    if ($uri ~ /$) {\n        set $cachetest \"\";\n    }\n    if (-f $cachetest) {\n        rewrite ^ /wp-content/ms-filemap/${host}${uri} break;\n    }\n\n    if ($uri !~ wp-content/plugins) {\n        rewrite /files/(.+)$ /wp-includes/ms-files.php?file=$1 last;\n    }\n\n    if (!-e $request_filename) {\n        rewrite ^/[_0-9a-zA-Z-]+(/wp-.*) $1 last;\n        rewrite ^/[_0-9a-zA-Z-]+.*(/wp-admin/.*\\.php)$ $1 last;\n        rewrite ^/[_0-9a-zA-Z-]+(/.*\\.php)$ $1 last;\n    }\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        include fastcgi_params;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_pass 127.0.0.1:9000;\n    }\n}</code></pre></div>\n<p>Пример взят от сюда: <a href=\"http://codex.wordpress.org/Nginx\">http://codex.wordpress.org/Nginx</a> с той лиш разницей что этот будет работать из коробки.</p>\n<p>После этого, все по <a href=\"/663/\">мануалке</a></p>\n<p>Добавление еще одного языка:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /var/www/wp-content/languages/\n<span class=\"token function\">wget</span> http://svn.automattic.com/wordpress-i18n/uk/tags/3.3.1/messages/uk.mo\n<span class=\"token builtin class-name\">cd</span> /var/www/wp-content/themes/twentyeleven/languages/\n<span class=\"token function\">wget</span> http://svn.automattic.com/wordpress-i18n/uk/tags/3.3.1/messages/twentyeleven/uk.mo</code></pre></div>\n<p>Нужно не забыть выставить права 777 на папки uploads и blogs.dir</p>\n<p>Создать базу для wordpress'а из консоли:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">mysqladmin <span class=\"token parameter variable\">-u</span> root <span class=\"token parameter variable\">-p</span> <span class=\"token parameter variable\">-v</span> create example</code></pre></div>\n<p>Идея была в том чтобы сделать многоязычный сайт на базе multisite.</p>\n<p>Ссылки по теме:</p>\n<p><a href=\"http://codex.wordpress.org/Multilingual_WordPress\">http://codex.wordpress.org/Multilingual_WordPress</a></p>\n<p><a href=\"http://codex.wordpress.org/WordPress_in_Your_Language\">http://codex.wordpress.org/WordPress_in_Your_Language</a></p>\n<p><a href=\"http://svn.automattic.com/wordpress-i18n/\">http://svn.automattic.com/wordpress-i18n/</a></p>\n<p><a href=\"http://codex.wordpress.org/Installing_WordPress_in_Your_Language\">http://codex.wordpress.org/Installing_WordPress_in_Your_Language</a></p>"}},"pageContext":{"id":"1e787c5c-0f94-5d54-a51b-1343ab3b421b"}},"staticQueryHashes":[]}