{"componentChunkName":"component---src-templates-note-js","path":"/interactive-brokers-google-sheets/","result":{"data":{"remark":{"fields":{"path":"interactive-brokers-google-sheets"},"meta":{"title":""},"headings":[{"value":"Interactive Brokers Google Sheets"}],"html":"<h1>Interactive Brokers Google Sheets</h1>\n<p>Receive almost any data from IBKR right inside Google Sheets</p>\n<h2>What</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 908px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.34375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABD0lEQVR42jWPaY6DMAyFuf955gL9jwSUpQqFQmECnVCFtaUsyZtgzVh6svycfLYtKSVk2+KIdV2xLAumacLhR1GELMtxiS5I0htmWUD1d+yjQNEWiESE8llCK419VySrH0e8329c+QT2A9jXAd59RSZWGjLPM/W3bcNupJTC5zOb2gxfF2itTf0xsJ3eW+zewc9fODklvk4+bPZEKrQB9zifz0iSxHxYCJTnOcIwRJqmBDqu8H0fcRyTjossXjf4riUCliHOOET7QtO9cKsGiKdE33W0ZVVVaJqGYK7rkg7vgAZBANu2CW5N02jWX1CWBeqK4z+0Vn9ZUx6GgcCccziOA8/zIISg3uPxII8xhl9AkXYNbd0mgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"what\"\n        title=\"\"\n        src=\"/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png\"\n        srcset=\"/static/85caf83ec588a24d42177ac3cc1b54ea/6f3f2/1.png 256w,\n/static/85caf83ec588a24d42177ac3cc1b54ea/01e7c/1.png 512w,\n/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png 908w\"\n        sizes=\"(max-width: 908px) 100vw, 908px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Why</h2>\n<p>DYI portfolio tracker, dividends calendar, trades profitability calculation, ...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51b5d898ed29ea4e4f15741182e79321/169e3/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.203125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADSUlEQVR42i2S3W+TZRjG+1eY6IH4sQWikwgxYGI8IMbEmIgcGAKaSEw8VQIEJzHgByxzGkLAAyZiugnbYOu6rd2KXffR9u0nXbuu7baWbbRdu3Zr967v24+13dfPR/Tgl/u5n4M7131dt6a1pY3rv97gSssNBo2jkA6z+PdDIt4pViN+ktNesrMBNiZ7KM3YKKZiJMe7eGrtJ24fYFnSEx/vYWmiD9l2D81zLzTyxutNvHLoMGfPNxNP5DEMmHBP6ulyGAjadfhsQ3T+8TuSsRfXdIyWW/fpHZGwuwJIDh+S08cjiwOz2YLmvRMneevIMU41NXC19RKJTAGr2Uh6sh27U6jwDrHg0DH6QMvChJ5QssCdfjvW0Ar+Jzkez6Zxh5J4FlWcsXU0H79zgNMfHebEkRf55aeLROIpOkwSoZ6bhLtv4bI5sAXjTETWCKXLJLPrXL3dh3Z8kaDHy5R5kJlBLY55GadAc/z4KX77+TSfX/iE9q52UtF5/JMWUp4x4pZe4Y1QKJmZc0tklxZIz83Qf/s6UVMnmfG/SFs6yIx1sjJ2j5WJbjRruVUKShFVUdna2qIqr5PLpERfoF6viz9BvcZ2bZMtQW1jnYqcoVqU2VQFolaLG/9XsXKtUqVULFOt1tjZ3mZnZ5fd3T329uDOXS3fXLrM5R+u8d3313BPTeH2eUUILpwu93+4PThcLuwONwW1hKbbcJ+h0X4MlkEGRodEejp0j/T4wwFOfvoZz7/cQMP+A+xrfBXDiJGFeBRXwMPjoA9X0IMnYCEaCzM950cpqmj6HFdwei4w6m1F67Vz122nY8aHNRrhy4vfsu/QUV47eJCX9jdiMo2QziwTjsWYjcaY8NmQQhaWUwlmF8PCugKa5fiflAqtpGUtk/IG4zmZMeHpXKnMmTNf8O77R/ng2Nt8+GYTA8PDZPIpFhLzhJ8EWErH8Hhs+HxOwk/nqVQ20STmTeTWdGRlKxFVISSGBgsF0uUyN9vaOHvua5rPfcWPzeeRbHaG9L08HHyAfliHTbIzZhzGbDRiFe9sXihcy8vk84pItUxRJK2IYUpBYVukW1UUsYb6jEqtzp64Anl1jaIIsVyuoKgqaqn0jH8vobq1yz8nAAfoVXWVAQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"why\"\n        title=\"\"\n        src=\"/static/51b5d898ed29ea4e4f15741182e79321/2bef9/2.png\"\n        srcset=\"/static/51b5d898ed29ea4e4f15741182e79321/6f3f2/2.png 256w,\n/static/51b5d898ed29ea4e4f15741182e79321/01e7c/2.png 512w,\n/static/51b5d898ed29ea4e4f15741182e79321/2bef9/2.png 1024w,\n/static/51b5d898ed29ea4e4f15741182e79321/71c1d/2.png 1536w,\n/static/51b5d898ed29ea4e4f15741182e79321/169e3/2.png 1682w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>How</h2>\n<p>Step 1: Enable Flex Web Services under Settings menu, copy token</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e86a7d5f26fd9529baba06bd72476747/65781/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnUlEQVR42lWRT2/TQBDF/WH5FCBxQJRLVakSlyhNgpKUikMOFRc4cKjUG4JTBbSIqAKbNk7s+F/ttb1e/xhvkkaM9DQ743lvx2+dQX/EYPiGwfiUs3czTianjCdnjKZvpTdlOJoyGE0sToYT+oLe0TGvXx1y/vIFFwfP+TSb8exwzJOnfRxdVbRaY9oWG5KNMZJaWpvZnFs5d59lnpWPigvUOqMOwq7LfGX4cqtxgrTkb1BQqIq6ri0qIT3kOUmakglqqSvdUMcR6t7D95dE0s+VIi9Ly+lEu4udMK1wlwVlbXYLst3VDhRCsnUSQbymEWHX9VgsfEpVcr9KqerGzhsjgnGSyY0BKi9om0agN9Da1loETeDTpoklaendBRndIoVw1lFKYwy7cFZX33C/XhH/+I76dUNz+xO9hZpfE36+xCy8R4KuEpaLOcswIc+VWKNEsN0LrsXcWHw03Ua6lrxHWeRkcWwfZxfGyNa6lFP3m4a9QVvBVG6I4gS19eo/iIeVGL555Q3hLiw5Ov9N76NH74PH8fs/uIF69Pwfx2FVnHwZ32wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"enable flex web services\"\n        title=\"\"\n        src=\"/static/e86a7d5f26fd9529baba06bd72476747/2bef9/3.png\"\n        srcset=\"/static/e86a7d5f26fd9529baba06bd72476747/6f3f2/3.png 256w,\n/static/e86a7d5f26fd9529baba06bd72476747/01e7c/3.png 512w,\n/static/e86a7d5f26fd9529baba06bd72476747/2bef9/3.png 1024w,\n/static/e86a7d5f26fd9529baba06bd72476747/71c1d/3.png 1536w,\n/static/e86a7d5f26fd9529baba06bd72476747/a878e/3.png 2048w,\n/static/e86a7d5f26fd9529baba06bd72476747/65781/3.png 2778w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Step 2: Create Flex Query under Performance &#x26; Reports menu</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cf9f3f08139a6245b8afbc4c525ae017/efb68/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.32812499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyklEQVR42p2R6wqCQBCFff/nCQoKegL/FIS7klrGikmotV725mlXIZDohx34ZmCWPRxmvM12j1N4g38I4R9D0IghSgucr/dFhEmO1XoHL45jOA1G418NwzD2OIrgEUqQPziKskUvDNpez2i6qQshIaWCUvoLN3cKggCeK079+ME+qjnCzpTWMOY3Wk+GhBCb0BbGMiSsRMUFOqFsomU0nUQvDSilk+ElZUiy2hpK8FbhtZBnI9HYtXwSOtV1Bc75uOClGGPg7uISvgESOBpCYbiqZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create flex query\"\n        title=\"\"\n        src=\"/static/cf9f3f08139a6245b8afbc4c525ae017/2bef9/4.png\"\n        srcset=\"/static/cf9f3f08139a6245b8afbc4c525ae017/6f3f2/4.png 256w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/01e7c/4.png 512w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/2bef9/4.png 1024w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/71c1d/4.png 1536w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/efb68/4.png 2032w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Step 3: Create Google Sheet with App Script</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/e2d3b/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.59375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABUElEQVR42m2P22rcMBRF/f9/0vahD4FCIYE+zVMDodCQC6GJ4xlLHvmi8VWy7NUjhymEVLA5OtrS2kfJnX4hSw+k2Z6X12zTsayxbc/oZkYfGJqG7vGe9umRIUsZJ4+bV9HyQclv9YxWJVmu2ecFr3uFPlaooqQwFcfTgP51w5+vn7i7+o66/IZVCuHhJcwLJMrJfhIlphoo6pG9bshUI9WSmxZjJ3TVbzoUDfrhHnXxBdtY/rec8+iyJfFhYZgc/TBKUpCkeUuLqXPsAwzdSPlzR37xmerhlpA+wRLeAUN4e5v0fU/UNI4CEJhzYs4CnJm9o3Ur6bPB7q4wN9cUux/01zvERH7Nuq6blmXZ3iedwE6nE4MA4+HZfHdRftF2DpMfsKURyvJvsvO9CItTJrE5G/EgAs71TWHrbdthqpqybmispZa9lRq9uLz324R/AY55GQ/NGbVCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create google app script\"\n        title=\"\"\n        src=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/2bef9/5.png\"\n        srcset=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/6f3f2/5.png 256w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/01e7c/5.png 512w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/2bef9/5.png 1024w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/e2d3b/5.png 1466w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Paste code and deploy</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/65ef80a61ba682acb9fcc1c509b4317c/2cda4/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.70312499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbElEQVR42mWS226DMBBE+f+PavvU10jtU6VWyo0EMGB8xeY23TVEaVJLw2Jkjsezzozu4LxHCD2MMdDaYJomLMuCeZ5TXecz7mPZtL6/vnzg/W2HmO+RKR3QqAAbAONHgvdwfY8QB0TSMIzwfaANI8ZxetDAihHi+wunzx3U/geZcR7KWEzzQoAR2jmc2xJl16A1OqlzFto7KKqdtWmNomroG2+sidERw4WALNDjNviIvPhQX7AXOQ7iSrrgSLpKgVxWEFpCKImiqyGtJijBrCHpdLqM87kDl7RzTg4vbYVTUyRQTTnzz6zVpUmyFE1PUdzEbjMO/S9QW4eCIAxiF6VqUKk2zTmGG4hz5mw5pkg5p0r6B2SHx/qacmSn583luVlzZbcMZacM9hSZI/Ba+0fgQkBJV4dzK9s1o9SArQncELnBbuLG8BrOkhv85HCmjntUokVT0PFEh6qqIRoJ6+iekqyP6SrFZ21H/gXmbLYKtP/wKAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"code\"\n        title=\"\"\n        src=\"/static/65ef80a61ba682acb9fcc1c509b4317c/2bef9/6.png\"\n        srcset=\"/static/65ef80a61ba682acb9fcc1c509b4317c/6f3f2/6.png 256w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/01e7c/6.png 512w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/2bef9/6.png 1024w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/71c1d/6.png 1536w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/a878e/6.png 2048w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/2cda4/6.png 2946w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a856ecd526225b31ed719164f568697f/eb1d2/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.515625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACJ0lEQVR42pWTy3LTMBSG87I8BSvW3bBLYShdsGBYBdLEiZ2LcykPwDMw0ya4seOLbFmW9XOO7JKGhAKa+efIivzlPxd33l1dw5vM4DhjjEYuPG+C+XyB2dy34v3fNJv5WK+/4vLyLTr+cgkDIE1TZJmAlBL/u+q6tpENdcauByFyJEliD4uisPsgCBCGIaqqgtb6WfGdutbofe6jM/V9CxFCWKAxBoUssNlukcSJfWYHz4mBjcNxk/JT27wUXcjIdU5/VFAJKnZCv/9JqgXeDB10FqvVCZABeS6oromV1k1KLEP3fpdugUNndOzQmAYoZYlNEEIqgrDjmmVQVueVl/rQlMVqfQC2DtNCY7fPEcYsgShp9kJq8LuyOqhQBKRz9tjru8cpPwKFrLHdpdg8JLgPYoox7n5E2BE0Fgr7TLaxREZ32YCi977cEHB+pinctV0Y4WEXUQ0FNaakBkmIvLDNYtl9ntuGlErZ9/jjONtlBgqRIY5jqPYyrP9TGVPbpvHqDwbngWVFKYcFthErxyZkCdyHJe5CjSDWCDNS2sQgUZDEHziU8nJ1ewLUuqb6KESZspFrtU9LemYIkBRU55Jr3cQkr9uxIaC/WP1K83HyNc0bDdhxejxTfGZqm6axvzeR59PWkL+UxXJ94vBfVqmbmfj2XePFB4GXQ+D9JwJ231xhNp1bOg/maMzySBM6c210vemJBo5n9bHn4lV3gItrDxevu/gJPOCyrYDVpm4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"deploy\"\n        title=\"\"\n        src=\"/static/a856ecd526225b31ed719164f568697f/2bef9/7.png\"\n        srcset=\"/static/a856ecd526225b31ed719164f568697f/6f3f2/7.png 256w,\n/static/a856ecd526225b31ed719164f568697f/01e7c/7.png 512w,\n/static/a856ecd526225b31ed719164f568697f/2bef9/7.png 1024w,\n/static/a856ecd526225b31ed719164f568697f/71c1d/7.png 1536w,\n/static/a856ecd526225b31ed719164f568697f/eb1d2/7.png 1622w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>New function should appear</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1022px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.34374999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACVklEQVR42oVT7W6cMBC81+4z9F36t1KlSG3yo6nSRlGTntR89OhdjgPMp7Ex2MB010CSiyLV0tz6WBjP7K5XUtZouxbACGs7tK1BVVbYbAKE+xABRZEWGEZ6g37GARhexAXGtOj7HitZ10jzAnXTI5ctSmUJCkkpIKoUMcVtFuLmcItcl1Bdg7pVkEb5qDpN+xq3D3dQWmFlGoWHvcTJ+R3OLu9x8vU3roIHfA6+4cufC5wF3/Hh1ye8+/gep8EFfuxvsBb3OKXcdXyLy3CNi901sqZEPwxY2a6DMhaFcqi0Q1n3SOoSV/s1zjdXCLJHhFUMoXLsihB/8z22eYhdefD/IyUQaYGcCMdxxKoxBh2Rcg0XmM4gTTMURYFIJDgkMeJU4BBHhBhhFEFkVA7KtfRtP/RoXUe1JIVN01AjuucC94NPprpAYw3+u2YdtnczISnkU1jugta2+LlZU20DZFmOiFTleU7dTj1SgpTyiPeJkO1aa48I2XIcJShpfNiB1nqODXVS04gYTM5a//4RoX6RWNAQ4fZxj6IsPVlNo6VolDhWlQS74vmtqsqT8DI0yxPhfOJry4dDhDhJfM45510weN/N+2XxQBe1nLq8yD8m7DxZIgSpmpTxwRXVbVIm/fMjQvmC8C2F2+3Oq8zpFrE1jn5PHzK4vnImYauVqidC3WhfaH64wBAhd5YJsyzznWW1QqTkxpAi562zsmV1vZ3u8mT5lUJn/eDyqQMNmaPB7cfex7fAJWJXXiGr069qyKezUr4BvHdzM6xzTw1y7lkli1pG7x8AIoOuM6B1SQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fn\"\n        title=\"\"\n        src=\"/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png\"\n        srcset=\"/static/fd3fd5d642b9357885ba435ed5866c16/6f3f2/8.png 256w,\n/static/fd3fd5d642b9357885ba435ed5866c16/01e7c/8.png 512w,\n/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png 1022w\"\n        sizes=\"(max-width: 1022px) 100vw, 1022px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Ideas</h2>\n<p>You may want to:</p>\n<ul>\n<li>join IBKR with GOOGLEFINANCE</li>\n<li>get additional data from finviz, yahoo finance, ...</li>\n<li>build dividends calendar</li>\n<li>...</li>\n</ul>\n<h2>IBKR FLEX QUERY</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * IBRK Flex Query.\n *\n * From IBKR side you need enable flex service - this can be done in \"Flex Web Service\" in settings menu.\n * While enabling flex service - copy your token.\n * After enabling flex service go to \"Flex Queries\" under \"Performance &amp; Reports\" menu and create one.\n * Each created report will have its own query id - copy it as well.\n * Keep in mind that this function will grab only first section of report, so if you want multiple sections just create multiple queries.\n * The report retrieval is done in two steps:\n * - step 1: request report generation, requires token and query id, will return report code and url\n * - step 2: retrieve generated report\n * Notes:\n * - when you prepared your report it is a good idea to enable cache so everything will work much faster\n * - if report is really huge try to increase to something like 5 seconds\n *\n * @param {number} token Token from Settings \\ Flex Services menu.\n * @param {number} query Query ID of Flex Query from Reports \\ Flex Query menu.\n * @param {bool} headers Add header names to result. Default TRUE.\n * @param {bool} cache Cache results for 6 hours which is maximum for Google Sheets. Default FALSE.\n * @param {number} sleep Report generation takes some time, so we are waiting given amount of milliseconds before proceeding. Default is 2000 which is 2 seconds.\n * @return Query results.\n * @customfunction\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token constant\">IBKRFLEXQUERY</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">token<span class=\"token punctuation\">,</span> query<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> cache<span class=\"token operator\">=</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> sleep<span class=\"token operator\">=</span><span class=\"token number\">2000</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Step 0: optional, return cached results</span>\n  <span class=\"token keyword\">var</span> cacheService <span class=\"token operator\">=</span> CacheService<span class=\"token punctuation\">.</span><span class=\"token function\">getDocumentCache</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> cacheKey <span class=\"token operator\">=</span> token <span class=\"token operator\">+</span> <span class=\"token string\">\".\"</span> <span class=\"token operator\">+</span> query<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">&amp;&amp;</span> cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Step 1: request report generation</span>\n  <span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.SendRequest?v=3&amp;t=\"</span><span class=\"token operator\">+</span>token<span class=\"token operator\">+</span><span class=\"token string\">\"&amp;q=\"</span><span class=\"token operator\">+</span>query<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> xml <span class=\"token operator\">=</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContentText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> root <span class=\"token operator\">=</span> XmlService<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRootElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> code <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ReferenceCode\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  url <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Url\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Utilities<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>sleep<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Step 2: retrieve generated report</span>\n  url <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> <span class=\"token string\">\"?v=3&amp;t=\"</span><span class=\"token operator\">+</span>token<span class=\"token operator\">+</span><span class=\"token string\">\"&amp;q=\"</span> <span class=\"token operator\">+</span> code\n  xml <span class=\"token operator\">=</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContentText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> nodes <span class=\"token operator\">=</span> XmlService<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRootElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FlexStatements\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FlexStatement\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> node <span class=\"token keyword\">of</span> nodes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// optional: add headers</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> items<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">getAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">attr</span> <span class=\"token operator\">=></span> attr<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">var</span> item <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> attr <span class=\"token keyword\">of</span> node<span class=\"token punctuation\">.</span><span class=\"token function\">getAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> text <span class=\"token operator\">=</span> attr<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^-?[\\d,\\.]+$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        item<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        item<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    items<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Step 0: optional, store results in cache for subsequent requests</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>How it works</h2>\n<p>Two step process:</p>\n<ol>\n<li>Send request asking to generate report</li>\n<li>Retrieve generated report</li>\n</ol>\n<p>Suppose we have an query with id <code class=\"language-text\">866660</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">TOKEN</span><span class=\"token operator\">=</span><span class=\"token string\">\"1417**************\"</span>\n<span class=\"token assign-left variable\">QUERY_ID</span><span class=\"token operator\">=</span><span class=\"token string\">\"866660\"</span>\n\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Content-Type: application/x-www-form-urlencoded\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"q=<span class=\"token variable\">$QUERY_ID</span>&amp;v=3&amp;t=<span class=\"token variable\">$TOKEN</span>\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.SendRequest\"</span></code></pre></div>\n<p>Response will be something like</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatementResponse</span> <span class=\"token attr-name\">timestamp</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>14 October, 2023 03:57 AM EDT<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Status</span><span class=\"token punctuation\">></span></span>Success<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Status</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ReferenceCode</span><span class=\"token punctuation\">></span></span>5045169185<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ReferenceCode</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Url</span><span class=\"token punctuation\">></span></span>https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.GetStatement<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Url</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatementResponse</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>From response we will receive url and reference code to download generated report</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Content-Type: application/x-www-form-urlencoded\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"q=5045169185&amp;v=3&amp;t=<span class=\"token variable\">$TOKEN</span>\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.GetStatement\"</span></code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>depending on report size it may require some time for generation to complete</li>\n<li>url is different and taken from response</li>\n<li>instead of query id we passing reference code</li>\n</ul>\n<p>Sample response</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexQueryResponse</span> <span class=\"token attr-name\">queryName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>portfolio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>AF<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatements</span> <span class=\"token attr-name\">count</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatement</span> <span class=\"token attr-name\">fromDate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-13<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">toDate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-13<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">period</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LastBusinessDay<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">whenGenerated</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-14 03:57:57<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPositions</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPosition</span> <span class=\"token attr-name\">symbol</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VZ<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">position</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPosition</span> <span class=\"token attr-name\">symbol</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>XRX<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">position</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>4<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>OpenPositions</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatement</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatements</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexQueryResponse</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>just for simplicity have removed everything, in your flex query you may add ass many fields as you want, aka prices, p&#x26;l, market value, price change and so on</li>\n<li>with flex query you may receive not only positions but also trades history, dividends, taxes and many many more</li>\n<li>flex queries are not supposed to receive input parameters so if you need YTD data just set it while creating query</li>\n</ul>"}},"pageContext":{"id":"d9cdb07b-da88-538a-8ce2-a4285407a309"}},"staticQueryHashes":[],"slicesMap":{}}