{"componentChunkName":"component---src-templates-note-js","path":"/interactive-brokers-google-sheets/","result":{"data":{"remark":{"fields":{"path":"interactive-brokers-google-sheets"},"meta":{"title":""},"headings":[{"value":"Interactive Brokers Google Sheets"}],"html":"<h1>Interactive Brokers Google Sheets</h1>\n<p>Receive almost any data from IBKR right inside Google Sheets</p>\n<h2>What</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 908px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.34375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABD0lEQVR42jWPW46CQBBF2f96ZgP+kyCCGBAEYUCnMbyVR0OfCZ2ZSm4quVU5VdeoqoqqrtlrWRbmeWYYBnbf8zziOOHiXQijG2OVsrV31l6Q1ime8MheGWpTrOumZbR9z+fz4ZoP+D9gXjvs+0IsFn1kHEc9l1KySsm2bUzTiJQL8zKjlGKaJtZ11fuGf29wkjcHK+Pr4GD6LyKhMK8tp9OJMAyZplmDkiThfD4TRZEG7SkcxyEIAq09kZE/Sr4fFa4fE8Q5on5TNm9uRYd4VbRNo78sioKyLDXseDxq7d4OdV0X0zQ13BiGHilnsizlUeT8l1LbX1e6d12nwXmeY1kWtm0jhNCz5/OpPd/3+QVAkXYNQLv9dwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"what\"\n        title=\"\"\n        src=\"/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png\"\n        srcset=\"/static/85caf83ec588a24d42177ac3cc1b54ea/6f3f2/1.png 256w,\n/static/85caf83ec588a24d42177ac3cc1b54ea/01e7c/1.png 512w,\n/static/85caf83ec588a24d42177ac3cc1b54ea/a2b88/1.png 908w\"\n        sizes=\"(max-width: 908px) 100vw, 908px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Why</h2>\n<p>DYI portfolio tracker, dividends calendar, trades profitability calculation, ...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51b5d898ed29ea4e4f15741182e79321/169e3/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.203125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADRUlEQVR42i3S209bBQCA8fNXmOiD8wLZori4xWwmxofFmBgT5x7MsmniYuKrLtsycTGbl40gmmXZfBjOmYIbsEEplEJnKZT2nF5XWkpbaLvCCrSUSzmcS1t64fIZpw+/fP/AJ7S2tHH91xtcabnBoGUUcjHm/n5IPDDJajzE4lSAlZkwmxM9FKdd6NkUi+NdPHX2kxEHWJJMZMZ7mHf0IbvuITz3QiNvvN7EK4cOc/Z8M5mFAkMDVnwTJrrcQ0REI0GXmc4/fkey9OKdStFy6z69IxKiN4zkDiJ5gjyyu7HZ7AjvnTjJW0eOcaqpgautl1jIKzhtFnIT7YiefjIBM2m3kdEHBtIOE9FFhTv9Is7oMqEn6zyeyeGLLuKf0/CkNhA+fucApz86zIkjL/LLTxeJZ7J0WCWiPTeJdd/C63LjimRwxNeI5kosrmxw9XYfhvE5Iv4Ak7ZBpgcNuBMynoSMcPz4KX77+TSfX/iE9q52sskEoQk7Wf8YGXsv8w4zacnGrE9iZT5Nbnaa/tvXSVo7yY//Rc7eQX6sk+Wxeyw7uhHW1ldRVB1N1ajX61TkDdbzWTRVoVarUa/XqNeqbFe3qFe3qG5uUJbzVHSZLU1mS5ep6Jv/dwOhWq5Q1EtUKlV2trfZ2dlld3ePvT24c9fAN5cuc/mHa3z3/TV8k5P4ggEkjxeP1/cfnx+314vo9qFoRYTuofuYR/sZsg8yMGqmd8SI8ZGJUCzMyU8/4/mXG2jYf4B9ja8yNGIhnUniDft5HAnijfjxh+0kUzGmZkOouobQ576Cx3+B0UArhoDIXZ9Ix3QQZzLOlxe/Zd+ho7x28CAv7W/Eah0hl18ilkoxk0zhCLqQonaWsgvMzMVQVAVhKfMnRaWVnGxgQt5kfF1mTNWZLZY4c+YL3n3/KB8ce5sP32xiYHiYfCFLeiFB7EmY+VwKv99FMOgh9jRBubyFsJCwsr5mZEV2EtdUovImEUUhVypxs62Ns+e+pvncV/zYfB7JJWI29fJw8AGmYSMuSWTMMozNYsEpiawUFIS1gkyhoKKpJXRVQ1UUVEVlu16joqooqvZMuVpjr15HXl1D10uUSmVUTUMrFp/594RKfZd/ACcAB+hMKXYyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"why\"\n        title=\"\"\n        src=\"/static/51b5d898ed29ea4e4f15741182e79321/2bef9/2.png\"\n        srcset=\"/static/51b5d898ed29ea4e4f15741182e79321/6f3f2/2.png 256w,\n/static/51b5d898ed29ea4e4f15741182e79321/01e7c/2.png 512w,\n/static/51b5d898ed29ea4e4f15741182e79321/2bef9/2.png 1024w,\n/static/51b5d898ed29ea4e4f15741182e79321/71c1d/2.png 1536w,\n/static/51b5d898ed29ea4e4f15741182e79321/169e3/2.png 1682w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>How</h2>\n<p>Step 1: Enable Flex Web Services under Settings menu, copy token</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e86a7d5f26fd9529baba06bd72476747/65781/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABm0lEQVR42lWRzW/TQBDF/cfyV4DEAVEuVaVKXKLUCUpSKg45VFzgwAGJWwWnik8RVRDTxomT2Ouu1/v5Q3acFkZ62pnVvLdvZ6K4PyQevCAenXL2asrJ+JTR+Izh5CXxaMJgOCEejlucDMb0B2N6R8c8f3bI+dMnvD94zLvplEeHIx487BNZrQnW4kOgjRDw3hNCILQnuzx4mo6gNaxSVF6hNiUmWze3zFaej1eWKBM1f7KKSmmMMS201txKSSEEpRAYrdHWYfIt6iYhTZdshUAqhazrltOINg9Ha6GZLytq4/cG6by2DZVSu7rYQr7BWcd8nrBYpNSq5mYl0Ma1/d4HorwoSdMMJSuCcwRnd7C2ra1S+CwliKIlWee4zkoaI5Ws2GwFznv2Ea0uPzP/dEn+9Qvq53fc1Q9sBzX7xvriA36R3BGsLlguZizXBVIqbqXC+XAvuMkrclHjG0fW4P9BXUnKPG+Xsw/vHdbWQPNNz/2AOkEhFdu8QHWz+g8hoI3ptrwjXK9rjs5/0Xub0HuTcPz6N/NM3c38L8dhVZzn7MLlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"enable flex web services\"\n        title=\"\"\n        src=\"/static/e86a7d5f26fd9529baba06bd72476747/2bef9/3.png\"\n        srcset=\"/static/e86a7d5f26fd9529baba06bd72476747/6f3f2/3.png 256w,\n/static/e86a7d5f26fd9529baba06bd72476747/01e7c/3.png 512w,\n/static/e86a7d5f26fd9529baba06bd72476747/2bef9/3.png 1024w,\n/static/e86a7d5f26fd9529baba06bd72476747/71c1d/3.png 1536w,\n/static/e86a7d5f26fd9529baba06bd72476747/a878e/3.png 2048w,\n/static/e86a7d5f26fd9529baba06bd72476747/65781/3.png 2778w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Step 2: Create Flex Query under Performance &#x26; Reports menu</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cf9f3f08139a6245b8afbc4c525ae017/efb68/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.32812499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyklEQVR42p2RYWvCQAyG7///HkFhA3+BXxyM3pW1dcqJk2E7r+1dLtdX0n4QET90DzwJBBJColZva3zmB2y2OTYfOUxhUezP+Pr+mWVenbBYvkOVZQlhSIz/MgzDmMuigNJG4/TrcL508CGh8/xg2085BAJRRIz8pNSFLMugJAh+bGBQfDQQIzIjpdcyTwO11lASrD2ishfULqAPEZ2fZ9sTPCUYY6aBu71FdWxQO4LrIq4z/WsJref7hkLT1HDOjQeea0oJ8hfZ8AYSOBpCt8BXuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create flex query\"\n        title=\"\"\n        src=\"/static/cf9f3f08139a6245b8afbc4c525ae017/2bef9/4.png\"\n        srcset=\"/static/cf9f3f08139a6245b8afbc4c525ae017/6f3f2/4.png 256w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/01e7c/4.png 512w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/2bef9/4.png 1024w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/71c1d/4.png 1536w,\n/static/cf9f3f08139a6245b8afbc4c525ae017/efb68/4.png 2032w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Step 3: Create Google Sheet with App Script</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/e2d3b/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.59375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABTElEQVR42m2O2WrcQBBF9f9/4vghD4ZAwIY8zVMMxuDgBWNblkbdmtbSo6XVm05QmwmYuOBQVN1abnYv3yjyPXlR8vZeJA5Nhx4mjPUYF5j7nvHpgeH5ibnIMYvD+hXr439kd+IVKRqKSlJWNe+lQB5aRN1Qq5bDcUbe3vDy/Yz7q5+Iyx9oIfArOBdwPiasCywukKl2pu4MpewpRE8pNZUaUHpBtlNiX/fIxwfExTm613wV1jpkM5C5EJkXyzQbnA9Y59O37avf6gDzaGh+76guvtE+/iHkzxDDp4MhfOxm0zSxsRiD9x5rLSF4nPd4ZxnsSv6q0Lsr1M019e4X0/UOvGMF1nVNxBjTfjZOE8fjkdmY1DyJnwZDZBgtqtqjGwVr/OfsNLcd21xmW3EStsZ24JQ/CKnWw4hqO5qup9earu3QWidtC+dccvgXjnkZD7e2FVkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create google app script\"\n        title=\"\"\n        src=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/2bef9/5.png\"\n        srcset=\"/static/a0a99b366fd625ffbf3c9f1b8956fafe/6f3f2/5.png 256w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/01e7c/5.png 512w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/2bef9/5.png 1024w,\n/static/a0a99b366fd625ffbf3c9f1b8956fafe/e2d3b/5.png 1466w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Paste code and deploy</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/65ef80a61ba682acb9fcc1c509b4317c/2cda4/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.70312499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbUlEQVR42mWSWU/EMAyE+/9/FPDE60rwhATSLuzVpm0O53B6DXJarqXSyI3kTsafW5EzCDGCOYGI4BxhmiYsy4J5nktdzzN+nmXT+n5/94THhx3yaY/KOkZnGZ4BiiNCTAgpgfOAnAcMw4iYGMwZ4zj90SDKGer1BR/PO9j9GyoKEZY8pnlBziNcCDj2NWrToSdXZIKHiwE2eBjvS4/1HhRDudiFCEMegRkVM38PIiNK86E9Y69OOKgLDuqMd3XGRSucdAPlNJTVuJoW2jtQjDCeYLwr01XC58dwKTef+hrnvsFHdy1GrTPlY9Gakop8SkicvyVpK4H+29D5gKtWxUhS1LZDY/tyFgxfRsJZ2AqmPIxrzeN/Q0n43l4KR0l63FIeu5WrpBVTSSrGkRkh8VbTX8NlXqCJCre6XxmVBWxLkIXozexLshjpEZay4JuEMyxFNKpHd+1glEHTtFCdhg8JFBJ8zOVXyrfaRv4E5my2CnGJHdQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"code\"\n        title=\"\"\n        src=\"/static/65ef80a61ba682acb9fcc1c509b4317c/2bef9/6.png\"\n        srcset=\"/static/65ef80a61ba682acb9fcc1c509b4317c/6f3f2/6.png 256w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/01e7c/6.png 512w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/2bef9/6.png 1024w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/71c1d/6.png 1536w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/a878e/6.png 2048w,\n/static/65ef80a61ba682acb9fcc1c509b4317c/2cda4/6.png 2946w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a856ecd526225b31ed719164f568697f/eb1d2/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.515625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACJElEQVR42pWTy3LTMBSG/bI8BSvW3bBLYShdsOiwCqSJEzsX5wIPwDMw0yY4seOLLpYl/cyRXULGoYBmvjmyLP/+j86R9+7mFuF0Dt+fYDwOEIZTLBZLzBeRg+Z/Yz6PsNl8xfX1W3jRagULoCgKlCWDlBL/O4wxLpIhbxKEYIwjz3O3KIRw8ziOkSQJ6rqG1vpZaI8xGv1PA3izKHIijDEnaK2FkALb3Q55lrtncvAcJNg4nDQp/26bhqprlIyDCwEhJWpyYswfUa3g/ciHt1yvO4IkwDlDUeQOrZuUCGtMB90KjvzxuUNrG0EpK2zjBFJp0G+UISyq+jK80qeiLNebk2DrsBAahyNHkhEMad7MmdSgb2V9QigLLjXIY38QnKf8JMikwe5QYLvP8Rhn2O4zPPxIccg4MqZwLGUbK5TSOAMKwOf7AN7iQlGoaockxf6QoigYhKzAhQTjwhWLcHPOXUEqpdx3dDkuVpkEGSuRZRlUuxnOfxdrjSsajcFweFmwqg12icAuJTi2CcHwmFR4SDTiTCMpNZKiiXGuIC0w9AN4q/WXjqDWBsdSIS2Vi3RWx6JC6kSAXACsorNuYs5N2zYBvGi5/pXmU+drowFrztOjnqI1a1ya1r1vIvWnO0O6KcvVpuPwX0alm5749l3jxQeGlyPg/ccJvN6bG8xnC6dOjTmeECHGkyl89zxFEM46DP3QcdcP8Ko3xNVtiKvXPfwEPOCyrUSgkicAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"deploy\"\n        title=\"\"\n        src=\"/static/a856ecd526225b31ed719164f568697f/2bef9/7.png\"\n        srcset=\"/static/a856ecd526225b31ed719164f568697f/6f3f2/7.png 256w,\n/static/a856ecd526225b31ed719164f568697f/01e7c/7.png 512w,\n/static/a856ecd526225b31ed719164f568697f/2bef9/7.png 1024w,\n/static/a856ecd526225b31ed719164f568697f/71c1d/7.png 1536w,\n/static/a856ecd526225b31ed719164f568697f/eb1d2/7.png 1622w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>New function should appear</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1022px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.34374999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACT0lEQVR42oVT22rbQBT0b/cb+i99LRQCbfLQFLchNKmhSVyrdixLWl1We79JU3YtJXEI9MBwVrtizsw5uwvGOIw1AEY4Z2GMRk97bDYZ8n2ObJOB1B2GERiHEeMADC/yDK0NQghYMM5Rtx24CmiZARUOVAhUlID0NUpKsG1y3B7u0EoKYRW4EWBapCysBNMcd+t7CCmw0EpgvWc4u7zHxdUDzr7+xnW2xufsG778WeIi+44Pvz7h3cf3OM+W+LG/xYo84PzPEjflHa7yFZa7GzSKIgwDFs5aCO3QCY9eelAeUHGK6/0Kl5trZM0j8r4EES12XY6/7R7bNseOHtJ3IQgKSdAqinEcsVBaw1qbejhDW426btB1HQpS4VCVKGuCQ1ngUJbIiwKkqVGSCsZahCHAeIshKlRKwRj73OAwpMNadlBO478x6XDBT4RapypR7gzjDH5uVljvMzRNi6Is0bYtSF0n1HUNxtgJ7xNhtOucOyGMlsuiAqU9ogMp5ZQVhJTQWuPozKT/Twjli4MZympsH/foKE1knHMIIVLue4boKt7fvu8TSQxtzUQ4VXxt+XAoUFZVOvPeJxcRcW2n9RzxQnecHac8yz8ltImsIgScH5XFwj1jkzKW9k8I2QvCtxRut7uksm27ZC3mtGYsIfaXTSTRai/4kVAqmRodN2doZ9JkI2HTNGmyUS0hNZTSCMEn61HZHDa441s+Wn6l0Lt0cWPVASP8EBDGkPJbiC2KrpLCqE6+6mGsHpXGFxDXfhqG8/5pQN4/q4yi5qv3DwAig66tmDHNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fn\"\n        title=\"\"\n        src=\"/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png\"\n        srcset=\"/static/fd3fd5d642b9357885ba435ed5866c16/6f3f2/8.png 256w,\n/static/fd3fd5d642b9357885ba435ed5866c16/01e7c/8.png 512w,\n/static/fd3fd5d642b9357885ba435ed5866c16/1ac29/8.png 1022w\"\n        sizes=\"(max-width: 1022px) 100vw, 1022px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Ideas</h2>\n<p>You may want to:</p>\n<ul>\n<li>join IBKR with GOOGLEFINANCE</li>\n<li>get additional data from finviz, yahoo finance, ...</li>\n<li>build dividends calendar</li>\n<li>...</li>\n</ul>\n<h2>IBKR FLEX QUERY</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * IBRK Flex Query.\n *\n * From IBKR side you need enable flex service - this can be done in \"Flex Web Service\" in settings menu.\n * While enabling flex service - copy your token.\n * After enabling flex service go to \"Flex Queries\" under \"Performance &amp; Reports\" menu and create one.\n * Each created report will have its own query id - copy it as well.\n * Keep in mind that this function will grab only first section of report, so if you want multiple sections just create multiple queries.\n * The report retrieval is done in two steps:\n * - step 1: request report generation, requires token and query id, will return report code and url\n * - step 2: retrieve generated report\n * Notes:\n * - when you prepared your report it is a good idea to enable cache so everything will work much faster\n * - if report is really huge try to increase to something like 5 seconds\n *\n * @param {number} token Token from Settings \\ Flex Services menu.\n * @param {number} query Query ID of Flex Query from Reports \\ Flex Query menu.\n * @param {bool} headers Add header names to result. Default TRUE.\n * @param {bool} cache Cache results for 6 hours which is maximum for Google Sheets. Default FALSE.\n * @param {number} sleep Report generation takes some time, so we are waiting given amount of milliseconds before proceeding. Default is 2000 which is 2 seconds.\n * @return Query results.\n * @customfunction\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token constant\">IBKRFLEXQUERY</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">token<span class=\"token punctuation\">,</span> query<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> cache<span class=\"token operator\">=</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> sleep<span class=\"token operator\">=</span><span class=\"token number\">2000</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Step 0: optional, return cached results</span>\n  <span class=\"token keyword\">var</span> cacheService <span class=\"token operator\">=</span> CacheService<span class=\"token punctuation\">.</span><span class=\"token function\">getDocumentCache</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> cacheKey <span class=\"token operator\">=</span> token <span class=\"token operator\">+</span> <span class=\"token string\">\".\"</span> <span class=\"token operator\">+</span> query<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">&amp;&amp;</span> cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Step 1: request report generation</span>\n  <span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.SendRequest?v=3&amp;t=\"</span><span class=\"token operator\">+</span>token<span class=\"token operator\">+</span><span class=\"token string\">\"&amp;q=\"</span><span class=\"token operator\">+</span>query<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> xml <span class=\"token operator\">=</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContentText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> root <span class=\"token operator\">=</span> XmlService<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRootElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> code <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ReferenceCode\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  url <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Url\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Utilities<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>sleep<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Step 2: retrieve generated report</span>\n  url <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> <span class=\"token string\">\"?v=3&amp;t=\"</span><span class=\"token operator\">+</span>token<span class=\"token operator\">+</span><span class=\"token string\">\"&amp;q=\"</span> <span class=\"token operator\">+</span> code\n  xml <span class=\"token operator\">=</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContentText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> nodes <span class=\"token operator\">=</span> XmlService<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRootElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FlexStatements\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FlexStatement\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> node <span class=\"token keyword\">of</span> nodes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// optional: add headers</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> items<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">getAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">attr</span> <span class=\"token operator\">=></span> attr<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">var</span> item <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> attr <span class=\"token keyword\">of</span> node<span class=\"token punctuation\">.</span><span class=\"token function\">getAttributes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> text <span class=\"token operator\">=</span> attr<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^-?[\\d,\\.]+$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        item<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        item<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    items<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Step 0: optional, store results in cache for subsequent requests</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    cacheService<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>cacheKey<span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>How it works</h2>\n<p>Two step process:</p>\n<ol>\n<li>Send request asking to generate report</li>\n<li>Retrieve generated report</li>\n</ol>\n<p>Suppose we have an query with id <code class=\"language-text\">866660</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">TOKEN</span><span class=\"token operator\">=</span><span class=\"token string\">\"1417**************\"</span>\n<span class=\"token assign-left variable\">QUERY_ID</span><span class=\"token operator\">=</span><span class=\"token string\">\"866660\"</span>\n\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Content-Type: application/x-www-form-urlencoded\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"q=<span class=\"token variable\">$QUERY_ID</span>&amp;v=3&amp;t=<span class=\"token variable\">$TOKEN</span>\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.SendRequest\"</span></code></pre></div>\n<p>Response will be something like</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatementResponse</span> <span class=\"token attr-name\">timestamp</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>14 October, 2023 03:57 AM EDT<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Status</span><span class=\"token punctuation\">></span></span>Success<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Status</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ReferenceCode</span><span class=\"token punctuation\">></span></span>5045169185<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ReferenceCode</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Url</span><span class=\"token punctuation\">></span></span>https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.GetStatement<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Url</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatementResponse</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>From response we will receive url and reference code to download generated report</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Content-Type: application/x-www-form-urlencoded\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"q=5045169185&amp;v=3&amp;t=<span class=\"token variable\">$TOKEN</span>\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token string\">\"https://gdcdyn.interactivebrokers.com/Universal/servlet/FlexStatementService.GetStatement\"</span></code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>depending on report size it may require some time for generation to complete</li>\n<li>url is different and taken from response</li>\n<li>instead of query id we passing reference code</li>\n</ul>\n<p>Sample response</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexQueryResponse</span> <span class=\"token attr-name\">queryName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>portfolio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>AF<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatements</span> <span class=\"token attr-name\">count</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FlexStatement</span> <span class=\"token attr-name\">fromDate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-13<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">toDate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-13<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">period</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LastBusinessDay<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">whenGenerated</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2023-10-14 03:57:57<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPositions</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPosition</span> <span class=\"token attr-name\">symbol</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VZ<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">position</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OpenPosition</span> <span class=\"token attr-name\">symbol</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>XRX<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">position</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>4<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>OpenPositions</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatement</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexStatements</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FlexQueryResponse</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Notes:</p>\n<ul>\n<li>just for simplicity have removed everything, in your flex query you may add ass many fields as you want, aka prices, p&#x26;l, market value, price change and so on</li>\n<li>with flex query you may receive not only positions but also trades history, dividends, taxes and many many more</li>\n<li>flex queries are not supposed to receive input parameters so if you need YTD data just set it while creating query</li>\n</ul>"}},"pageContext":{"id":"d9cdb07b-da88-538a-8ce2-a4285407a309"}},"staticQueryHashes":[],"slicesMap":{}}