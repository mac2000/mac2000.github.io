<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.4"/><style data-href="/styles.178380a10784f7949ccc.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-cyrillic-ext-400-normal-80c010be16bde8b7e613a74066e2b9ef.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+0460-052f,u+1c80-1c88,u+20b4,u+2de0-2dff,u+a640-a69f,u+fe2e-fe2f}@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-cyrillic-400-normal-5baf1f37de97e50ab654c46ecdfa687b.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+0301,u+0400-045f,u+0490-0491,u+04b0-04b1,u+2116}@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-greek-ext-400-normal-7f5049065c02fb5e06282aeab839cbb2.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+1f??}@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-greek-400-normal-038ee74fde7a2c872ee2f9a62edb69d8.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+0370-03ff}@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-latin-ext-400-normal-9967dbf10fc3cb92edfb247472a17ec0.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+0100-024f,u+0259,u+1e??,u+2020,u+20a0-20ab,u+20ad-20cf,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-display:swap;font-family:Ubuntu;font-style:normal;font-weight:400;src:url(/static/ubuntu-latin-400-normal-2f02effe392a63dc07a5cdf187b2ef09.woff2) format("woff2"),url(/static/ubuntu-all-400-normal-8629f83ad2c45e75a914dd97fd21746d.woff) format("woff");unicode-range:u+00??,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(data:font/woff2;base64,d09GMgABAAAAAAOwABAAAAAAB1wAAANVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhQbIBwqBmA/U1RBVF4ARBEICoMggmsLEAABNgIkAxAEIAWFAAcgDAcbAwZILgpsm7F1KvWgWakUD5ozK/4WXcgHEY2ls3sXBL5PicmRZXaVaWSBVWQB0Abcw9Vc7s9bIot8cY+sgAsUwMtcNoXxFbIVur6hqN0evmrGTRQYZVKR5lfh//xfUy9KD/xuFYDDoUWlyD4trAJobwZRZdOjBdBGNqGp0w2lzLMwqwQNpYQdMjlHgEgAQFAEQYBw4iWS0WM3e/AAYAECASBAOKnSKbM6tFegATEAoQD0fKsL5SRBoId1PsCkOFiWQnKAQhiupvyJiQuAx7bP/jde/yswXqnMRW58fQtarB+AXEEIQigKJDJAId23TkIXsOE+a64YhGDSlVNAxcpJkKWAPAUM9ut9BMviWAAEAAWMwC6RttTCwdMEtbfs/0DYPvuv+UFJh0LCYqa8Y6AYAEIAiAYigB2Aa0AkkAjA8D5mPApijYmJCQuLDwtLiAiKsiujglZv8kSYhRELLl1LunAjY1HEfF1x+I2YQ28jjrxGD756NffIW5FwDr5eGCGH3oQffsUrjUGiM42pQMyNzWlprefSJeS7cqX67MVcnw9L6io7egLl9koCcR8HlpysuP0iJf7j9rGKJSA1Dipm5TbzZXny0ZdxznJIli4hbmq7a5T7HjTojeqeP4iu29vR0TwOEm3cUlK/1PPjIUsubZy75xoWu1/H5SiuB+pulx8ucT2jekaGC3qAt6P9WBP/v/O06G6f9vG3Pwl15/Y61G4QdNBghPB+wVAKKIA26Qc6/0YztRgBtNmuTNcby/ydI6HG/AP4+OLmZYCPH54NbvO/sqeNFwSjAAj8N4/tJyjfiSYIniw6n6u0xRfq9M8JECK32cohOHOYQYFIzmMQGwbchzsrZLrPKtG8Yw2d/rCWyvLZINKbygZT3nommuZOSwlEykDYUuuVmCf81W2xhMs3RqFMXxiZSIIS6tWOaK7ZEOa5m4iHRphnMoMlYQrKQCVMx1AK3iuU4GFDEorR9tLqKDJBdkuNGuvI1HdsL2pWoXR1UX5sUjdenCy6xe/KNs0zhgjXq1Ono9WRdnWNar7wrVaiZx/xGIvMhBPUJVLm/q74Lq8LAk3IUhN4aXH1NoyobpqZjRN+iT9qCT3TyF5tUbpnBjcABNZAgODgbQnot8cAAAA=) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+0460-052f,u+1c80-1c88,u+20b4,u+2de0-2dff,u+a640-a69f,u+fe2e-fe2f}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(data:font/woff2;base64,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) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+0301,u+0400-045f,u+0490-0491,u+04b0-04b1,u+2116}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(data:font/woff2;base64,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) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+0370-03ff}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(data:font/woff2;base64,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) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+0102-0103,u+0110-0111,u+0128-0129,u+0168-0169,u+01a0-01a1,u+01af-01b0,u+1ea0-1ef9,u+20ab}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(data:font/woff2;base64,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) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+0100-024f,u+0259,u+1e??,u+2020,u+20a0-20ab,u+20ad-20cf,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-display:swap;font-family:JetBrains Mono;font-style:normal;font-weight:400;src:url(/static/jetbrains-mono-latin-400-normal-d0b41bd1d599bc0a52b733fd39c8cc06.woff2) format("woff2"),url(/static/jetbrains-mono-all-400-normal-2346733ac7062d6402c0c859ccbf227e.woff) format("woff");unicode-range:u+00??,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@media (prefers-color-scheme:light){code[class*=language-],pre[class*=language-]{background:#fafafa;color:#383a42;direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#e5e5e6;color:inherit}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#e5e5e6;color:inherit}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}.token.cdata,.token.comment,.token.prolog{color:#a0a1a7}.token.doctype,.token.entity,.token.punctuation{color:#383a42}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#b76b01}.token.keyword{color:#a626a4}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e45649}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#50a14f}.token.function,.token.operator,.token.variable{color:#4078f2}.token.url{color:#0184bc}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#383a42}.language-css .token.selector{color:#e45649}.language-css .token.property{color:#383a42}.language-css .token.function,.language-css .token.url>.token.function{color:#0184bc}.language-css .token.url>.token.string.url{color:#50a14f}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#a626a4}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#ca1243}.language-json .token.operator{color:#383a42}.language-json .token.null.keyword{color:#b76b01}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#383a42}.language-markdown .token.url>.token.content{color:#4078f2}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#0184bc}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#a0a1a7;font-style:italic}.language-markdown .token.code-snippet{color:#50a14f}.language-markdown .token.bold .token.content{color:#b76b01}.language-markdown .token.italic .token.content{color:#a626a4}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e45649}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(56,58,66,.2)}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#e5e5e6;border-radius:.3em;color:#696c77;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#c6c7c7;color:#383a42}.line-highlight.line-highlight{background:rgba(56,58,66,.05)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#e5e5e6;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#383a42;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(56,58,66,.05)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(56,58,66,.2)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#9d9d9f}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e45649}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#50a14f}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#4078f2}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#a626a4}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection{background-color:rgba(56,224,98,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:hsl(0,0,95%)}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:hsl(0,0,95%)}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:hsl(0,0,95%)}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#fff}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#383a42;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#383a42}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}}@media (prefers-color-scheme:dark){code[class*=language-],pre[class*=language-]{background:#282c34;color:#abb2bf;direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#3e4451;color:inherit;text-shadow:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#3e4451;color:inherit;text-shadow:none}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.cdata,.token.comment,.token.prolog{color:#5c6370}.token.doctype,.token.entity,.token.punctuation{color:#abb2bf}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#d19a66}.token.keyword{color:#c678dd}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e06c75}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#98c379}.token.function,.token.operator,.token.variable{color:#61afef}.token.url{color:#56b6c2}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#abb2bf}.language-css .token.selector{color:#e06c75}.language-css .token.property{color:#abb2bf}.language-css .token.function,.language-css .token.url>.token.function{color:#56b6c2}.language-css .token.url>.token.string.url{color:#98c379}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#c678dd}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#be5046}.language-json .token.operator{color:#abb2bf}.language-json .token.null.keyword{color:#d19a66}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#abb2bf}.language-markdown .token.url>.token.content{color:#61afef}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#56b6c2}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#5c6370;font-style:italic}.language-markdown .token.code-snippet{color:#98c379}.language-markdown .token.bold .token.content{color:#d19a66}.language-markdown .token.italic .token.content{color:#c678dd}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e06c75}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(171,178,191,.15);text-shadow:none}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#3a3f4b;border-radius:.3em;color:#828997;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#3e4451;color:#abb2bf}.line-highlight.line-highlight{background:rgba(153,187,255,.04)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#3a3f4b;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#abb2bf;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(153,187,255,.04)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(171,178,191,.15)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#636d83}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e06c75}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#98c379}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#61afef}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#c678dd}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection{background-color:rgba(56,224,98,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:#262931}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:#262931}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:#262931}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#31363f}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#abb2bf;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#abb2bf}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}}:root{--foreground:#24292f;--background:#fff}a{color:#0969da}a.visited,a:visited{color:#57606a}.green{color:#1a7f37}.red{color:#cf222e}@media (prefers-color-scheme:dark){:root{--foreground:#adbac7;--background:#22272e}a{color:#539bf5}a.visited,a:visited{color:#768390}.green{color:#57ab5a}.red{color:#e5534b}}a{text-decoration:none}a:hover{text-decoration:underline}html{font-family:Ubuntu,sans-serif}body{background-color:var(--background);color:var(--foreground);margin:0;padding:0}#top{box-sizing:border-box;display:grid;grid-template-rows:1fr 2em;margin:0;min-height:100vh;padding:1em 2em}.graph polygon{fill:transparent}.graph g ellipse[stroke="#000"],.graph g ellipse[stroke="#000000"],.graph g ellipse[stroke=black],.graph g path[stroke="#000"],.graph g path[stroke="#000000"],.graph g path[stroke=black],.graph g polygon[stroke="#000"],.graph g polygon[stroke="#000000"],.graph g polygon[stroke=black]{stroke:var(--foreground)}.graph g text[fill="#000"],.graph g text[fill="#000000"],.graph g text[fill=black]{fill:var(--foreground)}code,pre{font-family:JetBrains Mono,monospace}pre[class*=language-]{word-wrap:break-word;border-radius:0;box-sizing:border-box;margin:1em -2em;max-width:100vw;padding:1em 2em}footer a{line-height:2em;margin-right:.5em}.delta{line-height:1;margin-left:1em;white-space:nowrap}.columns{display:grid;grid-template-columns:repeat(2,1fr)}@media only screen and (max-width:1024px){.columns{grid-template-columns:repeat(1,1fr)}}.pie{text-align:center}.pie figure{display:inline-block}.pie figcaption{font-size:80%;margin-top:.25em}</style><title data-gatsby-head="true">Running WireGuard inside Kubernetes</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=f721a5d7266d14d92ad4cfcedfe44a7c" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=f721a5d7266d14d92ad4cfcedfe44a7c"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="top"><main><div><h1>Running WireGuard inside Kubernetes</h1>
<p>The goal here is to run WireGuard directly inside Kubernetes, which will allow us to resolve and talk to its services, pods, etc</p>
<h2>LinuxServer/WireGuard</h2>
<p>There is <a href="https://hub.docker.com/r/linuxserver/wireguard">linuxserver/wireguard</a></p>
<p>Here is working sample:</p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> wireguard
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">kubeforce</span><span class="token punctuation">:</span> skip
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> wireguard
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> wireguard
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span>
        <span class="token key atrule">kubernetes.io/os</span><span class="token punctuation">:</span> linux
      <span class="token comment"># initContainers:</span>
      <span class="token comment">#   - args:</span>
      <span class="token comment">#     - -c</span>
      <span class="token comment">#     - |</span><span class="token scalar string">
      #       sysctl -w net.ipv4.ip_forward=1
      #       sysctl -w net.ipv4.conf.all.src_valid_mark=1
      #     # - sysctl -w net.ipv4.ip_forward=1
      #     # - sysctl -w net.ipv4.conf.all.src_valid_mark=1 # Required for client mode
      #     command:
      #     - /bin/sh
      #     image: busybox:1.29
      #     name: sysctl
      #     securityContext:
      #       privileged: true</span>

      <span class="token comment"># securityContext:</span>
      <span class="token comment">#   runAsUser: 1000</span>
      <span class="token comment">#   runAsGroup: 1000</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
        <span class="token key atrule">image</span><span class="token punctuation">:</span> linuxserver/wireguard
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PUID
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"1000"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PGID
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"1000"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> TZ
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"Europe/Kiev"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SERVERURL
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"4.21.11.210"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SERVERPORT
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"51820"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PEERS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PEERDNS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"10.0.0.10"</span>
        <span class="token comment"># - name: INTERNAL_SUBNET</span>
        <span class="token comment">#   # TODO: narrow down?</span>
        <span class="token comment">#   value: "10.0.0.0/16"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ALLOWEDIPS
          <span class="token comment"># ip addresses that will be routed via this vpn</span>
          <span class="token comment"># value: "0.0.0.0/0, ::/0"</span>
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"10.0.0.0/8, 34.11.5.8/32, 20.13.19.8/32"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> LOG_CONFS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"true"</span>
        <span class="token comment"># Set to `all` or a list of comma separated peers (ie. `1,4,laptop`) for the wireguard server to send keepalive packets to listed peers every 25 seconds. Useful if server is accessed via domain name and has dynamic IP. Used only in server mode.</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PERSISTENTKEEPALIVE_PEERS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"all"</span>
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">51820</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 500m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 128Mi
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 100m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 64Mi
        <span class="token key atrule">securityContext</span><span class="token punctuation">:</span>
          <span class="token comment"># privileged: true</span>
          <span class="token key atrule">capabilities</span><span class="token punctuation">:</span>
            <span class="token key atrule">add</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> NET_ADMIN
            <span class="token comment"># - SYS_MODULE</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> wireguard
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">51820</span>
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP</code></pre></div></p>
<p>Notes:</p>
<ul>
<li>I was experimenting with Azure AKS so notes may be not aplicable everywhere</li>
<li>There is no need to touch sysctl - packes successfully routed as wanted</li>
<li>There is no need to run in privileged mode</li>
<li>There is no need to map and deal with modules - wireguard is build into moder kernels</li>
<li>Server URL points to public IP address of our load balancer service</li>
</ul>
<p>With such setup I was able to run it, grab config and successfully connect</p>
<p>Also the end goal was reached, because we are pointing DNS to CoreDNS I was able to resolve and talk to Kubernetes services</p>
<p>The drawback is that container is kind of static, which means it is good if you are single user or do not need to manage peers dynamically</p>
<h2>Alternative Images</h2>
<p>There is quadrillion of alternative images, even more, many of them are talking about OIDC, OAuth, 2FA, etc</p>
<p>But at the very end it is only partially truth</p>
<p>Actually what all they are doing is to have some kind of UI to manage WireGuard peer configurations and to access that UI you need to be authenticated</p>
<p>But the keys themselve have nothing to do with any auth provider and will work no matter what</p>
<p>Also the client itself is not aware of anything around this</p>
<p>From my understanding the idea here is just to revoke peers by schedule to enforce end user to relogin into UI and generate new keys</p>
<h2>WireGuard from scratch</h2>
<p>After realizing that WireGuard is build into the Kernel it seems that there is no need to dedicated image and it should work out of the box</p>
<p>I have started with Ubuntu, but:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> wireguard</code></pre></div>
<p>told me that it will install 800Mb of software</p>
<p>Note: even so WireGuard is build into Kernel, we still need its tools to manage peers, that's why I'm installing it</p>
<p>But on the other hand Alpine image has <code class="language-text">wireguard-tools</code> package which makes everything much simpler</p>
<p>To proove it might work I have deployed following:</p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">kubeforce</span><span class="token punctuation">:</span> skip
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span>
        <span class="token key atrule">kubernetes.io/os</span><span class="token punctuation">:</span> linux
        <span class="token key atrule">poolDestination</span><span class="token punctuation">:</span> app
      <span class="token comment"># initContainers:</span>
      <span class="token comment">#   - args:</span>
      <span class="token comment">#     - -c</span>
      <span class="token comment">#     - |</span><span class="token scalar string">
      #       sysctl -w net.ipv4.ip_forward=1
      #       sysctl -w net.ipv4.conf.all.src_valid_mark=1
      #     # - sysctl -w net.ipv4.ip_forward=1
      #     # - sysctl -w net.ipv4.conf.all.src_valid_mark=1 # Required for client mode
      #     command:
      #     - /bin/sh
      #     image: busybox:1.29
      #     name: sysctl
      #     securityContext:
      #       privileged: true</span>

      <span class="token comment"># securityContext:</span>
      <span class="token comment">#   runAsUser: 1000</span>
      <span class="token comment">#   runAsGroup: 1000</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
          <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
          <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">51820</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 500m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 1024Mi
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 100m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 256Mi
        <span class="token key atrule">securityContext</span><span class="token punctuation">:</span>
          <span class="token comment"># privileged: true</span>
          <span class="token key atrule">capabilities</span><span class="token punctuation">:</span>
            <span class="token key atrule">add</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> NET_ADMIN
            <span class="token comment"># - SYS_MODULE</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">51820</span>
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP</code></pre></div></p>
<p>Notes:</p>
<ul>
<li>I have deployed <code class="language-text">nginx:alpine</code> so it is Alpine and it wont exit immediately</li>
<li>Everything else it similar to previous deployment</li>
</ul>
<p>Here is outlines from experiment</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply <span class="token parameter variable">-f</span> alpine.yml

kubectl get svc demo
<span class="token comment"># 51.138.228.184</span>

kubectl get po <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>demo
kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> demo-85b7d9f77f-8dx9r -- <span class="token function">sh</span>


<span class="token builtin class-name">export</span> <span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token number">51.138</span>.228.184

<span class="token comment"># install wireguard-tools, the wireguard itself is build into the kernel, we need the `wg` tool</span>
apk <span class="token function">add</span> wireguard-tools

<span class="token comment"># create and configure wg0 interface</span>
<span class="token function">ip</span> <span class="token function">link</span> <span class="token function">add</span> wg0 <span class="token builtin class-name">type</span> wireguard
<span class="token function">ip</span> <span class="token parameter variable">-4</span> address <span class="token function">add</span> <span class="token number">10.14</span>.14.1 dev wg0
<span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> mtu <span class="token number">1420</span> up dev wg0
<span class="token function">ip</span> <span class="token parameter variable">-4</span> route <span class="token function">add</span> <span class="token number">10.14</span>.14.0/24 dev wg0

<span class="token comment"># configure iptables to masquarade (nat), requires NET_ADMIN capabilities</span>
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-i</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-o</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> MASQUERADE

<span class="token comment"># check (should show interface with private ip)</span>
<span class="token function">ip</span> addr show wg0
<span class="token comment"># check (should show interface with some random listening port)</span>
wg

<span class="token comment"># keys</span>
wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/server.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/server.publickey

<span class="token function">tee</span> /etc/wireguard/wg0.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Interface]
# server private ip address
Address = 10.14.14.1
# server private key
PrivateKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/server.privatekey<span class="token variable">)</span></span>
# port to listen
ListenPort = 51820

EOT</span>

<span class="token comment"># apply</span>
wg syncconf wg0 <span class="token operator">&lt;</span><span class="token punctuation">(</span>wg-quick strip wg0<span class="token punctuation">)</span>

<span class="token comment"># check (should show interface with keys and desired 51820 listening port)</span>
wg


<span class="token comment"># ADDING PEER</span>

wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/peer1.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/peer1.publickey

<span class="token comment"># append peer to wg0.conf</span>
<span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/wireguard/wg0.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Peer]
# client public key
PublicKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer1.publickey<span class="token variable">)</span></span>
# client private ip
AllowedIPs = 10.14.14.2/32

EOT</span>


<span class="token comment"># apply</span>
wg syncconf wg0 <span class="token operator">&lt;</span><span class="token punctuation">(</span>wg-quick strip wg0<span class="token punctuation">)</span>

<span class="token comment"># check (should show not only wg0, but added peer as well)</span>
wg


<span class="token function">tee</span> /etc/wireguard/peer1.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Interface]
# client private ip
Address = 10.14.14.2
# client private key
PrivateKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer1.privatekey<span class="token variable">)</span></span>
DNS = 10.0.0.10

[Peer]
# server public key
PublicKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/server.publickey<span class="token variable">)</span></span>
# server public ip and port
Endpoint = <span class="token variable">$IP</span>:51820
# ip addresses that should be routed via vpn, 34.117.59.81 for ipinfo.io
AllowedIPs = 10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32
PersistentKeepalive = 25
EOT</span>

<span class="token function">cat</span> /etc/wireguard/peer1.conf


<span class="token comment"># CHECKS</span>

<span class="token comment"># ping vpn</span>
<span class="token function">ping</span> <span class="token number">10.14</span>.14.1
<span class="token comment"># prometheus svc</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> <span class="token number">10.0</span>.15.183 <span class="token number">80</span>
<span class="token comment"># prometheus pod</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> <span class="token number">10.64</span>.2.5 <span class="token number">9090</span>
<span class="token comment"># coredns svc</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> <span class="token number">10.0</span>.0.10 <span class="token number">53</span>
<span class="token comment"># dns</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> prometheus <span class="token number">80</span>
<span class="token comment"># sql</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> <span class="token number">10.54</span>.10.4 <span class="token number">1433</span>
<span class="token comment"># iis</span>
<span class="token function">nc</span> <span class="token parameter variable">-vz</span> <span class="token number">10.54</span>.11.4 <span class="token number">80</span>
<span class="token comment"># nat</span>
<span class="token function">curl</span> ipinfo.io

<span class="token comment"># SECOND CLIENT</span>

wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/peer2.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/peer2.publickey

<span class="token comment"># append peer to wg0.conf</span>
<span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/wireguard/wg0.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Peer]
# client public key
PublicKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer2.publickey<span class="token variable">)</span></span>
# client private ip
AllowedIPs = 10.14.14.3/32

EOT</span>


<span class="token comment"># apply</span>
wg syncconf wg0 <span class="token operator">&lt;</span><span class="token punctuation">(</span>wg-quick strip wg0<span class="token punctuation">)</span>

<span class="token comment"># check (should show not only wg0, but added peer as well)</span>
wg


<span class="token function">tee</span> /etc/wireguard/peer2.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Interface]
# client private ip
Address = 10.14.14.3
# client private key
PrivateKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer2.privatekey<span class="token variable">)</span></span>
DNS = 10.0.0.10

[Peer]
# server public key
PublicKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/server.publickey<span class="token variable">)</span></span>
# server public ip and port
Endpoint = <span class="token variable">$IP</span>:51820
# ip addresses that should be routed via vpn, 34.117.59.81 for ipinfo.io
AllowedIPs = 10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32
PersistentKeepalive = 25
EOT</span>

<span class="token function">cat</span> /etc/wireguard/peer2.conf

<span class="token comment"># CHECKS</span>
<span class="token comment"># same checks as for client 1</span>

<span class="token comment"># REMOVING CLIENT 2</span>

<span class="token comment"># remove corresponding peer from wg0.conf (todo: script)</span>

<span class="token comment"># apply</span>
wg syncconf wg0 <span class="token operator">&lt;</span><span class="token punctuation">(</span>wg-quick strip wg0<span class="token punctuation">)</span>

<span class="token comment"># check (second peer should dissapear, even if he was connected it will stop working)</span>
wg

<span class="token comment"># CLEANUP</span>

<span class="token function">ip</span> <span class="token function">link</span> delete dev wg0
iptables <span class="token parameter variable">-D</span> FORWARD <span class="token parameter variable">-i</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-D</span> FORWARD <span class="token parameter variable">-o</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-D</span> POSTROUTING <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> MASQUERADE</code></pre></div>
<p>So we actualy may have wireguard up and running out of the box</p>
<p>Beside that - if instead of nginx we will run some kind of our UI we actually will have such an alternative image</p>
<p><strong>alternative experiment without config files</strong></p>
<p>following experiment demonstrates alternative approach where we are not dealing with configuration files at all, everything is done wia <code class="language-text">wg</code> commands (the idea behind was to dynamically fill peers instead of parsing and writing ini configuration files)</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply <span class="token parameter variable">-f</span> alpine.yml

kubectl get svc demo
<span class="token comment"># 51.138.227.23</span>

kubectl get po <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>demo
kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> demo-85b7d9f77f-6fqs5 -- <span class="token function">sh</span>


<span class="token builtin class-name">export</span> <span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token number">51.138</span>.227.23

apk <span class="token function">add</span> wireguard-tools


<span class="token function">ip</span> <span class="token function">link</span> <span class="token function">add</span> wg0 <span class="token builtin class-name">type</span> wireguard
<span class="token function">ip</span> <span class="token parameter variable">-4</span> address <span class="token function">add</span> <span class="token number">10.14</span>.14.1 dev wg0
<span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> mtu <span class="token number">1420</span> up dev wg0
<span class="token function">ip</span> <span class="token parameter variable">-4</span> route <span class="token function">add</span> <span class="token number">10.14</span>.14.0/24 dev wg0
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-i</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-o</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> MASQUERADE

<span class="token comment"># check (should show interface with private ip)</span>
<span class="token function">ip</span> addr show wg0
<span class="token comment"># check (should show interface with some random listening port)</span>
wg

<span class="token comment"># keys</span>
wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/server.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/server.publickey

<span class="token comment"># apply private key, configure listening port</span>
wg <span class="token builtin class-name">set</span> wg0 listen-port <span class="token number">51820</span> private-key /etc/wireguard/server.privatekey

<span class="token comment"># check (should show interface with keys and desired 51820 listening port)</span>
wg


<span class="token comment"># ADDING PEER</span>

wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/peer1.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/peer1.publickey

wg <span class="token builtin class-name">set</span> wg0 peer <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer1.publickey<span class="token variable">)</span></span>"</span> allowed-ips <span class="token number">10.14</span>.14.2/32

<span class="token comment"># check (should show not only wg0, but added peer as well)</span>
wg


<span class="token function">tee</span> /etc/wireguard/peer1.conf <span class="token operator">></span> /dev/null <span class="token operator">&lt;&lt;</span><span class="token string">EOT
[Interface]
# client private ip
Address = 10.14.14.2
# client private key
PrivateKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer1.privatekey<span class="token variable">)</span></span>
DNS = 10.0.0.10

[Peer]
# server public key
PublicKey = <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/server.publickey<span class="token variable">)</span></span>
# server public ip and port
Endpoint = <span class="token variable">$IP</span>:51820
# ip addresses that should be routed via vpn, 34.117.59.81 for ipinfo.io
AllowedIPs = 10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32
PersistentKeepalive = 25
EOT</span>

<span class="token comment"># print config for a client</span>
<span class="token function">cat</span> /etc/wireguard/peer1.conf
<span class="token comment"># remove sensitive files, no need to store them</span>
<span class="token function">rm</span> /etc/wireguard/peer1.conf
<span class="token function">rm</span> /etc/wireguard/peer1.privatekey


<span class="token comment"># ...</span>

<span class="token comment"># https://serverfault.com/questions/1101002/wireguard-client-addition-without-restart</span>

<span class="token comment"># REMOVING CLIENT</span>

wg <span class="token builtin class-name">set</span> wg0 peer <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/wireguard/peer1.publickey<span class="token variable">)</span></span>"</span> remove</code></pre></div>
<p>So in general we may start from alpine, install wireguard tools and put our app which will just call all that commands, e.g. something like:</p>
<p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> wireguard

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"errors"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"io"</span>
	<span class="token string">"net/netip"</span>
	<span class="token string">"os"</span>
	<span class="token string">"os/exec"</span>
	<span class="token string">"strings"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Peer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	PublicKey           <span class="token builtin">string</span>
	PresharedKey        <span class="token builtin">string</span>
	Endpoint            <span class="token builtin">string</span>
	AllowedIPs          <span class="token builtin">string</span>
	LatestHandshake     <span class="token builtin">string</span>
	TransferRX          <span class="token builtin">string</span>
	TransferTX          <span class="token builtin">string</span>
	PersistentKeepalive <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> WireGuard <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	cidr             <span class="token builtin">string</span>
	serverPrivateIP  <span class="token builtin">string</span>
	serverPublicIP   <span class="token builtin">string</span>
	serverPrivateKey <span class="token builtin">string</span>
	serverPublicKey  <span class="token builtin">string</span>
	dns              <span class="token builtin">string</span>
	allowedIPs       <span class="token builtin">string</span>
	port             <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> PeerConfig <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ClientPrivateIP     <span class="token builtin">string</span>
	ClientPrivateKey    <span class="token builtin">string</span>
	DNS                 <span class="token builtin">string</span>
	ServerPublicKey     <span class="token builtin">string</span>
	ServerPublicIP      <span class="token builtin">string</span>
	ServerPort          <span class="token builtin">string</span>
	AllowedIPs          <span class="token builtin">string</span>
	PersistentKeepalive <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewWireGuard</span><span class="token punctuation">(</span>cidr <span class="token builtin">string</span><span class="token punctuation">,</span> serverPrivateKey <span class="token builtin">string</span><span class="token punctuation">,</span> serverPublicKey <span class="token builtin">string</span><span class="token punctuation">,</span> serverPublicIP <span class="token builtin">string</span><span class="token punctuation">,</span> dns <span class="token builtin">string</span><span class="token punctuation">,</span> allowedIPs <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>WireGuard<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>netip<span class="token punctuation">.</span><span class="token function">MustParsePrefix</span><span class="token punctuation">(</span>cidr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"invalid cidr"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>netip<span class="token punctuation">.</span><span class="token function">MustParsePrefix</span><span class="token punctuation">(</span>cidr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Is4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"non ip4 cidr"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	serverPrivateIP <span class="token operator">:=</span> netip<span class="token punctuation">.</span><span class="token function">MustParsePrefix</span><span class="token punctuation">(</span>cidr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"ip"</span><span class="token punctuation">,</span> <span class="token string">"link"</span><span class="token punctuation">,</span> <span class="token string">"add"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"wireguard"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"ip"</span><span class="token punctuation">,</span> <span class="token string">"-4"</span><span class="token punctuation">,</span> <span class="token string">"address"</span><span class="token punctuation">,</span> <span class="token string">"add"</span><span class="token punctuation">,</span> serverPrivateIP<span class="token punctuation">,</span> <span class="token string">"dev"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"ip"</span><span class="token punctuation">,</span> <span class="token string">"link"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token string">"mtu"</span><span class="token punctuation">,</span> <span class="token string">"1420"</span><span class="token punctuation">,</span> <span class="token string">"up"</span><span class="token punctuation">,</span> <span class="token string">"dev"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"ip"</span><span class="token punctuation">,</span> <span class="token string">"-4"</span><span class="token punctuation">,</span> <span class="token string">"route"</span><span class="token punctuation">,</span> <span class="token string">"add"</span><span class="token punctuation">,</span> cidr<span class="token punctuation">,</span> <span class="token string">"dev"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"iptables"</span><span class="token punctuation">,</span> <span class="token string">"-A"</span><span class="token punctuation">,</span> <span class="token string">"FORWARD"</span><span class="token punctuation">,</span> <span class="token string">"-i"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"-j"</span><span class="token punctuation">,</span> <span class="token string">"ACCEPT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"iptables"</span><span class="token punctuation">,</span> <span class="token string">"-A"</span><span class="token punctuation">,</span> <span class="token string">"FORWARD"</span><span class="token punctuation">,</span> <span class="token string">"-o"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"-j"</span><span class="token punctuation">,</span> <span class="token string">"ACCEPT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"iptables"</span><span class="token punctuation">,</span> <span class="token string">"-t"</span><span class="token punctuation">,</span> <span class="token string">"nat"</span><span class="token punctuation">,</span> <span class="token string">"-A"</span><span class="token punctuation">,</span> <span class="token string">"POSTROUTING"</span><span class="token punctuation">,</span> <span class="token string">"-o"</span><span class="token punctuation">,</span> <span class="token string">"eth0"</span><span class="token punctuation">,</span> <span class="token string">"-j"</span><span class="token punctuation">,</span> <span class="token string">"MASQUERADE"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token comment">// TODO: server keys should be stored and passed here as parameters</span>
	<span class="token comment">// serverPrivateKey, serverPublicKey, err := generateWireGuardKeys()</span>
	<span class="token comment">// if err != nil {</span>
	<span class="token comment">// 	return nil, err</span>
	<span class="token comment">// }</span>
	os<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span><span class="token string">"/etc/wireguard/server.privatekey"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>serverPrivateKey<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0600</span><span class="token punctuation">)</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"listen-port"</span><span class="token punctuation">,</span> <span class="token string">"51820"</span><span class="token punctuation">,</span> <span class="token string">"private-key"</span><span class="token punctuation">,</span> <span class="token string">"/etc/wireguard/server.privatekey"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token operator">&amp;</span>WireGuard<span class="token punctuation">{</span>
		cidr<span class="token punctuation">:</span>             cidr<span class="token punctuation">,</span>
		serverPrivateIP<span class="token punctuation">:</span>  serverPrivateIP<span class="token punctuation">,</span>
		serverPublicIP<span class="token punctuation">:</span>   serverPublicIP<span class="token punctuation">,</span>
		serverPrivateKey<span class="token punctuation">:</span> serverPrivateKey<span class="token punctuation">,</span>
		serverPublicKey<span class="token punctuation">:</span>  serverPublicKey<span class="token punctuation">,</span>
		dns<span class="token punctuation">:</span>              dns<span class="token punctuation">,</span>
		allowedIPs<span class="token punctuation">:</span>       allowedIPs<span class="token punctuation">,</span>
		port<span class="token punctuation">:</span>             <span class="token string">"51820"</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>WireGuard<span class="token punctuation">)</span> <span class="token function">ListPeers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>peers <span class="token punctuation">[</span><span class="token punctuation">]</span>Peer<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	b<span class="token punctuation">,</span> err <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"show"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"dump"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> peers<span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> idx<span class="token punctuation">,</span> line <span class="token operator">:=</span> <span class="token keyword">range</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> idx <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
			<span class="token keyword">continue</span>
		<span class="token punctuation">}</span>
		cells <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span>
		peers <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>peers<span class="token punctuation">,</span> Peer<span class="token punctuation">{</span>
			PublicKey<span class="token punctuation">:</span>           cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			PresharedKey<span class="token punctuation">:</span>        cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			Endpoint<span class="token punctuation">:</span>            cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			AllowedIPs<span class="token punctuation">:</span>          cells<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			LatestHandshake<span class="token punctuation">:</span>     cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			TransferRX<span class="token punctuation">:</span>          cells<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			TransferTX<span class="token punctuation">:</span>          cells<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			PersistentKeepalive<span class="token punctuation">:</span> cells<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> peers<span class="token punctuation">,</span> err
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>WireGuard<span class="token punctuation">)</span> <span class="token function">AddPeer2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>privateKey <span class="token builtin">string</span><span class="token punctuation">,</span> publicKey <span class="token builtin">string</span><span class="token punctuation">,</span> ip <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ip<span class="token punctuation">,</span> err <span class="token operator">=</span> w<span class="token punctuation">.</span><span class="token function">getNextIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	privateKey<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token function">GenerateWireGuardKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"peer"</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> <span class="token string">"allowed-ips"</span><span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> privateKey<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> ip<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>WireGuard<span class="token punctuation">)</span> <span class="token function">AddPeer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>c PeerConfig<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ip<span class="token punctuation">,</span> err <span class="token operator">:=</span> w<span class="token punctuation">.</span><span class="token function">getNextIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> c<span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	privateKey<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">GenerateWireGuardKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> c<span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"peer"</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> <span class="token string">"allowed-ips"</span><span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> c<span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> PeerConfig<span class="token punctuation">{</span>
		ClientPrivateIP<span class="token punctuation">:</span>     ip<span class="token punctuation">,</span>
		ClientPrivateKey<span class="token punctuation">:</span>    privateKey<span class="token punctuation">,</span>
		DNS<span class="token punctuation">:</span>                 w<span class="token punctuation">.</span>dns<span class="token punctuation">,</span>
		ServerPublicKey<span class="token punctuation">:</span>     w<span class="token punctuation">.</span>serverPublicKey<span class="token punctuation">,</span>
		ServerPublicIP<span class="token punctuation">:</span>      w<span class="token punctuation">.</span>serverPublicIP<span class="token punctuation">,</span>
		ServerPort<span class="token punctuation">:</span>          w<span class="token punctuation">.</span>port<span class="token punctuation">,</span>
		AllowedIPs<span class="token punctuation">:</span>          w<span class="token punctuation">.</span>allowedIPs<span class="token punctuation">,</span>
		PersistentKeepalive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>WireGuard<span class="token punctuation">)</span> <span class="token function">RemovePeer</span><span class="token punctuation">(</span>peerPublicKey <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token string">"wg0"</span><span class="token punctuation">,</span> <span class="token string">"peer"</span><span class="token punctuation">,</span> peerPublicKey<span class="token punctuation">,</span> <span class="token string">"remove"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>WireGuard<span class="token punctuation">)</span> <span class="token function">getNextIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>IP <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	takenIPAddresses<span class="token punctuation">,</span> err <span class="token operator">:=</span> w<span class="token punctuation">.</span><span class="token function">ListPeers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	allIPAddresses<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">getAllIPAddressesFor</span><span class="token punctuation">(</span>w<span class="token punctuation">.</span>cidr<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> addr <span class="token operator">:=</span> <span class="token keyword">range</span> allIPAddresses <span class="token punctuation">{</span>
		IP <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s/32"</span><span class="token punctuation">,</span> addr<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> IP <span class="token operator">==</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s/32"</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>serverPrivateIP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">continue</span>
		<span class="token punctuation">}</span>
		found <span class="token operator">:=</span> <span class="token boolean">false</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> peer <span class="token operator">:=</span> <span class="token keyword">range</span> takenIPAddresses <span class="token punctuation">{</span>
			<span class="token keyword">if</span> peer<span class="token punctuation">.</span>AllowedIPs <span class="token operator">==</span> IP <span class="token punctuation">{</span>
				found <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token keyword">break</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">{</span>
			<span class="token keyword">return</span> IP<span class="token punctuation">,</span> err
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"can not find next IP"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">GenerateWireGuardKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>privateKey <span class="token builtin">string</span><span class="token punctuation">,</span> publicKey <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	b<span class="token punctuation">,</span> err <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"genkey"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	privateKey <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

	c <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">,</span> <span class="token string">"pubkey"</span><span class="token punctuation">)</span>
	stdin<span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">StdinPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">defer</span> stdin<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		io<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>stdin<span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	b<span class="token punctuation">,</span> err <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">CombinedOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	publicKey <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">TrimSuffix</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

	<span class="token keyword">return</span> privateKey<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// https://gist.github.com/kotakanbe/d3059af990252ba89a82?permalink_comment_id=4105265#gistcomment-4105265</span>
<span class="token keyword">func</span> <span class="token function">getAllIPAddressesFor</span><span class="token punctuation">(</span>cidr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>netip<span class="token punctuation">.</span>Addr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	prefix<span class="token punctuation">,</span> err <span class="token operator">:=</span> netip<span class="token punctuation">.</span><span class="token function">ParsePrefix</span><span class="token punctuation">(</span>cidr<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> ips <span class="token punctuation">[</span><span class="token punctuation">]</span>netip<span class="token punctuation">.</span>Addr
	<span class="token keyword">for</span> addr <span class="token operator">:=</span> prefix<span class="token punctuation">.</span><span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> prefix<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span> addr <span class="token operator">=</span> addr<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ips <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>ips<span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>ips<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> ips<span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> ips<span class="token punctuation">[</span><span class="token number">1</span> <span class="token punctuation">:</span> <span class="token function">len</span><span class="token punctuation">(</span>ips<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c PeerConfig<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token string">"[Interface]\n"</span>
	s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Address = %s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>ClientPrivateIP<span class="token punctuation">)</span>
	s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"PrivateKey = %s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>ClientPrivateKey<span class="token punctuation">)</span>
	<span class="token keyword">if</span> c<span class="token punctuation">.</span>DNS <span class="token operator">!=</span> <span class="token string">""</span> <span class="token punctuation">{</span>
		s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"DNS = %s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>DNS<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	s <span class="token operator">+=</span> <span class="token string">"\n[Peer]\n"</span>
	s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"PublicKey = %s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>ServerPublicKey<span class="token punctuation">)</span>
	s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Endpoint = %s:%s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>ServerPublicIP<span class="token punctuation">,</span> c<span class="token punctuation">.</span>ServerPort<span class="token punctuation">)</span>
	<span class="token keyword">if</span> c<span class="token punctuation">.</span>AllowedIPs <span class="token operator">!=</span> <span class="token string">""</span> <span class="token punctuation">{</span>
		s <span class="token operator">+=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"AllowedIPs = %s\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>AllowedIPs<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		s <span class="token operator">+=</span> <span class="token string">"AllowedIPs = 0.0.0.0/0\n"</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> c<span class="token punctuation">.</span>PersistentKeepalive <span class="token punctuation">{</span>
		s <span class="token operator">+=</span> <span class="token string">"PersistentKeepalive = 25\n"</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> s
<span class="token punctuation">}</span></code></pre></div></p>
<p><div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"io"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"os/exec"</span>

	<span class="token string">"github.com/mac2000/gowg/wireguard"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	serverPublicIP <span class="token operator">:=</span> <span class="token string">"X.X.X.X"</span>
	serverPrivateKey<span class="token punctuation">,</span> serverPublicKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> wireguard<span class="token punctuation">.</span><span class="token function">GenerateWireGuardKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	wg<span class="token punctuation">,</span> err <span class="token operator">:=</span> wireguard<span class="token punctuation">.</span><span class="token function">NewWireGuard</span><span class="token punctuation">(</span><span class="token string">"10.14.14.0/24"</span><span class="token punctuation">,</span> serverPrivateKey<span class="token punctuation">,</span> serverPublicKey<span class="token punctuation">,</span> serverPublicIP<span class="token punctuation">,</span> <span class="token string">"10.0.0.10"</span><span class="token punctuation">,</span> <span class="token string">"10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	c<span class="token punctuation">,</span> err <span class="token operator">:=</span> wg<span class="token punctuation">.</span><span class="token function">AddPeer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

	c<span class="token punctuation">,</span> err <span class="token operator">=</span> wg<span class="token punctuation">.</span><span class="token function">AddPeer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

	peers<span class="token punctuation">,</span> err <span class="token operator">:=</span> wg<span class="token punctuation">.</span><span class="token function">ListPeers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> peer <span class="token operator">:=</span> <span class="token keyword">range</span> peers <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>peer<span class="token punctuation">)</span>
		<span class="token keyword">if</span> peer<span class="token punctuation">.</span>AllowedIPs <span class="token operator">==</span> <span class="token string">"(none)"</span> <span class="token punctuation">{</span>
			err <span class="token operator">:=</span> wg<span class="token punctuation">.</span><span class="token function">RemovePeer</span><span class="token punctuation">(</span>peer<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	b<span class="token punctuation">,</span> err <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"wg"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> getRoot<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":80"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getRoot</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"got / request\n"</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">"This is my website!\n"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div></p>
<p>note: yes, yes, i know there are libraries for that but they did not work out of the box and i am not sure whether they are working in user space or kernel space, that's why i did simple exec, also it will work with any language</p>
<p>With that in place we may start building our own UI</p>
<p>And for storage we may even use Kubernetes itself, e.g. how about using ConfigMap as a storage for a peer configs, aka:</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go">config<span class="token punctuation">,</span> err <span class="token operator">:=</span> clientcmd<span class="token punctuation">.</span><span class="token function">NewNonInteractiveDeferredLoadingClientConfig</span><span class="token punctuation">(</span>clientcmd<span class="token punctuation">.</span><span class="token function">NewDefaultClientConfigLoadingRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>clientcmd<span class="token punctuation">.</span>ConfigOverrides<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

clientset<span class="token punctuation">,</span> err <span class="token operator">:=</span> kubernetes<span class="token punctuation">.</span><span class="token function">NewForConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

nsList<span class="token punctuation">,</span> err <span class="token operator">:=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Namespaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">List</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>ListOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"got"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>nsList<span class="token punctuation">.</span>Items<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"namespaces"</span><span class="token punctuation">)</span>

cm<span class="token punctuation">,</span> err <span class="token operator">:=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigMaps</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"demo"</span><span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>GetOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  c <span class="token operator">:=</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">.</span>ConfigMap<span class="token punctuation">{</span>
    ObjectMeta<span class="token punctuation">:</span> metav1<span class="token punctuation">.</span>ObjectMeta<span class="token punctuation">{</span>
      Name<span class="token punctuation">:</span> <span class="token string">"demo"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    Data<span class="token punctuation">:</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
      <span class="token string">"foo"</span><span class="token punctuation">:</span>  <span class="token string">"bar"</span><span class="token punctuation">,</span>
      <span class="token string">"acme"</span><span class="token punctuation">:</span> <span class="token string">"42"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigMaps</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>CreateOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"CREATED"</span><span class="token punctuation">)</span>
  cm<span class="token punctuation">,</span> err <span class="token operator">=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigMaps</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"demo"</span><span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>GetOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> cm<span class="token punctuation">.</span>Data <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> cm<span class="token punctuation">.</span>Data<span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"Hello World"</span> <span class="token punctuation">{</span>
  cm<span class="token punctuation">.</span>Data<span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Hello World"</span>
  <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigMaps</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cm<span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>UpdateOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"UPDATED"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> cm<span class="token punctuation">.</span>Data<span class="token punctuation">[</span><span class="token string">"acme"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"5"</span> <span class="token punctuation">{</span>
  <span class="token comment">// clientset.CoreV1().ConfigMaps("dev").Patch(context.Background(), "demo", types.MergePatchType)</span>
  payloadBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>patchStringValue<span class="token punctuation">{</span><span class="token punctuation">{</span>
    Op<span class="token punctuation">:</span>    <span class="token string">"replace"</span><span class="token punctuation">,</span>
    Path<span class="token punctuation">:</span>  <span class="token string">"/data/acme"</span><span class="token punctuation">,</span>
    Value<span class="token punctuation">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> clientset<span class="token punctuation">.</span><span class="token function">CoreV1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ConfigMaps</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Patch</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"demo"</span><span class="token punctuation">,</span> types<span class="token punctuation">.</span>JSONPatchType<span class="token punctuation">,</span> payloadBytes<span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>PatchOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"PATCHED"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>So we may create config map at start, save server keys to it, and whenever peers are added or removed just update config map</p>
<p>Also we may add any authorization we want (e.g. oidc to Azure Active Directory or GitHub with 2FA)</p>
<p>And to revoke keys on schedule we are going to remove peers:</p>
<ul>
<li>that did not connected last X days</li>
<li>that did not login to UI last Y days</li>
<li>if possible grab actual users list, lets say from Active Directory and remove peers for deactivated users</li>
</ul>
<p>With that it place it will be the same as password rotation</p>
<p>And there is even more, instead of building such an app, we always may install fastcgi and just run simple scripts instead and to not deal with auth we may just run oauth2-proxy sidecar which means we may build everything for pieces</p>
<p>So our nginx is protected with oauth2-proxy which is configured whatever you want (e.g. AAD+2Fa)</p>
<p>The main page points to script which will create new peer keys, add it to wireguard and print your config</p>
<p>So the workflow will be like - you as a user go to <a href="https://wg.contoso.com/">https://wg.contoso.com/</a> it asks you to login, after that prints your config</p>
<p>Also we may put as many technicall scripts as we want, e.g. /wg.sh, /wg/show/wg0/dump.sh, etc</p>
<p>We may protect them with help of nginx location directives if needed</p>
<p>To not bother with storage we may restart deployment every week</p>
<p>In other words there are two options:</p>
<ul>
<li>build some web app that will handle everything (auth, wireguard) in your favorite language</li>
<li>utilize fastcgi and oauth2-proxy and build solution on top of them</li>
</ul>
<h2>WireGuard custom UI</h2>
<p>So here we go with UI build with bare shell scripts</p>
<p>Here is dockerfile with wireguard tools and some wanted utilities</p>
<p><div class="gatsby-highlight" data-language="none"><pre class="language-none"><code class="language-none">FROM nginx:alpine

RUN apk add jq fcgiwrap spawn-fcgi iptables wireguard-tools nmap netcat-openbsd

HEALTHCHECK --interval=5m --timeout=3s --start-period=5s CMD nc -vz localhost 51820

COPY ./01-wireguard-init.sh /docker-entrypoint.d/01-wireguard-init.sh
COPY ./02-spawn-fcgi.sh /docker-entrypoint.d/02-spawn-fcgi.sh
COPY ./default.conf /etc/nginx/conf.d/default.conf
COPY ./html/ /usr/share/nginx/html/

ENV CIDR=10.13.14.0/24
ENV DNS=10.0.0.10
ENV ENDPOINT=TODO:51820
ENV ALLOWEDIPS="10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32"
ENV CONF_FILE_NAME=dev

EXPOSE 80 51820</code></pre></div></p>
<p>Here are script for a home page:</p>
<p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

<span class="token builtin class-name">echo</span> <span class="token string">'content-type: text/html'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'cache-control: no-store'</span>
<span class="token builtin class-name">echo</span> <span class="token string">''</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;h3>WireGuard&lt;/h3>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;form method="get" action="/add" target="_blank" onsubmit="setTimeout(() => location.reload(), 500)">&lt;input type="submit" value="add" />&lt;/form>'</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span>wg show wg0 peers <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;table border="1" cellspacing="0" cellpadding="5">'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;thead>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;tr>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>public key&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>preshared key&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>endpoint&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>allowed ip&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>latest handshake&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>transfer rx&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>transfer tx&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>persistent keepalive&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;th>&lt;/th>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;/tr>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;/thead>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;tbody>'</span>
wg show wg0 dump <span class="token operator">|</span> <span class="token function">sed</span> 1d <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ print "&lt;tr>&lt;td>"$1"&lt;/td>&lt;td>"$2"&lt;/td>&lt;td>"$3"&lt;/td>&lt;td>"$4"&lt;/td>&lt;td>"$5"&lt;/td>&lt;td>"$6"&lt;/td>&lt;td>"$7"&lt;/td>&lt;td>"$8"&lt;/td>&lt;td>&lt;form style=\"margin:0\" action=/remove/"$1">&lt;input type=submit value=&amp;times; />&lt;/form>&lt;/td>&lt;/tr>" }'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;/tbody>'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'&lt;/table>'</span>
<span class="token keyword">fi</span></code></pre></div></p>
<p>And here is script to add peer:</p>
<p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

<span class="token comment"># echo 'content-type: text/plain'</span>
<span class="token comment"># echo 'status: 302'</span>
<span class="token comment"># echo 'location: /'</span>
<span class="token builtin class-name">echo</span> <span class="token string">"content-disposition: attachment; filename=<span class="token entity" title="\&quot;">\"</span><span class="token variable">$CONF_FILE_NAME</span>.conf<span class="token entity" title="\&quot;">\"</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">''</span>

<span class="token assign-left variable">PEER_PRIVATE_KEY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>wg genkey<span class="token variable">)</span></span>
<span class="token assign-left variable">PEER_PUBLIC_KEY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $PEER_PRIVATE_KEY <span class="token operator">|</span> wg pubkey<span class="token variable">)</span></span>
<span class="token assign-left variable">SERVER_PUBLIC_KEY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>wg show wg0 public-key<span class="token variable">)</span></span>

<span class="token assign-left variable">ADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">comm</span> <span class="token parameter variable">-13</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>
  wg show wg0 allowed-ips <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ split($2, a, "/"); print a[1] }'</span>
<span class="token variable">)</span></span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>
  nmap <span class="token parameter variable">-sL</span> <span class="token parameter variable">-n</span> <span class="token variable">$CIDR</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/Nmap scan report/{print $NF}'</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> +3 <span class="token operator">|</span> <span class="token function">sed</span> <span class="token punctuation">\</span><span class="token variable">$d</span>
<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token punctuation">)</span>

wg <span class="token builtin class-name">set</span> wg0 peer <span class="token variable">$PEER_PUBLIC_KEY</span> allowed-ips <span class="token string">"<span class="token variable">$ADDR</span>/32"</span>

<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
[Interface]
Address = <span class="token variable">$ADDR</span>
PrivateKey = <span class="token variable">$PEER_PRIVATE_KEY</span>
DNS = <span class="token variable">$DNS</span>

[Peer]
PublicKey = <span class="token variable">$SERVER_PUBLIC_KEY</span>
Endpoint = <span class="token variable">$ENDPOINT</span>
AllowedIPs = <span class="token variable">$ALLOWEDIPS</span>
PersistentKeepalive = 25
EOF</span></code></pre></div></p>
<p>And remove peer:</p>
<p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

wg <span class="token builtin class-name">set</span> wg0 peer <span class="token variable">$PEER</span> remove

<span class="token builtin class-name">echo</span> <span class="token string">'status: 302'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'location: /'</span>
<span class="token builtin class-name">echo</span> <span class="token string">''</span></code></pre></div></p>
<p>Nginx configuration:</p>
<p><div class="gatsby-highlight" data-language="conf"><pre class="language-conf"><code class="language-conf">server {
  listen       80;
  root   /usr/share/nginx/html;

  location ~ ^/$ {
    index  index;
    fastcgi_pass unix:/var/run/fcgiwrap.socket;
    fastcgi_param SCRIPT_FILENAME /usr/share/nginx/html/index.sh;
  }

  location /add {
    fastcgi_pass unix:/var/run/fcgiwrap.socket;
    fastcgi_param SCRIPT_FILENAME  /usr/share/nginx/html/add.sh;
  }
  location ~ ^/remove/(.+)$ {
    fastcgi_pass unix:/var/run/fcgiwrap.socket;
    fastcgi_param PEER $1;
    fastcgi_param SCRIPT_FILENAME  /usr/share/nginx/html/remove.sh;
  }

  location /interfaces {
    fastcgi_pass unix:/var/run/fcgiwrap.socket;
    fastcgi_param SCRIPT_FILENAME  /usr/share/nginx/html/interfaces.sh;
  }

  location /dump {
    fastcgi_pass unix:/var/run/fcgiwrap.socket;
    fastcgi_param SCRIPT_FILENAME  /usr/share/nginx/html/dump.sh;
  }
}</code></pre></div></p>
<p>And init scripts:</p>
<p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

<span class="token comment"># ip</span>
<span class="token assign-left variable">SERVER_IP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>nmap <span class="token parameter variable">-sL</span> <span class="token parameter variable">-n</span> $CIDR <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/Nmap scan report/{print $NF}'</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span>


<span class="token comment"># interface</span>
<span class="token function">ip</span> <span class="token function">link</span> <span class="token function">add</span> wg0 <span class="token builtin class-name">type</span> wireguard
<span class="token function">ip</span> <span class="token parameter variable">-4</span> address <span class="token function">add</span> <span class="token variable">$SERVER_IP</span> dev wg0
<span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> mtu <span class="token number">1420</span> up dev wg0
<span class="token function">ip</span> <span class="token parameter variable">-4</span> route <span class="token function">add</span> <span class="token variable">$CIDR</span> dev wg0

<span class="token comment"># nat</span>
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-i</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-o</span> wg0 <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> MASQUERADE

<span class="token comment"># cfg</span>
wg genkey <span class="token operator">|</span> <span class="token function">tee</span> /etc/wireguard/server.privatekey <span class="token operator">|</span> wg pubkey <span class="token operator">></span> /etc/wireguard/server.publickey
wg <span class="token builtin class-name">set</span> wg0 listen-port <span class="token number">51820</span> private-key /etc/wireguard/server.privatekey</code></pre></div></p>
<p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

/usr/bin/spawn-fcgi <span class="token parameter variable">-s</span> /var/run/fcgiwrap.socket <span class="token parameter variable">-M</span> <span class="token number">766</span> /usr/bin/fcgiwrap</code></pre></div></p>
<p>And finaly kubernetes deployment demo</p>
<p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">kubeforce</span><span class="token punctuation">:</span> skip
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span>
        <span class="token key atrule">kubernetes.io/os</span><span class="token punctuation">:</span> linux
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
        <span class="token key atrule">image</span><span class="token punctuation">:</span> mac2000/wg
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> CIDR
          <span class="token key atrule">value</span><span class="token punctuation">:</span> 10.13.14.0/24
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> DNS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> 10.0.0.10
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ENDPOINT
          <span class="token key atrule">value</span><span class="token punctuation">:</span> 20.54.8.225<span class="token punctuation">:</span><span class="token number">51820</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ALLOWEDIPS
          <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">"10.0.0.0/8, 34.117.59.81/32, 20.13.179.68/32"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> CONF_FILE_NAME
          <span class="token key atrule">value</span><span class="token punctuation">:</span> demo
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
          <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
          <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">51820</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 500m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 1024Mi
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 100m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 256Mi
        <span class="token key atrule">securityContext</span><span class="token punctuation">:</span>
          <span class="token comment"># privileged: true</span>
          <span class="token key atrule">capabilities</span><span class="token punctuation">:</span>
            <span class="token key atrule">add</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> NET_ADMIN
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> auth
        <span class="token key atrule">image</span><span class="token punctuation">:</span> quay.io/oauth2<span class="token punctuation">-</span>proxy/oauth2<span class="token punctuation">-</span>proxy
        <span class="token key atrule">args</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>cookie<span class="token punctuation">-</span>secure=false

        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>provider=github
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>email<span class="token punctuation">-</span>domain=*
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>upstream=http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>80/
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>http<span class="token punctuation">-</span>address=0.0.0.0<span class="token punctuation">:</span><span class="token number">4180</span>
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>client<span class="token punctuation">-</span>id=<span class="token important">***********</span>
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>client<span class="token punctuation">-</span>secret=<span class="token important">*********</span>
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>redirect<span class="token punctuation">-</span>url=http<span class="token punctuation">:</span>//20.54.8.225/oauth2/callback
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>scope=user<span class="token punctuation">:</span>email

        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>cookie<span class="token punctuation">-</span>secret=acSPNyjKoCtVBNYS9IZjBuCu7FNF95BmsVzedq0Drr8=
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> auth
          <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">4180</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 10m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 128Mi
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 500m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 300Mi
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">4180</span>
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wireguard
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">51820</span>
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> UDP</code></pre></div></p>
<p>Just for demo purposes aplied github as an auth provider</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/99ff1b1c3dc85eb62b091c9a2c218112/f3a19/screen1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62.890625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABc0lEQVQ4y6WTzUrDQBDHfSQfQATxIB5Fbx48+wy+gGfx5AP4EH5VoVqIirVQkcZaba21Rq35Tprd/UmapEQpUXCTf2YzO/sbJjuZcl0Xx3H+pYwR26l44nkeYRgSBAFhEIysnyrxJWs/le3JQ8fAoqHiS8VPEqvUeE1KiW3bk4FZoCE87iMTQwVEUhYmE0JMBib5oS9drujRZcCWWeGIDv3eC7XaNe1OG13XR/J9vxgoU6AuBmy066zfVVmsH7Nt6dzc1tnfO6BUKlEul9E0bVxVMVBBB5PdqsvhhWJggGaZ9D4NXp77dJ66WJb9t5LTr49A0lDv6PKDBgZdZSUbpSQcDhlG0beDKQSOguJbQYRAqMkHksT9AsxndUTE2uMVy61zlloaK61zVh8vWWhW2Hl7SEBpsuKS02ErwVzzjNnmKTOp5u8rTDdO2Hy9S/qvqA+zTs/kpXJyPieVn/Nl+gbMJpZlYZrmWPG7PUFZXN7mf70vTVffUKvVN9cAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="screen1"
        title="screen1"
        src="/static/99ff1b1c3dc85eb62b091c9a2c218112/2bef9/screen1.png"
        srcset="/static/99ff1b1c3dc85eb62b091c9a2c218112/6f3f2/screen1.png 256w,
/static/99ff1b1c3dc85eb62b091c9a2c218112/01e7c/screen1.png 512w,
/static/99ff1b1c3dc85eb62b091c9a2c218112/2bef9/screen1.png 1024w,
/static/99ff1b1c3dc85eb62b091c9a2c218112/f3a19/screen1.png 1086w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/41287ca7e94d3ca28405d7da68ab1df5/5f652/screen2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC9UlEQVQ4y42U32scVRTH87/66IM+KpWCQhEEq/ggfVK0KIJPFcFfNI2mpgilahtT02SbJruTnd3Z+T07c3/NfOTc7Kyb3Si9cLjnzpz7PT/u+Z6tWhlE5v3eaOba0hhHra3/rpSlbjS2hUkUM0tzr4ttf7+XreVBfi7A1CxFP3qCHo5plGFW5jTWcfD3EdffvsG7793kxTDAuI6q1v8N6KMzDnM44Oz1N6l+2gENHz68zeP4mFsff8JfBwds39vh08+/QFY5b64GnPcRGksTRjQ7e5jBKdq0RFWGoePho8f8vPsrn93+kj+eHOA6qGq1Cbhei0oZ4rxkGme+XmlWEs1SsqIiilPycu7TXb3X61u9Irt4k13SODx6zv7TQ44GL3j6bOD1Z8cnvo6j88m/D7iQ/ryMUBlLB2ipoXXYtsOJuPZC2otd/olto81SNiJspD3Kkv3f9kiShHE4IYoi4rQgSC3DWDGMjdetFG5tiYM1QEdVFOw/2CVOEqbRjGgW+3qNJgnDMOZ8mhHnczrB6zq6hXhAbTdrWCtNGMUkSUoYTphOI4qiXMTQLWRxehlApbSPKstyn3I4mRInKVlekGY5WVGgraXtWlzncLK3zp8vpdwXVAp+1eqj+L8lD7MBKK+njUGLt7rxkSltcK4jq0vuHN/lm8E23538wreDe/xwcp+vD7/nQfA7rYWqUZuAjdK+HmleEIwnFNUcrRzDNOTVu+/w2vYNrt3/gDd23+f63ke88uNb3PrzK2ih9IxZ6UPps/VljGEUBIyGAcW0wJX25VOWVNuu8yINba3zTiT9al6TVyXzpsE4h2ml8R3aWbQ1lwF7Ja9qJlFCGCVEcUZR1aTC3SRnluRUnprac3s8nXE+mV18r/VyQFxQT7iojOfveBpzOhpzFoS+J2UIyMXnpyPSvEIZR5zmnA7POTkLvGNh2WXAFZLXynqDfoKIEwEVSbKSNC/pqdrb9QNlCbg+glanh6QdZ4XntKQnoKs2V42vfwC2xfZ49LaZRQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="screen2"
        title="screen2"
        src="/static/41287ca7e94d3ca28405d7da68ab1df5/2bef9/screen2.png"
        srcset="/static/41287ca7e94d3ca28405d7da68ab1df5/6f3f2/screen2.png 256w,
/static/41287ca7e94d3ca28405d7da68ab1df5/01e7c/screen2.png 512w,
/static/41287ca7e94d3ca28405d7da68ab1df5/2bef9/screen2.png 1024w,
/static/41287ca7e94d3ca28405d7da68ab1df5/5f652/screen2.png 1302w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/acee331e430efad7ecc647e9f6eeb263/7d62e/screen3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 15.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZUlEQVQI162OSQoAIQwE/f8vxS0qLgcVPPXQgZkXjFBU1KSJcc5hzom/jmmt4d6roSEErLVwzkHvHTFGpJQ+v/Cec1ZERN/ovTcMQ4j3HtZaNQdoNhHWhH1jDA2qtSr851KlFPUD52XkYb6g2lQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="screen3"
        title="screen3"
        src="/static/acee331e430efad7ecc647e9f6eeb263/2bef9/screen3.png"
        srcset="/static/acee331e430efad7ecc647e9f6eeb263/6f3f2/screen3.png 256w,
/static/acee331e430efad7ecc647e9f6eeb263/01e7c/screen3.png 512w,
/static/acee331e430efad7ecc647e9f6eeb263/2bef9/screen3.png 1024w,
/static/acee331e430efad7ecc647e9f6eeb263/71c1d/screen3.png 1536w,
/static/acee331e430efad7ecc647e9f6eeb263/a878e/screen3.png 2048w,
/static/acee331e430efad7ecc647e9f6eeb263/7d62e/screen3.png 2368w"
        sizes="(max-width: 1024px) 100vw, 1024px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>And here you go, WireGuard with UI in Kubernetes with external Auth provider that requires 2FA</p>
<p>And because it is stateles we may just restart deployment lets say once per week to enforce users to rotate keys</p></div></main><footer><a href="#top">top</a><a href="/">home</a><a href="/search">search</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/kubernetes-wireguard";window.___webpackCompilationHash="26ab2a0da607c99d5a1b";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b4bb882d10635d85fa25.js"],"app":["/app-4dce200a378abd7eb1ff.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2652c435d8decd31b8ef.js"],"component---src-pages-index-js":["/component---src-pages-index-js-144cfd4a5c58839d0eaf.js"],"component---src-pages-search-js":["/component---src-pages-search-js-078619e3aef857102623.js"],"component---src-templates-note-js":["/component---src-templates-note-js-b005c02681f20ea28edd.js"]};/*]]>*/</script><script src="/polyfill-b4bb882d10635d85fa25.js" nomodule=""></script><script src="/app-4dce200a378abd7eb1ff.js" async=""></script><script src="/framework-2ce620c91826a79f925c.js" async=""></script><script src="/webpack-runtime-7e559c13c9afff5df79f.js" async=""></script></body></html>